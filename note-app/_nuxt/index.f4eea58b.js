import{a as zt,b as El,e as Il,o as Nr,f as no,h as wt,t as Qs,u as We,p as Tl,i as _l,r as Ui,j as Sl,k as Al,w as Nl,l as Ws,v as Ys,m as Xs,q as Dl,F as Js,s as Cl,c as xl}from"./entry.17f2c5e3.js";const kl=e=>Object.fromEntries(Object.entries(e).filter(([,t])=>t!==void 0)),Xt=(e,t)=>(n,r)=>(El(()=>e({...kl(n),...r.attrs},r)),()=>{var i,o;return t?(o=(i=r.slots).default)==null?void 0:o.call(i):null}),le={accesskey:String,autocapitalize:String,autofocus:{type:Boolean,default:void 0},class:String,contenteditable:{type:Boolean,default:void 0},contextmenu:String,dir:String,draggable:{type:Boolean,default:void 0},enterkeyhint:String,exportparts:String,hidden:{type:Boolean,default:void 0},id:String,inputmode:String,is:String,itemid:String,itemprop:String,itemref:String,itemscope:String,itemtype:String,lang:String,nonce:String,part:String,slot:String,spellcheck:{type:Boolean,default:void 0},style:String,tabindex:String,title:String,translate:String};zt({name:"Script",inheritAttrs:!1,props:{...le,async:Boolean,crossorigin:{type:[Boolean,String],default:void 0},defer:Boolean,fetchpriority:String,integrity:String,nomodule:Boolean,nonce:String,referrerpolicy:String,src:String,type:String,charset:String,language:String,body:Boolean,renderPriority:[String,Number]},setup:Xt((e,{slots:t})=>{var i;const n={...e},r=(((i=t.default)==null?void 0:i.call(t))||[]).filter(({children:o})=>o).map(({children:o})=>o).join("");return r&&(n.children=r),{script:[n]}})});zt({name:"NoScript",inheritAttrs:!1,props:{...le,title:String,body:Boolean,renderPriority:[String,Number]},setup:Xt((e,{slots:t})=>{var i;const n={...e},r=(((i=t.default)==null?void 0:i.call(t))||[]).filter(({children:o})=>o).map(({children:o})=>o).join("");return r&&(n.children=r),{noscript:[n]}})});zt({name:"Link",inheritAttrs:!1,props:{...le,as:String,crossorigin:String,disabled:Boolean,fetchpriority:String,href:String,hreflang:String,imagesizes:String,imagesrcset:String,integrity:String,media:String,prefetch:{type:Boolean,default:void 0},referrerpolicy:String,rel:String,sizes:String,title:String,type:String,methods:String,target:String,body:Boolean,renderPriority:[String,Number]},setup:Xt(e=>({link:[e]}))});zt({name:"Base",inheritAttrs:!1,props:{...le,href:String,target:String},setup:Xt(e=>({base:e}))});zt({name:"Title",inheritAttrs:!1,setup:Xt((e,{slots:t})=>{var r,i,o;return{title:((o=(i=(r=t.default)==null?void 0:r.call(t))==null?void 0:i[0])==null?void 0:o.children)||null}})});zt({name:"Meta",inheritAttrs:!1,props:{...le,charset:String,content:String,httpEquiv:String,name:String,body:Boolean,renderPriority:[String,Number]},setup:Xt(e=>{const t={...e};return t.httpEquiv&&(t["http-equiv"]=t.httpEquiv,delete t.httpEquiv),{meta:[t]}})});zt({name:"Style",inheritAttrs:!1,props:{...le,type:String,media:String,nonce:String,title:String,scoped:{type:Boolean,default:void 0},body:Boolean,renderPriority:[String,Number]},setup:Xt((e,{slots:t})=>{var i,o,s;const n={...e},r=(s=(o=(i=t.default)==null?void 0:i.call(t))==null?void 0:o[0])==null?void 0:s.children;return r&&(n.children=r),{style:[n]}})});const Rl=zt({name:"Head",inheritAttrs:!1,setup:(e,t)=>()=>{var n,r;return(r=(n=t.slots).default)==null?void 0:r.call(n)}});zt({name:"Html",inheritAttrs:!1,props:{...le,manifest:String,version:String,xmlns:String,renderPriority:[String,Number]},setup:Xt(e=>({htmlAttrs:e}),!0)});zt({name:"Body",inheritAttrs:!1,props:{...le,renderPriority:[String,Number]},setup:Xt(e=>({bodyAttrs:e}),!0)});const Ol=e=>(Tl("data-v-b2a0b97f"),e=e(),_l(),e),Pl=Ol(()=>wt("span",{class:"material-icons"}," delete ",-1)),Ll=[Pl],Fl={__name:"Note",props:["id","title","content"],emits:["remove"],setup(e,{emit:t}){const n=e;return(r,i)=>(Nr(),no("div",null,[wt("h2",null,[wt("span",null,Qs(We(n).title),1),wt("button",{title:"Delete",onClick:i[0]||(i[0]=o=>We(t)("remove"))},Ll)]),wt("h3",null,Qs(We(n).content),1)]))}},Ml=Il(Fl,[["__scopeId","data-v-b2a0b97f"]]);var ro=function(e,t){return ro=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},ro(e,t)};function x(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");ro(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var Pn=function(){return Pn=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},Pn.apply(this,arguments)};function m(e,t,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function u(h){try{c(r.next(h))}catch(l){s(l)}}function a(h){try{c(r.throw(h))}catch(l){s(l)}}function c(h){h.done?o(h.value):i(h.value).then(u,a)}c((r=r.apply(e,t||[])).next())})}function y(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(c){return function(h){return a([c,h])}}function a(c){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,c[0]&&(n=0)),n;)try{if(r=1,i&&(o=c[0]&2?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,i=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){n.label=c[1];break}if(c[0]===6&&n.label<o[1]){n.label=o[1],o=c;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(c);break}o[2]&&n.ops.pop(),n.trys.pop();continue}c=t.call(e,n)}catch(h){c=[6,h],i=0}finally{r=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function qi(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function mr(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),i,o=[],s;try{for(;(t===void 0||t-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(u){s={error:u}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return o}function H(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,o;r<i;r++)(o||!(r in t))&&(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Sa=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=i&63|128):(i&64512)===55296&&r+1<e.length&&(e.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(e.charCodeAt(++r)&1023),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=i&63|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=i&63|128)}return t},Vl=function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=e[n++];t[r++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){var o=e[n++],s=e[n++],u=e[n++],a=((i&7)<<18|(o&63)<<12|(s&63)<<6|u&63)-65536;t[r++]=String.fromCharCode(55296+(a>>10)),t[r++]=String.fromCharCode(56320+(a&1023))}else{var o=e[n++],s=e[n++];t[r++]=String.fromCharCode((i&15)<<12|(o&63)<<6|s&63)}}return t.join("")},Ul={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var o=e[i],s=i+1<e.length,u=s?e[i+1]:0,a=i+2<e.length,c=a?e[i+2]:0,h=o>>2,l=(o&3)<<4|u>>4,f=(u&15)<<2|c>>6,p=c&63;a||(p=64,s||(f=64)),r.push(n[h],n[l],n[f],n[p])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Sa(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):Vl(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var o=n[e.charAt(i++)],s=i<e.length,u=s?n[e.charAt(i)]:0;++i;var a=i<e.length,c=a?n[e.charAt(i)]:64;++i;var h=i<e.length,l=h?n[e.charAt(i)]:64;if(++i,o==null||u==null||c==null||l==null)throw Error();var f=o<<2|u>>4;if(r.push(f),c!==64){var p=u<<4&240|c>>2;if(r.push(p),l!==64){var d=c<<6&192|l;r.push(d)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},ql=function(e){var t=Sa(e);return Ul.encodeByteArray(t,!0)},Zs=function(e){return ql(e).replace(/\./g,"")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bl(e){return Ln(void 0,e)}function Ln(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:var n=t;return new Date(n.getTime());case Object:e===void 0&&(e={});break;case Array:e=[];break;default:return t}for(var r in t)!t.hasOwnProperty(r)||!jl(r)||(e[r]=Ln(e[r],t[r]));return e}function jl(e){return e!=="__proto__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Kl=function(){function e(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(n,r){t.resolve=n,t.reject=r})}return e.prototype.wrapCallback=function(t){var n=this;return function(r,i){r?n.reject(r):n.resolve(i),typeof t=="function"&&(n.promise.catch(function(){}),t.length===1?t(r):t(r,i))}},e}();/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zl(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n={alg:"none",type:"JWT"},r=t||"demo-project",i=e.iat||0,o=e.sub||e.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var s=Pn({iss:"https://securetoken.google.com/"+r,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},e),u="";return[Zs(JSON.stringify(n)),Zs(JSON.stringify(s)),u].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ne(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Gl(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ne())}function Aa(){try{return Object.prototype.toString.call(globalThis.process)==="[object process]"}catch{return!1}}function $l(){return typeof self=="object"&&self.self===self}function Hl(){var e=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof e=="object"&&e.id!==void 0}function Ql(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Wl(){return Ne().indexOf("Electron/")>=0}function Yl(){var e=Ne();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function Xl(){return Ne().indexOf("MSAppHost/")>=0}function Jl(){return!Aa()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Zl="FirebaseError",tf=function(e){x(t,e);function t(n,r,i){var o=e.call(this,r)||this;return o.code=n,o.customData=i,o.name=Zl,Object.setPrototypeOf(o,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,Oo.prototype.create),o}return t}(Error),Oo=function(){function e(t,n,r){this.service=t,this.serviceName=n,this.errors=r}return e.prototype.create=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=n[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?ef(s,i):"Error",a=this.serviceName+": "+u+" ("+o+").",c=new tf(o,a,i);return c},e}();function ef(e,t){return e.replace(nf,function(n,r){var i=t[r];return i!=null?String(i):"<"+r+"?>"})}var nf=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tu(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function rf(e,t){var n=new of(e,t);return n.subscribe.bind(n)}var of=function(){function e(t,n){var r=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(function(){t(r)}).catch(function(i){r.error(i)})}return e.prototype.next=function(t){this.forEachObserver(function(n){n.next(t)})},e.prototype.error=function(t){this.forEachObserver(function(n){n.error(t)}),this.close(t)},e.prototype.complete=function(){this.forEachObserver(function(t){t.complete()}),this.close()},e.prototype.subscribe=function(t,n,r){var i=this,o;if(t===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");sf(t,["next","error","complete"])?o=t:o={next:t,error:n,complete:r},o.next===void 0&&(o.next=Bi),o.error===void 0&&(o.error=Bi),o.complete===void 0&&(o.complete=Bi);var s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?o.error(i.finalError):o.complete()}catch{}}),this.observers.push(o),s},e.prototype.unsubscribeOne=function(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))},e.prototype.forEachObserver=function(t){if(!this.finalized)for(var n=0;n<this.observers.length;n++)this.sendOne(n,t)},e.prototype.sendOne=function(t,n){var r=this;this.task.then(function(){if(r.observers!==void 0&&r.observers[t]!==void 0)try{n(r.observers[t])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})},e.prototype.close=function(t){var n=this;this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(function(){n.observers=void 0,n.onNoObservers=void 0}))},e}();function sf(e,t){if(typeof e!="object"||e===null)return!1;for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i in e&&typeof e[i]=="function")return!0}return!1}function Bi(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X(e){return e&&e._delegate?e._delegate:e}var ai=function(){function e(t,n,r){this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return e.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},e.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},e.prototype.setServiceProps=function(t){return this.serviceProps=t,this},e.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},e}();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var me="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var uf=function(){function e(t,n){this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return e.prototype.get=function(t){var n=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(n)){var r=new Kl;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{var i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise},e.prototype.getImmediate=function(t){var n,r=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),i=(n=t==null?void 0:t.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error("Service "+this.name+" is not available")}},e.prototype.getComponent=function(){return this.component},e.prototype.setComponent=function(t){var n,r;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,!!this.shouldAutoInitialize()){if(cf(t))try{this.getOrInitializeService({instanceIdentifier:me})}catch{}try{for(var i=qi(this.instancesDeferred.entries()),o=i.next();!o.done;o=i.next()){var s=mr(o.value,2),u=s[0],a=s[1],c=this.normalizeInstanceIdentifier(u);try{var h=this.getOrInitializeService({instanceIdentifier:c});a.resolve(h)}catch{}}}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}},e.prototype.clearInstance=function(t){t===void 0&&(t=me),this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)},e.prototype.delete=function(){return m(this,void 0,void 0,function(){var t;return y(this,function(n){switch(n.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(H(H([],mr(t.filter(function(r){return"INTERNAL"in r}).map(function(r){return r.INTERNAL.delete()}))),mr(t.filter(function(r){return"_delete"in r}).map(function(r){return r._delete()}))))];case 1:return n.sent(),[2]}})})},e.prototype.isComponentSet=function(){return this.component!=null},e.prototype.isInitialized=function(t){return t===void 0&&(t=me),this.instances.has(t)},e.prototype.getOptions=function(t){return t===void 0&&(t=me),this.instancesOptions.get(t)||{}},e.prototype.initialize=function(t){var n,r;t===void 0&&(t={});var i=t.options,o=i===void 0?{}:i,s=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(s))throw Error(this.name+"("+s+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var u=this.getOrInitializeService({instanceIdentifier:s,options:o});try{for(var a=qi(this.instancesDeferred.entries()),c=a.next();!c.done;c=a.next()){var h=mr(c.value,2),l=h[0],f=h[1],p=this.normalizeInstanceIdentifier(l);s===p&&f.resolve(u)}}catch(d){n={error:d}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return u},e.prototype.onInit=function(t,n){var r,i=this.normalizeInstanceIdentifier(n),o=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;o.add(t),this.onInitCallbacks.set(i,o);var s=this.instances.get(i);return s&&t(s,i),function(){o.delete(t)}},e.prototype.invokeOnInitCallbacks=function(t,n){var r,i,o=this.onInitCallbacks.get(n);if(!!o)try{for(var s=qi(o),u=s.next();!u.done;u=s.next()){var a=u.value;try{a(t,n)}catch{}}}catch(c){r={error:c}}finally{try{u&&!u.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}},e.prototype.getOrInitializeService=function(t){var n=t.instanceIdentifier,r=t.options,i=r===void 0?{}:r,o=this.instances.get(n);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:af(n),options:i}),this.instances.set(n,o),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(o,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,o)}catch{}return o||null},e.prototype.normalizeInstanceIdentifier=function(t){return t===void 0&&(t=me),this.component?this.component.multipleInstances?t:me:t},e.prototype.shouldAutoInitialize=function(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"},e}();function af(e){return e===me?void 0:e}function cf(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var hf=function(){function e(t){this.name=t,this.providers=new Map}return e.prototype.addComponent=function(t){var n=this.getProvider(t.name);if(n.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);n.setComponent(t)},e.prototype.addOrOverwriteComponent=function(t){var n=this.getProvider(t.name);n.isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},e.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var n=new uf(t,this);return this.providers.set(t,n),n},e.prototype.getProviders=function(){return Array.from(this.providers.values())},e}();/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function Pt(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),i=0,t=0;t<n;t++)for(var o=arguments[t],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ye,Po=[],V;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(V||(V={}));var Na={debug:V.DEBUG,verbose:V.VERBOSE,info:V.INFO,warn:V.WARN,error:V.ERROR,silent:V.SILENT},lf=V.INFO,ff=(ye={},ye[V.DEBUG]="log",ye[V.VERBOSE]="log",ye[V.INFO]="info",ye[V.WARN]="warn",ye[V.ERROR]="error",ye),pf=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(t<e.logLevel)){var i=new Date().toISOString(),o=ff[t];if(o)console[o].apply(console,Pt(["["+i+"]  "+e.name+":"],n));else throw new Error("Attempted to log a message with an invalid logType (value: "+t+")")}},Da=function(){function e(t){this.name=t,this._logLevel=lf,this._logHandler=pf,this._userLogHandler=null,Po.push(this)}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in V))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),e.prototype.setLogLevel=function(t){this._logLevel=typeof t=="string"?Na[t]:t},Object.defineProperty(e.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),e.prototype.debug=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,Pt([this,V.DEBUG],t)),this._logHandler.apply(this,Pt([this,V.DEBUG],t))},e.prototype.log=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,Pt([this,V.VERBOSE],t)),this._logHandler.apply(this,Pt([this,V.VERBOSE],t))},e.prototype.info=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,Pt([this,V.INFO],t)),this._logHandler.apply(this,Pt([this,V.INFO],t))},e.prototype.warn=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,Pt([this,V.WARN],t)),this._logHandler.apply(this,Pt([this,V.WARN],t))},e.prototype.error=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,Pt([this,V.ERROR],t)),this._logHandler.apply(this,Pt([this,V.ERROR],t))},e}();function df(e){Po.forEach(function(t){t.setLogLevel(e)})}function gf(e,t){for(var n=function(s){var u=null;t&&t.level&&(u=Na[t.level]),e===null?s.userLogHandler=null:s.userLogHandler=function(a,c){for(var h=[],l=2;l<arguments.length;l++)h[l-2]=arguments[l];var f=h.map(function(p){if(p==null)return null;if(typeof p=="string")return p;if(typeof p=="number"||typeof p=="boolean")return p.toString();if(p instanceof Error)return p.message;try{return JSON.stringify(p)}catch{return null}}).filter(function(p){return p}).join(" ");c>=(u!=null?u:a.logLevel)&&e({level:V[c].toLowerCase(),message:f,args:h,type:a.name})}},r=0,i=Po;r<i.length;r++){var o=i[r];n(o)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Zt,vf=(Zt={},Zt["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",Zt["bad-app-name"]="Illegal App name: '{$appName}",Zt["duplicate-app"]="Firebase App named '{$appName}' already exists",Zt["app-deleted"]="Firebase App named '{$appName}' already deleted",Zt["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",Zt["invalid-log-argument"]="First argument to `onLog` must be null or a function.",Zt),ze=new Oo("app","Firebase",vf),Ca="@firebase/app",yf="0.6.30",mf="@firebase/analytics",wf="@firebase/app-check",bf="@firebase/auth",Ef="@firebase/database",If="@firebase/functions",Tf="@firebase/installations",_f="@firebase/messaging",Sf="@firebase/performance",Af="@firebase/remote-config",Nf="@firebase/storage",Df="@firebase/firestore",Cf="firebase-wrapper";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ct,Lr="[DEFAULT]",xf=(ct={},ct[Ca]="fire-core",ct[mf]="fire-analytics",ct[wf]="fire-app-check",ct[bf]="fire-auth",ct[Ef]="fire-rtdb",ct[If]="fire-fn",ct[Tf]="fire-iid",ct[_f]="fire-fcm",ct[Sf]="fire-perf",ct[Af]="fire-rc",ct[Nf]="fire-gcs",ct[Df]="fire-fst",ct["fire-js"]="fire-js",ct[Cf]="fire-js-all",ct);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xe=new Da("@firebase/app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Dr=function(){function e(t,n,r){var i=this;this.firebase_=r,this.isDeleted_=!1,this.name_=n.name,this.automaticDataCollectionEnabled_=n.automaticDataCollectionEnabled||!1,this.options_=Bl(t),this.container=new hf(n.name),this._addComponent(new ai("app",function(){return i},"PUBLIC")),this.firebase_.INTERNAL.components.forEach(function(o){return i._addComponent(o)})}return Object.defineProperty(e.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),e.prototype.delete=function(){var t=this;return new Promise(function(n){t.checkDestroyed_(),n()}).then(function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map(function(n){return n.delete()}))}).then(function(){t.isDeleted_=!0})},e.prototype._getService=function(t,n){var r;n===void 0&&(n=Lr),this.checkDestroyed_();var i=this.container.getProvider(t);return!i.isInitialized()&&((r=i.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&i.initialize(),i.getImmediate({identifier:n})},e.prototype._removeServiceInstance=function(t,n){n===void 0&&(n=Lr),this.container.getProvider(t).clearInstance(n)},e.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(n){Xe.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,n)}},e.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},e.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},e.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw ze.create("app-deleted",{appName:this.name_})},e}();Dr.prototype.name&&Dr.prototype.options||Dr.prototype.delete||console.log("dc");var kf="8.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rf(e){var t={},n=new Map,r={__esModule:!0,initializeApp:s,app:o,registerVersion:c,setLogLevel:df,onLog:h,apps:null,SDK_VERSION:kf,INTERNAL:{registerComponent:a,removeApp:i,components:n,useAsService:l}};r.default=r,Object.defineProperty(r,"apps",{get:u});function i(f){delete t[f]}function o(f){if(f=f||Lr,!tu(t,f))throw ze.create("no-app",{appName:f});return t[f]}o.App=e;function s(f,p){if(p===void 0&&(p={}),typeof p!="object"||p===null){var d=p;p={name:d}}var v=p;v.name===void 0&&(v.name=Lr);var b=v.name;if(typeof b!="string"||!b)throw ze.create("bad-app-name",{appName:String(b)});if(tu(t,b))throw ze.create("duplicate-app",{appName:b});var I=new e(f,v,r);return t[b]=I,I}function u(){return Object.keys(t).map(function(f){return t[f]})}function a(f){var p=f.name;if(n.has(p))return Xe.debug("There were multiple attempts to register component "+p+"."),f.type==="PUBLIC"?r[p]:null;if(n.set(p,f),f.type==="PUBLIC"){var d=function(N){if(N===void 0&&(N=o()),typeof N[p]!="function")throw ze.create("invalid-app-argument",{appName:p});return N[p]()};f.serviceProps!==void 0&&Ln(d,f.serviceProps),r[p]=d,e.prototype[p]=function(){for(var N=[],A=0;A<arguments.length;A++)N[A]=arguments[A];var O=this._getService.bind(this,p);return O.apply(this,f.multipleInstances?N:[])}}for(var v=0,b=Object.keys(t);v<b.length;v++){var I=b[v];t[I]._addComponent(f)}return f.type==="PUBLIC"?r[p]:null}function c(f,p,d){var v,b=(v=xf[f])!==null&&v!==void 0?v:f;d&&(b+="-"+d);var I=b.match(/\s|\//),N=p.match(/\s|\//);if(I||N){var A=['Unable to register library "'+b+'" with version "'+p+'":'];I&&A.push('library name "'+b+'" contains illegal characters (whitespace or "/")'),I&&N&&A.push("and"),N&&A.push('version name "'+p+'" contains illegal characters (whitespace or "/")'),Xe.warn(A.join(" "));return}a(new ai(b+"-version",function(){return{library:b,version:p}},"VERSION"))}function h(f,p){if(f!==null&&typeof f!="function")throw ze.create("invalid-log-argument");gf(f,p)}function l(f,p){if(p==="serverAuth")return null;var d=p;return d}return r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xa(){var e=Rf(Dr);e.INTERNAL=Pn(Pn({},e.INTERNAL),{createFirebaseNamespace:xa,extendNamespace:t,createSubscribe:rf,ErrorFactory:Oo,deepExtend:Ln});function t(n){Ln(e,n)}return e}var Lo=xa();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Of=function(){function e(t){this.container=t}return e.prototype.getPlatformInfoString=function(){var t=this.container.getProviders();return t.map(function(n){if(Pf(n)){var r=n.getImmediate();return r.library+"/"+r.version}else return null}).filter(function(n){return n}).join(" ")},e}();function Pf(e){var t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lf(e,t){e.INTERNAL.registerComponent(new ai("platform-logger",function(n){return new Of(n)},"PRIVATE")),e.registerVersion(Ca,yf,t),e.registerVersion("fire-js","")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if($l()&&self.firebase!==void 0){Xe.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);var eu=self.firebase.SDK_VERSION;eu&&eu.indexOf("LITE")>=0&&Xe.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}var Ff=Lo.initializeApp;Lo.initializeApp=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Aa()&&Xe.warn(`
      Warning: This is a browser-targeted Firebase bundle but it appears it is being
      run in a Node environment.  If running in a Node environment, make sure you
      are using the bundle specified by the "main" field in package.json.
      
      If you are using Webpack, you can specify "main" as the first item in
      "resolve.mainFields":
      https://webpack.js.org/configuration/resolve/#resolvemainfields
      
      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"
      as the first item in "mainFields", e.g. ['main', 'module'].
      https://github.com/rollup/@rollup/plugin-node-resolve
      `),Ff.apply(void 0,e)};var Fn=Lo;Lf(Fn);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var io=function(e,t){return io=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},io(e,t)};function Mf(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");io(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function ka(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}var Vf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},S,Fo=Fo||{},R=Vf||self;function Fr(){}function oo(e){var t=typeof e;return t=t!="object"?t:e?Array.isArray(e)?"array":t:"null",t=="array"||t=="object"&&typeof e.length=="number"}function Zn(e){var t=typeof e;return t=="object"&&e!=null||t=="function"}function Uf(e){return Object.prototype.hasOwnProperty.call(e,ji)&&e[ji]||(e[ji]=++qf)}var ji="closure_uid_"+(1e9*Math.random()>>>0),qf=0;function Bf(e,t,n){return e.call.apply(e.bind,arguments)}function jf(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),e.apply(t,i)}}return function(){return e.apply(t,arguments)}}function st(e,t,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?st=Bf:st=jf,st.apply(null,arguments)}function wr(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),e.apply(this,r)}}function at(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Vb=function(r,i,o){for(var s=Array(arguments.length-2),u=2;u<arguments.length;u++)s[u-2]=arguments[u];return t.prototype[i].apply(r,s)}}function fe(){this.s=this.s,this.o=this.o}var Kf=0;fe.prototype.s=!1;fe.prototype.na=function(){!this.s&&(this.s=!0,this.M(),Kf!=0)&&Uf(this)};fe.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var Ra=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if(typeof e=="string")return typeof t!="string"||t.length!=1?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},Oa=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i=typeof e=="string"?e.split(""):e,o=0;o<r;o++)o in i&&t.call(n,i[o],o,e)};function zf(e){t:{for(var t=Lp,n=e.length,r=typeof e=="string"?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break t}t=-1}return 0>t?null:typeof e=="string"?e.charAt(t):e[t]}function nu(e){return Array.prototype.concat.apply([],arguments)}function Mo(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function Mr(e){return/^[\s\xa0]*$/.test(e)}var ru=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function yt(e,t){return e.indexOf(t)!=-1}function Ki(e,t){return e<t?-1:e>t?1:0}var mt;t:{var iu=R.navigator;if(iu){var ou=iu.userAgent;if(ou){mt=ou;break t}}mt=""}function Vo(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function Pa(e){var t={};for(var n in e)t[n]=e[n];return t}var su="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function La(e,t){for(var n,r,i=1;i<arguments.length;i++){r=arguments[i];for(n in r)e[n]=r[n];for(var o=0;o<su.length;o++)n=su[o],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function Uo(e){return Uo[" "](e),e}Uo[" "]=Fr;function Gf(e){var t=Qf;return Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=e(9)}var $f=yt(mt,"Opera"),Je=yt(mt,"Trident")||yt(mt,"MSIE"),Fa=yt(mt,"Edge"),so=Fa||Je,Ma=yt(mt,"Gecko")&&!(yt(mt.toLowerCase(),"webkit")&&!yt(mt,"Edge"))&&!(yt(mt,"Trident")||yt(mt,"MSIE"))&&!yt(mt,"Edge"),Hf=yt(mt.toLowerCase(),"webkit")&&!yt(mt,"Edge");function Va(){var e=R.document;return e?e.documentMode:void 0}var Vr;t:{var zi="",Gi=function(){var e=mt;if(Ma)return/rv:([^\);]+)(\)|;)/.exec(e);if(Fa)return/Edge\/([\d\.]+)/.exec(e);if(Je)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e);if(Hf)return/WebKit\/(\S+)/.exec(e);if($f)return/(?:Version)[ \/]?(\S+)/.exec(e)}();if(Gi&&(zi=Gi?Gi[1]:""),Je){var $i=Va();if($i!=null&&$i>parseFloat(zi)){Vr=String($i);break t}}Vr=zi}var Qf={};function Wf(){return Gf(function(){for(var e=0,t=ru(String(Vr)).split("."),n=ru("9").split("."),r=Math.max(t.length,n.length),i=0;e==0&&i<r;i++){var o=t[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],o[0].length==0&&s[0].length==0)break;e=Ki(o[1].length==0?0:parseInt(o[1],10),s[1].length==0?0:parseInt(s[1],10))||Ki(o[2].length==0,s[2].length==0)||Ki(o[2],s[2]),o=o[3],s=s[3]}while(e==0)}return 0<=e})}var uo;if(R.document&&Je){var uu=Va();uo=uu||parseInt(Vr,10)||void 0}else uo=void 0;var Yf=uo,Xf=function(){if(!R.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{R.addEventListener("test",Fr,t),R.removeEventListener("test",Fr,t)}catch{}return e}();function pt(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}pt.prototype.h=function(){this.defaultPrevented=!0};function Mn(e,t){if(pt.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(Ma){t:{try{Uo(t.nodeName);var i=!0;break t}catch{}i=!1}i||(t=null)}}else n=="mouseover"?t=e.fromElement:n=="mouseout"&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=e.clientX!==void 0?e.clientX:e.pageX,this.clientY=e.clientY!==void 0?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=typeof e.pointerType=="string"?e.pointerType:Jf[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&Mn.Z.h.call(this)}}at(Mn,pt);var Jf={2:"touch",3:"pen",4:"mouse"};Mn.prototype.h=function(){Mn.Z.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var tr="closure_listenable_"+(1e6*Math.random()|0),Zf=0;function tp(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ia=i,this.key=++Zf,this.ca=this.fa=!1}function ci(e){e.ca=!0,e.listener=null,e.proxy=null,e.src=null,e.ia=null}function hi(e){this.src=e,this.g={},this.h=0}hi.prototype.add=function(e,t,n,r,i){var o=e.toString();e=this.g[o],e||(e=this.g[o]=[],this.h++);var s=co(e,t,r,i);return-1<s?(t=e[s],n||(t.fa=!1)):(t=new tp(t,this.src,o,!!r,i),t.fa=n,e.push(t)),t};function ao(e,t){var n=t.type;if(n in e.g){var r=e.g[n],i=Ra(r,t),o;(o=0<=i)&&Array.prototype.splice.call(r,i,1),o&&(ci(t),e.g[n].length==0&&(delete e.g[n],e.h--))}}function co(e,t,n,r){for(var i=0;i<e.length;++i){var o=e[i];if(!o.ca&&o.listener==t&&o.capture==!!n&&o.ia==r)return i}return-1}var qo="closure_lm_"+(1e6*Math.random()|0),Hi={};function Ua(e,t,n,r,i){if(r&&r.once)return Ba(e,t,n,r,i);if(Array.isArray(t)){for(var o=0;o<t.length;o++)Ua(e,t[o],n,r,i);return null}return n=Ko(n),e&&e[tr]?e.N(t,n,Zn(r)?!!r.capture:!!r,i):qa(e,t,n,!1,r,i)}function qa(e,t,n,r,i,o){if(!t)throw Error("Invalid event type");var s=Zn(i)?!!i.capture:!!i,u=jo(e);if(u||(e[qo]=u=new hi(e)),n=u.add(t,n,r,s,o),n.proxy)return n;if(r=ep(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)Xf||(i=s),i===void 0&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(Ka(t.toString()),r);else if(e.addListener&&e.removeListener)e.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function ep(){function e(n){return t.call(e.src,e.listener,n)}var t=np;return e}function Ba(e,t,n,r,i){if(Array.isArray(t)){for(var o=0;o<t.length;o++)Ba(e,t[o],n,r,i);return null}return n=Ko(n),e&&e[tr]?e.O(t,n,Zn(r)?!!r.capture:!!r,i):qa(e,t,n,!0,r,i)}function ja(e,t,n,r,i){if(Array.isArray(t))for(var o=0;o<t.length;o++)ja(e,t[o],n,r,i);else r=Zn(r)?!!r.capture:!!r,n=Ko(n),e&&e[tr]?(e=e.i,t=String(t).toString(),t in e.g&&(o=e.g[t],n=co(o,n,r,i),-1<n&&(ci(o[n]),Array.prototype.splice.call(o,n,1),o.length==0&&(delete e.g[t],e.h--)))):e&&(e=jo(e))&&(t=e.g[t.toString()],e=-1,t&&(e=co(t,n,r,i)),(n=-1<e?t[e]:null)&&Bo(n))}function Bo(e){if(typeof e!="number"&&e&&!e.ca){var t=e.src;if(t&&t[tr])ao(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(Ka(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=jo(t))?(ao(n,e),n.h==0&&(n.src=null,t[qo]=null)):ci(e)}}}function Ka(e){return e in Hi?Hi[e]:Hi[e]="on"+e}function np(e,t){if(e.ca)e=!0;else{t=new Mn(t,this);var n=e.listener,r=e.ia||e.src;e.fa&&Bo(e),e=n.call(r,t)}return e}function jo(e){return e=e[qo],e instanceof hi?e:null}var Qi="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ko(e){return typeof e=="function"?e:(e[Qi]||(e[Qi]=function(t){return e.handleEvent(t)}),e[Qi])}function nt(){fe.call(this),this.i=new hi(this),this.P=this,this.I=null}at(nt,fe);nt.prototype[tr]=!0;nt.prototype.removeEventListener=function(e,t,n,r){ja(this,e,t,n,r)};function ut(e,t){var n,r=e.I;if(r)for(n=[];r;r=r.I)n.push(r);if(e=e.P,r=t.type||t,typeof t=="string")t=new pt(t,e);else if(t instanceof pt)t.target=t.target||e;else{var i=t;t=new pt(r,e),La(t,i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=t.g=n[o];i=br(s,r,!0,t)&&i}if(s=t.g=e,i=br(s,r,!0,t)&&i,i=br(s,r,!1,t)&&i,n)for(o=0;o<n.length;o++)s=t.g=n[o],i=br(s,r,!1,t)&&i}nt.prototype.M=function(){if(nt.Z.M.call(this),this.i){var e=this.i,t;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)ci(n[r]);delete e.g[t],e.h--}}this.I=null};nt.prototype.N=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)};nt.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};function br(e,t,n,r){if(t=e.i.g[String(t)],!t)return!0;t=t.concat();for(var i=!0,o=0;o<t.length;++o){var s=t[o];if(s&&!s.ca&&s.capture==n){var u=s.listener,a=s.ia||s.src;s.fa&&ao(e.i,s),i=u.call(a,r)!==!1&&i}}return i&&!r.defaultPrevented}var zo=R.JSON.stringify;function rp(){var e=Ga,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var ip=function(){function e(){this.h=this.g=null}return e.prototype.add=function(t,n){var r=za.get();r.set(t,n),this.h?this.h.next=r:this.g=r,this.h=r},e}(),za=new(function(){function e(t,n){this.i=t,this.j=n,this.h=0,this.g=null}return e.prototype.get=function(){var t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t},e}())(function(){return new op},function(e){return e.reset()}),op=function(){function e(){this.next=this.g=this.h=null}return e.prototype.set=function(t,n){this.h=t,this.g=n,this.next=null},e.prototype.reset=function(){this.next=this.g=this.h=null},e}();function sp(e){R.setTimeout(function(){throw e},0)}function Go(e,t){ho||up(),lo||(ho(),lo=!0),Ga.add(e,t)}var ho;function up(){var e=R.Promise.resolve(void 0);ho=function(){e.then(ap)}}var lo=!1,Ga=new ip;function ap(){for(var e;e=rp();){try{e.h.call(e.g)}catch(n){sp(n)}var t=za;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}lo=!1}function li(e,t){nt.call(this),this.h=e||1,this.g=t||R,this.j=st(this.kb,this),this.l=Date.now()}at(li,nt);S=li.prototype;S.da=!1;S.S=null;S.kb=function(){if(this.da){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-e):(this.S&&(this.g.clearTimeout(this.S),this.S=null),ut(this,"tick"),this.da&&($o(this),this.start()))}};S.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function $o(e){e.da=!1,e.S&&(e.g.clearTimeout(e.S),e.S=null)}S.M=function(){li.Z.M.call(this),$o(this),delete this.g};function Ho(e,t,n){if(typeof e=="function")n&&(e=st(e,n));else if(e&&typeof e.handleEvent=="function")e=st(e.handleEvent,e);else throw Error("Invalid listener argument");return 2147483647<Number(t)?-1:R.setTimeout(e,t||0)}function $a(e){e.g=Ho(function(){e.g=null,e.i&&(e.i=!1,$a(e))},e.j);var t=e.h;e.h=null,e.m.apply(null,t)}var cp=function(e){Mf(t,e);function t(n,r){var i=e.call(this)||this;return i.m=n,i.j=r,i.h=null,i.i=!1,i.g=null,i}return t.prototype.l=function(n){this.h=arguments,this.g?this.i=!0:$a(this)},t.prototype.M=function(){e.prototype.M.call(this),this.g&&(R.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},t}(fe);function Vn(e){fe.call(this),this.h=e,this.g={}}at(Vn,fe);var au=[];function Ha(e,t,n,r){Array.isArray(n)||(n&&(au[0]=n.toString()),n=au);for(var i=0;i<n.length;i++){var o=Ua(t,n[i],r||e.handleEvent,!1,e.h||e);if(!o)break;e.g[o.key]=o}}function Qa(e){Vo(e.g,function(t,n){this.g.hasOwnProperty(n)&&Bo(t)},e),e.g={}}Vn.prototype.M=function(){Vn.Z.M.call(this),Qa(this)};Vn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function fi(){this.g=!0}fi.prototype.Aa=function(){this.g=!1};function hp(e,t,n,r,i,o){e.info(function(){if(e.g)if(o)for(var s="",u=o.split("&"),a=0;a<u.length;a++){var c=u[a].split("=");if(1<c.length){var h=c[0];c=c[1];var l=h.split("_");s=2<=l.length&&l[1]=="type"?s+(h+"="+c+"&"):s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+`
`+n+`
`+s})}function lp(e,t,n,r,i,o,s){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+`
`+n+`
`+o+" "+s})}function He(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+pp(e,n)+(r?" "+r:"")})}function fp(e,t){e.info(function(){return"TIMEOUT: "+t})}fi.prototype.info=function(){};function pp(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n){for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if(o!="noop"&&o!="stop"&&o!="close")for(var s=1;s<i.length;s++)i[s]=""}}}}return zo(n)}catch{return t}}var Pe={},cu=null;function pi(){return cu=cu||new nt}Pe.Ma="serverreachability";function Wa(e){pt.call(this,Pe.Ma,e)}at(Wa,pt);function Un(e){var t=pi();ut(t,new Wa(t))}Pe.STAT_EVENT="statevent";function Ya(e,t){pt.call(this,Pe.STAT_EVENT,e),this.stat=t}at(Ya,pt);function bt(e){var t=pi();ut(t,new Ya(t,e))}Pe.Na="timingevent";function Xa(e,t){pt.call(this,Pe.Na,e),this.size=t}at(Xa,pt);function er(e,t){if(typeof e!="function")throw Error("Fn must not be null and must be a function");return R.setTimeout(function(){e()},t)}var di={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},Ja={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function Qo(){}Qo.prototype.h=null;function hu(e){return e.h||(e.h=e.i())}function Za(){}var nr={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function Wo(){pt.call(this,"d")}at(Wo,pt);function Yo(){pt.call(this,"c")}at(Yo,pt);var fo;function gi(){}at(gi,Qo);gi.prototype.g=function(){return new XMLHttpRequest};gi.prototype.i=function(){return{}};fo=new gi;function rr(e,t,n,r){this.l=e,this.j=t,this.m=n,this.X=r||1,this.V=new Vn(this),this.P=dp,e=so?125:void 0,this.W=new li(e),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new tc}function tc(){this.i=null,this.g="",this.h=!1}var dp=45e3,po={},Ur={};S=rr.prototype;S.setTimeout=function(e){this.P=e};function go(e,t,n){e.K=1,e.v=yi(Yt(t)),e.s=n,e.U=!0,ec(e,null)}function ec(e,t){e.F=Date.now(),ir(e),e.A=Yt(e.v);var n=e.A,r=e.X;Array.isArray(r)||(r=[String(r)]),ac(n.h,"t",r),e.C=0,n=e.l.H,e.h=new tc,e.g=Dc(e.l,n?t:null,!e.s),0<e.O&&(e.L=new cp(st(e.Ia,e,e.g),e.O)),Ha(e.V,e.g,"readystatechange",e.gb),t=e.H?Pa(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.s,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Un(),hp(e.j,e.u,e.A,e.m,e.X,e.s)}S.gb=function(e){e=e.target;var t=this.L;t&&Gt(e)==3?t.l():this.Ia(e)};S.Ia=function(e){try{if(e==this.g)t:{var t=Gt(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>t)&&(t!=3||so||this.g&&(this.h.h||this.g.ga()||du(this.g)))){this.I||t!=4||n==7||(n==8||0>=r?Un(3):Un(2)),vi(this);var i=this.g.ba();this.N=i;e:if(nc(this)){var o=du(this.g);e="";var s=o.length,u=Gt(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){be(this),Cn(this);var a="";break e}this.h.i=new R.TextDecoder}for(n=0;n<s;n++)this.h.h=!0,e+=this.h.i.decode(o[n],{stream:u&&n==s-1});o.splice(0,s),this.h.g+=e,this.C=0,a=this.h.g}else a=this.g.ga();if(this.i=i==200,lp(this.j,this.u,this.A,this.m,this.X,t,i),this.i){if(this.$&&!this.J){e:{if(this.g){var c,h=this.g;if((c=h.g?h.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Mr(c)){var l=c;break e}}l=null}if(i=l)He(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,vo(this,i);else{this.i=!1,this.o=3,bt(12),be(this),Cn(this);break t}}this.U?(rc(this,t,a),so&&this.i&&t==3&&(Ha(this.V,this.W,"tick",this.fb),this.W.start())):(He(this.j,this.m,a,null),vo(this,a)),t==4&&be(this),this.i&&!this.I&&(t==4?_c(this.l,this):(this.i=!1,ir(this)))}else i==400&&0<a.indexOf("Unknown SID")?(this.o=3,bt(12)):(this.o=0,bt(13)),be(this),Cn(this)}}}catch{}finally{}};function nc(e){return e.g?e.u=="GET"&&e.K!=2&&e.l.Ba:!1}function rc(e,t,n){for(var r=!0,i;!e.I&&e.C<n.length;)if(i=gp(e,n),i==Ur){t==4&&(e.o=4,bt(14),r=!1),He(e.j,e.m,null,"[Incomplete Response]");break}else if(i==po){e.o=4,bt(15),He(e.j,e.m,n,"[Invalid Chunk]"),r=!1;break}else He(e.j,e.m,i,null),vo(e,i);nc(e)&&i!=Ur&&i!=po&&(e.h.g="",e.C=0),t!=4||n.length!=0||e.h.h||(e.o=1,bt(16),r=!1),e.i=e.i&&r,r?0<n.length&&!e.aa&&(e.aa=!0,t=e.l,t.g==e&&t.$&&!t.L&&(t.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),os(t),t.L=!0,bt(11))):(He(e.j,e.m,n,"[Invalid Chunked Response]"),be(e),Cn(e))}S.fb=function(){if(this.g){var e=Gt(this.g),t=this.g.ga();this.C<t.length&&(vi(this),rc(this,e,t),this.i&&e!=4&&ir(this))}};function gp(e,t){var n=e.C,r=t.indexOf(`
`,n);return r==-1?Ur:(n=Number(t.substring(n,r)),isNaN(n)?po:(r+=1,r+n>t.length?Ur:(t=t.substr(r,n),e.C=r+n,t)))}S.cancel=function(){this.I=!0,be(this)};function ir(e){e.Y=Date.now()+e.P,ic(e,e.P)}function ic(e,t){if(e.B!=null)throw Error("WatchDog timer not null");e.B=er(st(e.eb,e),t)}function vi(e){e.B&&(R.clearTimeout(e.B),e.B=null)}S.eb=function(){this.B=null;var e=Date.now();0<=e-this.Y?(fp(this.j,this.A),this.K!=2&&(Un(),bt(17)),be(this),this.o=2,Cn(this)):ic(this,this.Y-e)};function Cn(e){e.l.G==0||e.I||_c(e.l,e)}function be(e){vi(e);var t=e.L;t&&typeof t.na=="function"&&t.na(),e.L=null,$o(e.W),Qa(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function vo(e,t){try{var n=e.l;if(n.G!=0&&(n.g==e||yo(n.i,e))){if(n.I=e.N,!e.J&&yo(n.i,e)&&n.G==3){try{var r=n.Ca.g.parse(t)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){t:if(!n.u){if(n.g)if(n.g.F+3e3<e.F)Kr(n),bi(n);else break t;is(n),bt(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&n.A==0&&!n.v&&(n.v=er(st(n.ab,n),6e3));if(1>=lc(n.i)&&n.ka){try{n.ka()}catch{}n.ka=void 0}}else Ee(n,11)}else if((e.J||n.g==e)&&Kr(n),!Mr(t))for(i=n.Ca.g.parse(t),t=0;t<i.length;t++){var o=i[t];if(n.U=o[0],o=o[1],n.G==2)if(o[0]=="c"){n.J=o[1],n.la=o[2];var s=o[3];s!=null&&(n.ma=s,n.h.info("VER="+n.ma));var u=o[4];u!=null&&(n.za=u,n.h.info("SVER="+n.za));var a=o[5];a!=null&&typeof a=="number"&&0<a&&(r=1.5*a,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=e.g;if(c){var h=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var l=r.i;!l.g&&(yt(h,"spdy")||yt(h,"quic")||yt(h,"h2"))&&(l.j=l.l,l.g=new Set,l.h&&(Zo(l,l.h),l.h=null))}if(r.D){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.sa=f,z(r.F,r.D,f))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-e.F,n.h.info("Handshake RTT: "+n.O+"ms")),r=n;var p=e;if(r.oa=Nc(r,r.H?r.la:null,r.W),p.J){fc(r.i,p);var d=p,v=r.K;v&&d.setTimeout(v),d.B&&(vi(d),ir(d)),r.g=p}else Ic(r);0<n.l.length&&Ei(n)}else o[0]!="stop"&&o[0]!="close"||Ee(n,7);else n.G==3&&(o[0]=="stop"||o[0]=="close"?o[0]=="stop"?Ee(n,7):rs(n):o[0]!="noop"&&n.j&&n.j.wa(o),n.A=0)}}Un(4)}catch{}}function vp(e){if(e.R&&typeof e.R=="function")return e.R();if(typeof e=="string")return e.split("");if(oo(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}t=[],n=0;for(r in e)t[n++]=e[r];return t}function Xo(e,t){if(e.forEach&&typeof e.forEach=="function")e.forEach(t,void 0);else if(oo(e)||typeof e=="string")Oa(e,t,void 0);else{if(e.T&&typeof e.T=="function")var n=e.T();else if(e.R&&typeof e.R=="function")n=void 0;else if(oo(e)||typeof e=="string"){n=[];for(var r=e.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,e)n[r++]=i;r=vp(e),i=r.length;for(var o=0;o<i;o++)t.call(void 0,r[o],n&&n[o],e)}}function vn(e,t){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof vn)for(n=e.T(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}S=vn.prototype;S.R=function(){Jo(this);for(var e=[],t=0;t<this.g.length;t++)e.push(this.h[this.g[t]]);return e};S.T=function(){return Jo(this),this.g.concat()};function Jo(e){if(e.i!=e.g.length){for(var t=0,n=0;t<e.g.length;){var r=e.g[t];De(e.h,r)&&(e.g[n++]=r),t++}e.g.length=n}if(e.i!=e.g.length){var i={};for(n=t=0;t<e.g.length;)r=e.g[t],De(i,r)||(e.g[n++]=r,i[r]=1),t++;e.g.length=n}}S.get=function(e,t){return De(this.h,e)?this.h[e]:t};S.set=function(e,t){De(this.h,e)||(this.i++,this.g.push(e)),this.h[e]=t};S.forEach=function(e,t){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);e.call(t,o,i,this)}};function De(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var oc=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function yp(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var o=e[n].substring(0,r);i=e[n].substring(r+1)}else o=e[n];t(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Ce(e,t){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,e instanceof Ce){this.g=t!==void 0?t:e.g,qr(this,e.j),this.s=e.s,Br(this,e.i),jr(this,e.m),this.l=e.l,t=e.h;var n=new qn;n.i=t.i,t.g&&(n.g=new vn(t.g),n.h=t.h),lu(this,n),this.o=e.o}else e&&(n=String(e).match(oc))?(this.g=!!t,qr(this,n[1]||"",!0),this.s=xn(n[2]||""),Br(this,n[3]||"",!0),jr(this,n[4]),this.l=xn(n[5]||"",!0),lu(this,n[6]||"",!0),this.o=xn(n[7]||"")):(this.g=!!t,this.h=new qn(null,this.g))}Ce.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Nn(t,fu,!0),":");var n=this.i;return(n||t=="file")&&(e.push("//"),(t=this.s)&&e.push(Nn(t,fu,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&e.push(":",String(n))),(n=this.l)&&(this.i&&n.charAt(0)!="/"&&e.push("/"),e.push(Nn(n,n.charAt(0)=="/"?Ip:Ep,!0))),(n=this.h.toString())&&e.push("?",n),(n=this.o)&&e.push("#",Nn(n,_p)),e.join("")};function Yt(e){return new Ce(e)}function qr(e,t,n){e.j=n?xn(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function Br(e,t,n){e.i=n?xn(t,!0):t}function jr(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function lu(e,t,n){t instanceof qn?(e.h=t,Sp(e.h,e.g)):(n||(t=Nn(t,Tp)),e.h=new qn(t,e.g))}function z(e,t,n){e.h.set(t,n)}function yi(e){return z(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function mp(e){return e instanceof Ce?Yt(e):new Ce(e,void 0)}function wp(e,t,n,r){var i=new Ce(null,void 0);return e&&qr(i,e),t&&Br(i,t),n&&jr(i,n),r&&(i.l=r),i}function xn(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Nn(e,t,n){return typeof e=="string"?(e=encodeURI(e).replace(t,bp),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function bp(e){return e=e.charCodeAt(0),"%"+(e>>4&15).toString(16)+(e&15).toString(16)}var fu=/[#\/\?@]/g,Ep=/[#\?:]/g,Ip=/[#\?]/g,Tp=/[#\?@]/g,_p=/#/g;function qn(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function pe(e){e.g||(e.g=new vn,e.h=0,e.i&&yp(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}S=qn.prototype;S.add=function(e,t){pe(this),this.i=null,e=yn(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this};function sc(e,t){pe(e),t=yn(e,t),De(e.g.h,t)&&(e.i=null,e.h-=e.g.get(t).length,e=e.g,De(e.h,t)&&(delete e.h[t],e.i--,e.g.length>2*e.i&&Jo(e)))}function uc(e,t){return pe(e),t=yn(e,t),De(e.g.h,t)}S.forEach=function(e,t){pe(this),this.g.forEach(function(n,r){Oa(n,function(i){e.call(t,i,r,this)},this)},this)};S.T=function(){pe(this);for(var e=this.g.R(),t=this.g.T(),n=[],r=0;r<t.length;r++)for(var i=e[r],o=0;o<i.length;o++)n.push(t[r]);return n};S.R=function(e){pe(this);var t=[];if(typeof e=="string")uc(this,e)&&(t=nu(t,this.g.get(yn(this,e))));else{e=this.g.R();for(var n=0;n<e.length;n++)t=nu(t,e[n])}return t};S.set=function(e,t){return pe(this),this.i=null,e=yn(this,e),uc(this,e)&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this};S.get=function(e,t){return e?(e=this.R(e),0<e.length?String(e[0]):t):t};function ac(e,t,n){sc(e,t),0<n.length&&(e.i=null,e.g.set(yn(e,t),Mo(n)),e.h+=n.length)}S.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=this.g.T(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.R(r);for(var o=0;o<r.length;o++){var s=i;r[o]!==""&&(s+="="+encodeURIComponent(String(r[o]))),e.push(s)}}return this.i=e.join("&")};function yn(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Sp(e,t){t&&!e.j&&(pe(e),e.i=null,e.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(sc(this,r),ac(this,i,n))},e)),e.j=t}var Ap=function(){function e(t,n){this.h=t,this.g=n}return e}();function cc(e){this.l=e||Np,R.PerformanceNavigationTiming?(e=R.performance.getEntriesByType("navigation"),e=0<e.length&&(e[0].nextHopProtocol=="hq"||e[0].nextHopProtocol=="h2")):e=!!(R.g&&R.g.Ea&&R.g.Ea()&&R.g.Ea().Zb),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Np=10;function hc(e){return e.h?!0:e.g?e.g.size>=e.j:!1}function lc(e){return e.h?1:e.g?e.g.size:0}function yo(e,t){return e.h?e.h==t:e.g?e.g.has(t):!1}function Zo(e,t){e.g?e.g.add(t):e.h=t}function fc(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}cc.prototype.cancel=function(){var e,t;if(this.i=pc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){try{for(var n=ka(this.g.values()),r=n.next();!r.done;r=n.next()){var i=r.value;i.cancel()}}catch(o){e={error:o}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.g.clear()}};function pc(e){var t,n;if(e.h!=null)return e.i.concat(e.h.D);if(e.g!=null&&e.g.size!==0){var r=e.i;try{for(var i=ka(e.g.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r.concat(s.D)}}catch(u){t={error:u}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}return Mo(e.i)}function ts(){}ts.prototype.stringify=function(e){return R.JSON.stringify(e,void 0)};ts.prototype.parse=function(e){return R.JSON.parse(e,void 0)};function Dp(){this.g=new ts}function Cp(e,t,n){var r=n||"";try{Xo(e,function(i,o){var s=i;Zn(i)&&(s=zo(i)),t.push(r+o+"="+encodeURIComponent(s))})}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function xp(e,t){var n=new fi;if(R.Image){var r=new Image;r.onload=wr(Er,n,r,"TestLoadImage: loaded",!0,t),r.onerror=wr(Er,n,r,"TestLoadImage: error",!1,t),r.onabort=wr(Er,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=wr(Er,n,r,"TestLoadImage: timeout",!1,t),R.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}function Er(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch{}}function or(e){this.l=e.$b||null,this.j=e.ib||!1}at(or,Qo);or.prototype.g=function(){return new mi(this.l,this.j)};or.prototype.i=function(e){return function(){return e}}({});function mi(e,t){nt.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=es,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}at(mi,nt);var es=0;S=mi.prototype;S.open=function(e,t){if(this.readyState!=es)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,Bn(this)};S.send=function(e){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||R).fetch(new Request(this.B,t)).then(this.Va.bind(this),this.ha.bind(this))};S.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,sr(this)),this.readyState=es};S.Va=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Bn(this)),this.g&&(this.readyState=3,Bn(this),this.g)))if(this.responseType==="arraybuffer")e.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(typeof R.ReadableStream<"u"&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;dc(this)}else e.text().then(this.Ua.bind(this),this.ha.bind(this))};function dc(e){e.j.read().then(e.Sa.bind(e)).catch(e.ha.bind(e))}S.Sa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?sr(this):Bn(this),this.readyState==3&&dc(this)}};S.Ua=function(e){this.g&&(this.response=this.responseText=e,sr(this))};S.Ta=function(e){this.g&&(this.response=e,sr(this))};S.ha=function(){this.g&&sr(this)};function sr(e){e.readyState=4,e.l=null,e.j=null,e.A=null,Bn(e)}S.setRequestHeader=function(e,t){this.v.append(e,t)};S.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""};S.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join(`\r
`)};function Bn(e){e.onreadystatechange&&e.onreadystatechange.call(e)}Object.defineProperty(mi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(e){this.m=e?"include":"same-origin"}});var kp=R.JSON.parse;function J(e){nt.call(this),this.headers=new vn,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=gc,this.K=this.L=!1}at(J,nt);var gc="",Rp=/^https?$/i,Op=["POST","PUT"];S=J.prototype;S.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+e);t=t?t.toUpperCase():"GET",this.H=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():fo.g(),this.C=this.u?hu(this.u):hu(fo),this.g.onreadystatechange=st(this.Fa,this);try{this.F=!0,this.g.open(t,String(e),!0),this.F=!1}catch(o){pu(this,o);return}e=n||"";var i=new vn(this.headers);r&&Xo(r,function(o,s){i.set(s,o)}),r=zf(i.T()),n=R.FormData&&e instanceof R.FormData,!(0<=Ra(Op,t))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(o,s){this.g.setRequestHeader(s,o)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{mc(this),0<this.B&&((this.K=Pp(this.g))?(this.g.timeout=this.B,this.g.ontimeout=st(this.pa,this)):this.A=Ho(this.pa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(o){pu(this,o)}};function Pp(e){return Je&&Wf()&&typeof e.timeout=="number"&&e.ontimeout!==void 0}function Lp(e){return e.toLowerCase()=="content-type"}S.pa=function(){typeof Fo<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,ut(this,"timeout"),this.abort(8))};function pu(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,vc(e),wi(e)}function vc(e){e.D||(e.D=!0,ut(e,"complete"),ut(e,"error"))}S.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,ut(this,"complete"),ut(this,"abort"),wi(this))};S.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),wi(this,!0)),J.Z.M.call(this)};S.Fa=function(){this.s||(this.F||this.v||this.l?yc(this):this.cb())};S.cb=function(){yc(this)};function yc(e){if(e.h&&typeof Fo<"u"&&(!e.C[1]||Gt(e)!=4||e.ba()!=2)){if(e.v&&Gt(e)==4)Ho(e.Fa,0,e);else if(ut(e,"readystatechange"),Gt(e)==4){e.h=!1;try{var t=e.ba();t:switch(t){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var n=!0;break t;default:n=!1}var r;if(!(r=n)){var i;if(i=t===0){var o=String(e.H).match(oc)[1]||null;if(!o&&R.self&&R.self.location){var s=R.self.location.protocol;o=s.substr(0,s.length-1)}i=!Rp.test(o?o.toLowerCase():"")}r=i}if(r)ut(e,"complete"),ut(e,"success");else{e.m=6;try{var u=2<Gt(e)?e.g.statusText:""}catch{u=""}e.j=u+" ["+e.ba()+"]",vc(e)}}finally{wi(e)}}}}function wi(e,t){if(e.g){mc(e);var n=e.g,r=e.C[0]?Fr:null;e.g=null,e.C=null,t||ut(e,"ready");try{n.onreadystatechange=r}catch{}}}function mc(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(R.clearTimeout(e.A),e.A=null)}function Gt(e){return e.g?e.g.readyState:0}S.ba=function(){try{return 2<Gt(this)?this.g.status:-1}catch{return-1}};S.ga=function(){try{return this.g?this.g.responseText:""}catch{return""}};S.Qa=function(e){if(this.g){var t=this.g.responseText;return e&&t.indexOf(e)==0&&(t=t.substring(e.length)),kp(t)}};function du(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case gc:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch{return null}}S.Da=function(){return this.m};S.La=function(){return typeof this.j=="string"?this.j:String(this.j)};function Fp(e){var t="";return Vo(e,function(n,r){t+=r,t+=":",t+=n,t+=`\r
`}),t}function ns(e,t,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=Fp(n),typeof e=="string"?n!=null&&encodeURIComponent(String(n)):z(e,t,n))}function Sn(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function wc(e){this.za=0,this.l=[],this.h=new fi,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=Sn("failFast",!1,e),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=Sn("baseRetryDelayMs",5e3,e),this.$a=Sn("retryDelaySeedMs",1e4,e),this.Ya=Sn("forwardChannelMaxRetries",2,e),this.ra=Sn("forwardChannelRequestTimeoutMs",2e4,e),this.qa=e&&e.xmlHttpFactory||void 0,this.Ba=e&&e.Yb||!1,this.K=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.J="",this.i=new cc(e&&e.concurrentRequestLimit),this.Ca=new Dp,this.ja=e&&e.fastHandshake||!1,this.Ra=e&&e.Wb||!1,e&&e.Aa&&this.h.Aa(),e&&e.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&e&&e.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!e||e.Xb!==!1}S=wc.prototype;S.ma=8;S.G=1;function rs(e){if(bc(e),e.G==3){var t=e.V++,n=Yt(e.F);z(n,"SID",e.J),z(n,"RID",t),z(n,"TYPE","terminate"),ur(e,n),t=new rr(e,e.h,t,void 0),t.K=2,t.v=yi(Yt(n)),n=!1,R.navigator&&R.navigator.sendBeacon&&(n=R.navigator.sendBeacon(t.v.toString(),"")),!n&&R.Image&&(new Image().src=t.v,n=!0),n||(t.g=Dc(t.l,null),t.g.ea(t.v)),t.F=Date.now(),ir(t)}Ac(e)}S.hb=function(e){try{this.h.info("Origin Trials invoked: "+e)}catch{}};function bi(e){e.g&&(os(e),e.g.cancel(),e.g=null)}function bc(e){bi(e),e.u&&(R.clearTimeout(e.u),e.u=null),Kr(e),e.i.cancel(),e.m&&(typeof e.m=="number"&&R.clearTimeout(e.m),e.m=null)}function Wi(e,t){e.l.push(new Ap(e.Za++,t)),e.G==3&&Ei(e)}function Ei(e){hc(e.i)||e.m||(e.m=!0,Go(e.Ha,e),e.C=0)}function Mp(e,t){return lc(e.i)>=e.i.j-(e.m?1:0)?!1:e.m?(e.l=t.D.concat(e.l),!0):e.G==1||e.G==2||e.C>=(e.Xa?0:e.Ya)?!1:(e.m=er(st(e.Ha,e,t),Sc(e,e.C)),e.C++,!0)}S.Ha=function(e){if(this.m)if(this.m=null,this.G==1){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;var t=new rr(this,this.h,e,void 0),n=this.s;if(this.P&&(n?(n=Pa(n),La(n,this.P)):n=this.P),this.o===null&&(t.H=n),this.ja)t:{for(var r=0,i=0;i<this.l.length;i++){e:{var o=this.l[i];if("__data__"in o.g&&(o=o.g.__data__,typeof o=="string")){o=o.length;break e}o=void 0}if(o===void 0)break;if(r+=o,4096<r){r=i;break t}if(r===4096||i===this.l.length-1){r=i+1;break t}}r=1e3}else r=1e3;r=Ec(this,t,r),i=Yt(this.F),z(i,"RID",e),z(i,"CVER",22),this.D&&z(i,"X-HTTP-Session-Id",this.D),ur(this,i),this.o&&n&&ns(i,this.o,n),Zo(this.i,t),this.Ra&&z(i,"TYPE","init"),this.ja?(z(i,"$req",r),z(i,"SID","null"),t.$=!0,go(t,i,null)):go(t,i,r),this.G=2}}else this.G==3&&(e?gu(this,e):this.l.length==0||hc(this.i)||gu(this))};function gu(e,t){var n;t?n=t.m:n=e.V++;var r=Yt(e.F);z(r,"SID",e.J),z(r,"RID",n),z(r,"AID",e.U),ur(e,r),e.o&&e.s&&ns(r,e.o,e.s),n=new rr(e,e.h,n,e.C+1),e.o===null&&(n.H=e.s),t&&(e.l=t.D.concat(e.l)),t=Ec(e,n,1e3),n.setTimeout(Math.round(.5*e.ra)+Math.round(.5*e.ra*Math.random())),Zo(e.i,n),go(n,r,t)}function ur(e,t){e.j&&Xo({},function(n,r){z(t,r,n)})}function Ec(e,t,n){n=Math.min(e.l.length,n);var r=e.j?st(e.j.Oa,e.j,e):null;t:for(var i=e.l,o=-1;;){var s=["count="+n];o==-1?0<n?(o=i[0].h,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].h,h=i[a].g;if(c-=o,0>c)o=Math.max(0,i[a].h-100),u=!1;else try{Cp(h,s,"req"+c+"_")}catch{r&&r(h)}}if(u){r=s.join("&");break t}}return e=e.l.splice(0,n),t.D=e,r}function Ic(e){e.g||e.u||(e.Y=1,Go(e.Ga,e),e.A=0)}function is(e){return e.g||e.u||3<=e.A?!1:(e.Y++,e.u=er(st(e.Ga,e),Sc(e,e.A)),e.A++,!0)}S.Ga=function(){if(this.u=null,Tc(this),this.$&&!(this.L||this.g==null||0>=this.O)){var e=2*this.O;this.h.info("BP detection timer enabled: "+e),this.B=er(st(this.bb,this),e)}};S.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,bt(10),bi(this),Tc(this))};function os(e){e.B!=null&&(R.clearTimeout(e.B),e.B=null)}function Tc(e){e.g=new rr(e,e.h,"rpc",e.Y),e.o===null&&(e.g.H=e.s),e.g.O=0;var t=Yt(e.oa);z(t,"RID","rpc"),z(t,"SID",e.J),z(t,"CI",e.N?"0":"1"),z(t,"AID",e.U),ur(e,t),z(t,"TYPE","xmlhttp"),e.o&&e.s&&ns(t,e.o,e.s),e.K&&e.g.setTimeout(e.K);var n=e.g;e=e.la,n.K=1,n.v=yi(Yt(t)),n.s=null,n.U=!0,ec(n,e)}S.ab=function(){this.v!=null&&(this.v=null,bi(this),is(this),bt(19))};function Kr(e){e.v!=null&&(R.clearTimeout(e.v),e.v=null)}function _c(e,t){var n=null;if(e.g==t){Kr(e),os(e),e.g=null;var r=2}else if(yo(e.i,t))n=t.D,fc(e.i,t),r=1;else return;if(e.I=t.N,e.G!=0){if(t.i)if(r==1){n=t.s?t.s.length:0,t=Date.now()-t.F;var i=e.C;r=pi(),ut(r,new Xa(r,n)),Ei(e)}else Ic(e);else if(i=t.o,i==3||i==0&&0<e.I||!(r==1&&Mp(e,t)||r==2&&is(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:Ee(e,5);break;case 4:Ee(e,10);break;case 3:Ee(e,6);break;default:Ee(e,2)}}}function Sc(e,t){var n=e.Pa+Math.floor(Math.random()*e.$a);return e.j||(n*=2),n*t}function Ee(e,t){if(e.h.info("Error code "+t),t==2){var n=null;e.j&&(n=null);var r=st(e.jb,e);n||(n=new Ce("//www.google.com/images/cleardot.gif"),R.location&&R.location.protocol=="http"||qr(n,"https"),yi(n)),xp(n.toString(),r)}else bt(2);e.G=0,e.j&&e.j.va(t),Ac(e),bc(e)}S.jb=function(e){e?(this.h.info("Successfully pinged google.com"),bt(2)):(this.h.info("Failed to ping google.com"),bt(1))};function Ac(e){e.G=0,e.I=-1,e.j&&((pc(e.i).length!=0||e.l.length!=0)&&(e.i.i.length=0,Mo(e.l),e.l.length=0),e.j.ua())}function Nc(e,t,n){var r=mp(n);if(r.i!="")t&&Br(r,t+"."+r.i),jr(r,r.m);else{var i=R.location;r=wp(i.protocol,t?t+"."+i.hostname:i.hostname,+i.port,n)}return e.aa&&Vo(e.aa,function(o,s){z(r,s,o)}),t=e.D,n=e.sa,t&&n&&z(r,t,n),z(r,"VER",e.ma),ur(e,r),r}function Dc(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return t=n&&e.Ba&&!e.qa?new J(new or({ib:!0})):new J(e.qa),t.L=e.H,t}function Cc(){}S=Cc.prototype;S.xa=function(){};S.wa=function(){};S.va=function(){};S.ua=function(){};S.Oa=function(){};function zr(){if(Je&&!(10<=Number(Yf)))throw Error("Environmental error: no available transport.")}zr.prototype.g=function(e,t){return new Ot(e,t)};function Ot(e,t){nt.call(this),this.g=new wc(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.P=e,(e=t&&t.httpHeadersOverwriteParam)&&!Mr(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!Mr(t)&&(this.g.D=t,e=this.h,e!==null&&t in e&&(e=this.h,t in e&&delete e[t])),this.j=new mn(this)}at(Ot,nt);Ot.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;e.Wa&&(e.h.info("Origin Trials enabled."),Go(st(e.hb,e,t))),bt(0),e.W=t,e.aa=n||{},e.N=e.X,e.F=Nc(e,null,e.W),Ei(e)};Ot.prototype.close=function(){rs(this.g)};Ot.prototype.u=function(e){if(typeof e=="string"){var t={};t.__data__=e,Wi(this.g,t)}else this.v?(t={},t.__data__=zo(e),Wi(this.g,t)):Wi(this.g,e)};Ot.prototype.M=function(){this.g.j=null,delete this.j,rs(this.g),delete this.g,Ot.Z.M.call(this)};function xc(e){Wo.call(this);var t=e.__sm__;if(t){t:{for(var n in t){e=n;break t}e=void 0}(this.i=e)&&(e=this.i,t=t!==null&&e in t?t[e]:void 0),this.data=t}else this.data=e}at(xc,Wo);function kc(){Yo.call(this),this.status=1}at(kc,Yo);function mn(e){this.g=e}at(mn,Cc);mn.prototype.xa=function(){ut(this.g,"a")};mn.prototype.wa=function(e){ut(this.g,new xc(e))};mn.prototype.va=function(e){ut(this.g,new kc)};mn.prototype.ua=function(){ut(this.g,"b")};zr.prototype.createWebChannel=zr.prototype.g;Ot.prototype.send=Ot.prototype.u;Ot.prototype.open=Ot.prototype.m;Ot.prototype.close=Ot.prototype.close;di.NO_ERROR=0;di.TIMEOUT=8;di.HTTP_ERROR=6;Ja.COMPLETE="complete";Za.EventType=nr;nr.OPEN="a";nr.CLOSE="b";nr.ERROR="c";nr.MESSAGE="d";nt.prototype.listen=nt.prototype.N;J.prototype.listenOnce=J.prototype.O;J.prototype.getLastError=J.prototype.La;J.prototype.getLastErrorCode=J.prototype.Da;J.prototype.getStatus=J.prototype.ba;J.prototype.getResponseJson=J.prototype.Qa;J.prototype.getResponseText=J.prototype.ga;J.prototype.send=J.prototype.ea;var Vp=function(){return new zr},Up=function(){return pi()},Yi=di,qp=Ja,Bp=Pe,vu={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},jp=or,Ir=Za,Kp=J;/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xt=function(){function e(t,n){var r=this;this.previousValue=t,n&&(n.sequenceNumberHandler=function(i){return r.t(i)},this.i=function(i){return n.writeSequenceNumber(i)})}return e.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},e.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},e}();xt.o=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var g={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},w=function(e){function t(n,r){var i=this;return(i=e.call(this,r)||this).code=n,i.message=r,i.name="FirebaseError",i.toString=function(){return i.name+": [code="+i.code+"]: "+i.message},i}return x(t,e),t}(Error),Lt=new Da("@firebase/firestore");function mo(){return Lt.logLevel}function T(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(Lt.logLevel<=V.DEBUG){var r=t.map(ss);Lt.debug.apply(Lt,H(["Firestore (8.10.1): "+e],r))}}function Y(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(Lt.logLevel<=V.ERROR){var r=t.map(ss);Lt.error.apply(Lt,H(["Firestore (8.10.1): "+e],r))}}function Gr(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(Lt.logLevel<=V.WARN){var r=t.map(ss);Lt.warn.apply(Lt,H(["Firestore (8.10.1): "+e],r))}}function ss(e){if(typeof e=="string")return e;try{return t=e,JSON.stringify(t)}catch{return e}var t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D(e){e===void 0&&(e="Unexpected state");var t="FIRESTORE (8.10.1) INTERNAL ASSERTION FAILED: "+e;throw Y(t),new Error(t)}function k(e,t){e||D()}function _(e,t){return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zp(e){var t=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(n);else for(var r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Rc=function(){function e(){}return e.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/t.length)*t.length,r="";r.length<20;)for(var i=zp(40),o=0;o<i.length;++o)r.length<20&&i[o]<n&&(r+=t.charAt(i[o]%t.length));return r},e}();function L(e,t){return e<t?-1:e>t?1:0}function Ze(e,t,n){return e.length===t.length&&e.every(function(r,i){return n(r,t[i])})}function Oc(e){return e+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Tt=function(){function e(t,n){if(this.seconds=t,this.nanoseconds=n,n<0)throw new w(g.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new w(g.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<-62135596800)throw new w(g.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new w(g.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return e.now=function(){return e.fromMillis(Date.now())},e.fromDate=function(t){return e.fromMillis(t.getTime())},e.fromMillis=function(t){var n=Math.floor(t/1e3);return new e(n,Math.floor(1e6*(t-1e3*n)))},e.prototype.toDate=function(){return new Date(this.toMillis())},e.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},e.prototype._compareTo=function(t){return this.seconds===t.seconds?L(this.nanoseconds,t.nanoseconds):L(this.seconds,t.seconds)},e.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},e.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},e.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},e.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},e}(),P=function(){function e(t){this.timestamp=t}return e.fromTimestamp=function(t){return new e(t)},e.min=function(){return new e(new Tt(0,0))},e.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},e.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},e.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},e.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},e.prototype.toTimestamp=function(){return this.timestamp},e}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yu(e){var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Le(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Pc(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Lc=function(){function e(t,n,r){n===void 0?n=0:n>t.length&&D(),r===void 0?r=t.length-n:r>t.length-n&&D(),this.segments=t,this.offset=n,this.len=r}return Object.defineProperty(e.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return e.comparator(this,t)===0},e.prototype.child=function(t){var n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach(function(r){n.push(r)}):n.push(t),this.construct(n)},e.prototype.limit=function(){return this.offset+this.length},e.prototype.popFirst=function(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)},e.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},e.prototype.firstSegment=function(){return this.segments[this.offset]},e.prototype.lastSegment=function(){return this.get(this.length-1)},e.prototype.get=function(t){return this.segments[this.offset+t]},e.prototype.isEmpty=function(){return this.length===0},e.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0},e.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0},e.prototype.forEach=function(t){for(var n=this.offset,r=this.limit();n<r;n++)t(this.segments[n])},e.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},e.comparator=function(t,n){for(var r=Math.min(t.length,n.length),i=0;i<r;i++){var o=t.get(i),s=n.get(i);if(o<s)return-1;if(o>s)return 1}return t.length<n.length?-1:t.length>n.length?1:0},e}(),U=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return x(t,e),t.prototype.construct=function(n,r,i){return new t(n,r,i)},t.prototype.canonicalString=function(){return this.toArray().join("/")},t.prototype.toString=function(){return this.canonicalString()},t.fromString=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];for(var i=[],o=0,s=n;o<s.length;o++){var u=s[o];if(u.indexOf("//")>=0)throw new w(g.INVALID_ARGUMENT,"Invalid segment ("+u+"). Paths must not contain // in them.");i.push.apply(i,u.split("/").filter(function(a){return a.length>0}))}return new t(i)},t.emptyPath=function(){return new t([])},t}(Lc),Gp=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Vt=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return x(t,e),t.prototype.construct=function(n,r,i){return new t(n,r,i)},t.isValidIdentifier=function(n){return Gp.test(n)},t.prototype.canonicalString=function(){return this.toArray().map(function(n){return n=n.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(n)||(n="`"+n+"`"),n}).join(".")},t.prototype.toString=function(){return this.canonicalString()},t.prototype.isKeyField=function(){return this.length===1&&this.get(0)==="__name__"},t.keyField=function(){return new t(["__name__"])},t.fromServerFormat=function(n){for(var r=[],i="",o=0,s=function(){if(i.length===0)throw new w(g.INVALID_ARGUMENT,"Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");r.push(i),i=""},u=!1;o<n.length;){var a=n[o];if(a==="\\"){if(o+1===n.length)throw new w(g.INVALID_ARGUMENT,"Path has trailing escape character: "+n);var c=n[o+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new w(g.INVALID_ARGUMENT,"Path has invalid escape sequence: "+n);i+=c,o+=2}else a==="`"?(u=!u,o++):a!=="."||u?(i+=a,o++):(s(),o++)}if(s(),u)throw new w(g.INVALID_ARGUMENT,"Unterminated ` in path: "+n);return new t(r)},t.emptyPath=function(){return new t([])},t}(Lc),tn=function(){function e(t){this.fields=t,t.sort(Vt.comparator)}return e.prototype.covers=function(t){for(var n=0,r=this.fields;n<r.length;n++)if(r[n].isPrefixOf(t))return!0;return!1},e.prototype.isEqual=function(t){return Ze(this.fields,t.fields,function(n,r){return n.isEqual(r)})},e}(),_t=function(){function e(t){this.binaryString=t}return e.fromBase64String=function(t){return new e(atob(t))},e.fromUint8Array=function(t){return new e(function(n){for(var r="",i=0;i<n.length;++i)r+=String.fromCharCode(n[i]);return r}(t))},e.prototype.toBase64=function(){return t=this.binaryString,btoa(t);var t},e.prototype.toUint8Array=function(){return function(t){for(var n=new Uint8Array(t.length),r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}(this.binaryString)},e.prototype.approximateByteSize=function(){return 2*this.binaryString.length},e.prototype.compareTo=function(t){return L(this.binaryString,t.binaryString)},e.prototype.isEqual=function(t){return this.binaryString===t.binaryString},e}();_t.EMPTY_BYTE_STRING=new _t("");var $p=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ce(e){if(k(!!e),typeof e=="string"){var t=0,n=$p.exec(e);if(k(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:W(e.seconds),nanos:W(e.nanos)}}function W(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function en(e){return typeof e=="string"?_t.fromBase64String(e):_t.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function us(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Fc(e){var t=e.mapValue.fields.__previous_value__;return us(t)?Fc(t):t}function jn(e){var t=ce(e.mapValue.fields.__local_write_time__.timestampValue);return new Tt(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fe(e){return e==null}function $r(e){return e===0&&1/e==-1/0}function Mc(e){return typeof e=="number"&&Number.isInteger(e)&&!$r(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var C=function(){function e(t){this.path=t}return e.fromPath=function(t){return new e(U.fromString(t))},e.fromName=function(t){return new e(U.fromString(t).popFirst(5))},e.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},e.prototype.isEqual=function(t){return t!==null&&U.comparator(this.path,t.path)===0},e.prototype.toString=function(){return this.path.toString()},e.comparator=function(t,n){return U.comparator(t.path,n.path)},e.isDocumentKey=function(t){return t.length%2==0},e.fromSegments=function(t){return new e(new U(t.slice()))},e}();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xe(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?us(e)?4:10:D()}function jt(e,t){var n=xe(e);if(n!==xe(t))return!1;switch(n){case 0:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return jn(e).isEqual(jn(t));case 3:return function(r,i){if(typeof r.timestampValue=="string"&&typeof i.timestampValue=="string"&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;var o=ce(r.timestampValue),s=ce(i.timestampValue);return o.seconds===s.seconds&&o.nanos===s.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(r,i){return en(r.bytesValue).isEqual(en(i.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(r,i){return W(r.geoPointValue.latitude)===W(i.geoPointValue.latitude)&&W(r.geoPointValue.longitude)===W(i.geoPointValue.longitude)}(e,t);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return W(r.integerValue)===W(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){var o=W(r.doubleValue),s=W(i.doubleValue);return o===s?$r(o)===$r(s):isNaN(o)&&isNaN(s)}return!1}(e,t);case 9:return Ze(e.arrayValue.values||[],t.arrayValue.values||[],jt);case 10:return function(r,i){var o=r.mapValue.fields||{},s=i.mapValue.fields||{};if(yu(o)!==yu(s))return!1;for(var u in o)if(o.hasOwnProperty(u)&&(s[u]===void 0||!jt(o[u],s[u])))return!1;return!0}(e,t);default:return D()}}function Kn(e,t){return(e.values||[]).find(function(n){return jt(n,t)})!==void 0}function nn(e,t){var n=xe(e),r=xe(t);if(n!==r)return L(n,r);switch(n){case 0:return 0;case 1:return L(e.booleanValue,t.booleanValue);case 2:return function(i,o){var s=W(i.integerValue||i.doubleValue),u=W(o.integerValue||o.doubleValue);return s<u?-1:s>u?1:s===u?0:isNaN(s)?isNaN(u)?0:-1:1}(e,t);case 3:return mu(e.timestampValue,t.timestampValue);case 4:return mu(jn(e),jn(t));case 5:return L(e.stringValue,t.stringValue);case 6:return function(i,o){var s=en(i),u=en(o);return s.compareTo(u)}(e.bytesValue,t.bytesValue);case 7:return function(i,o){for(var s=i.split("/"),u=o.split("/"),a=0;a<s.length&&a<u.length;a++){var c=L(s[a],u[a]);if(c!==0)return c}return L(s.length,u.length)}(e.referenceValue,t.referenceValue);case 8:return function(i,o){var s=L(W(i.latitude),W(o.latitude));return s!==0?s:L(W(i.longitude),W(o.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(i,o){for(var s=i.values||[],u=o.values||[],a=0;a<s.length&&a<u.length;++a){var c=nn(s[a],u[a]);if(c)return c}return L(s.length,u.length)}(e.arrayValue,t.arrayValue);case 10:return function(i,o){var s=i.fields||{},u=Object.keys(s),a=o.fields||{},c=Object.keys(a);u.sort(),c.sort();for(var h=0;h<u.length&&h<c.length;++h){var l=L(u[h],c[h]);if(l!==0)return l;var f=nn(s[u[h]],a[c[h]]);if(f!==0)return f}return L(u.length,c.length)}(e.mapValue,t.mapValue);default:throw D()}}function mu(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return L(e,t);var n=ce(e),r=ce(t),i=L(n.seconds,r.seconds);return i!==0?i:L(n.nanos,r.nanos)}function as(e){return wo(e)}function wo(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(r){var i=ce(r);return"time("+i.seconds+","+i.nanos+")"}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?en(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,C.fromName(n).toString()):"geoPointValue"in e?"geo("+(t=e.geoPointValue).latitude+","+t.longitude+")":"arrayValue"in e?function(r){for(var i="[",o=!0,s=0,u=r.values||[];s<u.length;s++)o?o=!1:i+=",",i+=wo(u[s]);return i+"]"}(e.arrayValue):"mapValue"in e?function(r){for(var i="{",o=!0,s=0,u=Object.keys(r.fields||{}).sort();s<u.length;s++){var a=u[s];o?o=!1:i+=",",i+=a+":"+wo(r.fields[a])}return i+"}"}(e.mapValue):D();var t,n}function Hr(e,t){return{referenceValue:"projects/"+e.projectId+"/databases/"+e.database+"/documents/"+t.path.canonicalString()}}function bo(e){return!!e&&"integerValue"in e}function cs(e){return!!e&&"arrayValue"in e}function wu(e){return!!e&&"nullValue"in e}function bu(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Cr(e){return!!e&&"mapValue"in e}function kn(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){var t={mapValue:{fields:{}}};return Le(e.mapValue.fields,function(i,o){return t.mapValue.fields[i]=kn(o)}),t}if(e.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(e.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=kn(e.arrayValue.values[r]);return n}return Object.assign({},e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ct=function(){function e(t){this.value=t}return e.empty=function(){return new e({mapValue:{}})},e.prototype.field=function(t){if(t.isEmpty())return this.value;for(var n=this.value,r=0;r<t.length-1;++r)if(!Cr(n=(n.mapValue.fields||{})[t.get(r)]))return null;return(n=(n.mapValue.fields||{})[t.lastSegment()])||null},e.prototype.set=function(t,n){this.getFieldsMap(t.popLast())[t.lastSegment()]=kn(n)},e.prototype.setAll=function(t){var n=this,r=Vt.emptyPath(),i={},o=[];t.forEach(function(u,a){if(!r.isImmediateParentOf(a)){var c=n.getFieldsMap(r);n.applyChanges(c,i,o),i={},o=[],r=a.popLast()}u?i[a.lastSegment()]=kn(u):o.push(a.lastSegment())});var s=this.getFieldsMap(r);this.applyChanges(s,i,o)},e.prototype.delete=function(t){var n=this.field(t.popLast());Cr(n)&&n.mapValue.fields&&delete n.mapValue.fields[t.lastSegment()]},e.prototype.isEqual=function(t){return jt(this.value,t.value)},e.prototype.getFieldsMap=function(t){var n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(var r=0;r<t.length;++r){var i=n.mapValue.fields[t.get(r)];Cr(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[t.get(r)]=i),n=i}return n.mapValue.fields},e.prototype.applyChanges=function(t,n,r){Le(n,function(u,a){return t[u]=a});for(var i=0,o=r;i<o.length;i++){var s=o[i];delete t[s]}},e.prototype.clone=function(){return new e(kn(this.value))},e}();function Vc(e){var t=[];return Le(e.fields,function(n,r){var i=new Vt([n]);if(Cr(r)){var o=Vc(r.mapValue).fields;if(o.length===0)t.push(i);else for(var s=0,u=o;s<u.length;s++){var a=u[s];t.push(i.child(a))}}else t.push(i)}),new tn(t)}var dt=function(){function e(t,n,r,i,o){this.key=t,this.documentType=n,this.version=r,this.data=i,this.documentState=o}return e.newInvalidDocument=function(t){return new e(t,0,P.min(),Ct.empty(),0)},e.newFoundDocument=function(t,n,r){return new e(t,1,n,r,0)},e.newNoDocument=function(t,n){return new e(t,2,n,Ct.empty(),0)},e.newUnknownDocument=function(t,n){return new e(t,3,n,Ct.empty(),2)},e.prototype.convertToFoundDocument=function(t,n){return this.version=t,this.documentType=1,this.data=n,this.documentState=0,this},e.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=Ct.empty(),this.documentState=0,this},e.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=Ct.empty(),this.documentState=2,this},e.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},e.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(e.prototype,"hasLocalMutations",{get:function(){return this.documentState===1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasCommittedMutations",{get:function(){return this.documentState===2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isValidDocument=function(){return this.documentType!==0},e.prototype.isFoundDocument=function(){return this.documentType===1},e.prototype.isNoDocument=function(){return this.documentType===2},e.prototype.isUnknownDocument=function(){return this.documentType===3},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)},e.prototype.clone=function(){return new e(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.value)+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},e}(),Hp=function(e,t,n,r,i,o,s){t===void 0&&(t=null),n===void 0&&(n=[]),r===void 0&&(r=[]),i===void 0&&(i=null),o===void 0&&(o=null),s===void 0&&(s=null),this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.h=null};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eu(e,t,n,r,i,o,s){return t===void 0&&(t=null),n===void 0&&(n=[]),r===void 0&&(r=[]),i===void 0&&(i=null),o===void 0&&(o=null),s===void 0&&(s=null),new Hp(e,t,n,r,i,o,s)}function ar(e){var t=_(e);if(t.h===null){var n=t.path.canonicalString();t.collectionGroup!==null&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(function(r){return function(i){return i.field.canonicalString()+i.op.toString()+as(i.value)}(r)}).join(","),n+="|ob:",n+=t.orderBy.map(function(r){return function(i){return i.field.canonicalString()+i.dir}(r)}).join(","),Fe(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=Wr(t.startAt)),t.endAt&&(n+="|ub:",n+=Wr(t.endAt)),t.h=n}return t.h}function Ii(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(var n=0;n<e.orderBy.length;n++)if(!ed(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(var r=0;r<e.filters.length;r++)if(i=e.filters[r],o=t.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!jt(i.value,o.value))return!1;var i,o;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Tu(e.startAt,t.startAt)&&Tu(e.endAt,t.endAt)}function Qr(e){return C.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}var kt=function(e){function t(n,r,i){var o=this;return(o=e.call(this)||this).field=n,o.op=r,o.value=i,o}return x(t,e),t.create=function(n,r,i){return n.isKeyField()?r==="in"||r==="not-in"?this.l(n,r,i):new Qp(n,r,i):r==="array-contains"?new Xp(n,i):r==="in"?new Jp(n,i):r==="not-in"?new Zp(n,i):r==="array-contains-any"?new td(n,i):new t(n,r,i)},t.l=function(n,r,i){return r==="in"?new Wp(n,i):new Yp(n,i)},t.prototype.matches=function(n){var r=n.data.field(this.field);return this.op==="!="?r!==null&&this.m(nn(r,this.value)):r!==null&&xe(this.value)===xe(r)&&this.m(nn(r,this.value))},t.prototype.m=function(n){switch(this.op){case"<":return n<0;case"<=":return n<=0;case"==":return n===0;case"!=":return n!==0;case">":return n>0;case">=":return n>=0;default:return D()}},t.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},t}(function(){}),Qp=function(e){function t(n,r,i){var o=this;return(o=e.call(this,n,r,i)||this).key=C.fromName(i.referenceValue),o}return x(t,e),t.prototype.matches=function(n){var r=C.comparator(n.key,this.key);return this.m(r)},t}(kt),Wp=function(e){function t(n,r){var i=this;return(i=e.call(this,n,"in",r)||this).keys=Uc("in",r),i}return x(t,e),t.prototype.matches=function(n){return this.keys.some(function(r){return r.isEqual(n.key)})},t}(kt),Yp=function(e){function t(n,r){var i=this;return(i=e.call(this,n,"not-in",r)||this).keys=Uc("not-in",r),i}return x(t,e),t.prototype.matches=function(n){return!this.keys.some(function(r){return r.isEqual(n.key)})},t}(kt);function Uc(e,t){var n;return(((n=t.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(function(r){return C.fromName(r.referenceValue)})}var Xp=function(e){function t(n,r){return e.call(this,n,"array-contains",r)||this}return x(t,e),t.prototype.matches=function(n){var r=n.data.field(this.field);return cs(r)&&Kn(r.arrayValue,this.value)},t}(kt),Jp=function(e){function t(n,r){return e.call(this,n,"in",r)||this}return x(t,e),t.prototype.matches=function(n){var r=n.data.field(this.field);return r!==null&&Kn(this.value.arrayValue,r)},t}(kt),Zp=function(e){function t(n,r){return e.call(this,n,"not-in",r)||this}return x(t,e),t.prototype.matches=function(n){if(Kn(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var r=n.data.field(this.field);return r!==null&&!Kn(this.value.arrayValue,r)},t}(kt),td=function(e){function t(n,r){return e.call(this,n,"array-contains-any",r)||this}return x(t,e),t.prototype.matches=function(n){var r=this,i=n.data.field(this.field);return!(!cs(i)||!i.arrayValue.values)&&i.arrayValue.values.some(function(o){return Kn(r.value.arrayValue,o)})},t}(kt),zn=function(e,t){this.position=e,this.before=t};function Wr(e){return(e.before?"b":"a")+":"+e.position.map(function(t){return as(t)}).join(",")}var Ye=function(e,t){t===void 0&&(t="asc"),this.field=e,this.dir=t};function ed(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function Iu(e,t,n){for(var r=0,i=0;i<e.position.length;i++){var o=t[i],s=e.position[i];if(r=o.field.isKeyField()?C.comparator(C.fromName(s.referenceValue),n.key):nn(s,n.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return e.before?r<=0:r<0}function Tu(e,t){if(e===null)return t===null;if(t===null||e.before!==t.before||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++)if(!jt(e.position[n],t.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Jt=function(e,t,n,r,i,o,s,u){t===void 0&&(t=null),n===void 0&&(n=[]),r===void 0&&(r=[]),i===void 0&&(i=null),o===void 0&&(o="F"),s===void 0&&(s=null),u===void 0&&(u=null),this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.p=null,this.T=null,this.startAt,this.endAt};function qc(e,t,n,r,i,o,s,u){return new Jt(e,t,n,r,i,o,s,u)}function cr(e){return new Jt(e)}function xr(e){return!Fe(e.limit)&&e.limitType==="F"}function Yr(e){return!Fe(e.limit)&&e.limitType==="L"}function hs(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function ls(e){for(var t=0,n=e.filters;t<n.length;t++){var r=n[t];if(r.g())return r.field}return null}function fs(e){return e.collectionGroup!==null}function rn(e){var t=_(e);if(t.p===null){t.p=[];var n=ls(t),r=hs(t);if(n!==null&&r===null)n.isKeyField()||t.p.push(new Ye(n)),t.p.push(new Ye(Vt.keyField(),"asc"));else{for(var i=!1,o=0,s=t.explicitOrderBy;o<s.length;o++){var u=s[o];t.p.push(u),u.field.isKeyField()&&(i=!0)}if(!i){var a=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.p.push(new Ye(Vt.keyField(),a))}}}return t.p}function Kt(e){var t=_(e);if(!t.T)if(t.limitType==="F")t.T=Eu(t.path,t.collectionGroup,rn(t),t.filters,t.limit,t.startAt,t.endAt);else{for(var n=[],r=0,i=rn(t);r<i.length;r++){var o=i[r],s=o.dir==="desc"?"asc":"desc";n.push(new Ye(o.field,s))}var u=t.endAt?new zn(t.endAt.position,!t.endAt.before):null,a=t.startAt?new zn(t.startAt.position,!t.startAt.before):null;t.T=Eu(t.path,t.collectionGroup,n,t.filters,t.limit,u,a)}return t.T}function Bc(e,t,n){return new Jt(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function hr(e,t){return Ii(Kt(e),Kt(t))&&e.limitType===t.limitType}function jc(e){return ar(Kt(e))+"|lt:"+e.limitType}function Eo(e){return"Query(target="+function(t){var n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=", filters: ["+t.filters.map(function(r){return(i=r).field.canonicalString()+" "+i.op+" "+as(i.value);var i}).join(", ")+"]"),Fe(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=", orderBy: ["+t.orderBy.map(function(r){return function(i){return i.field.canonicalString()+" ("+i.dir+")"}(r)}).join(", ")+"]"),t.startAt&&(n+=", startAt: "+Wr(t.startAt)),t.endAt&&(n+=", endAt: "+Wr(t.endAt)),"Target("+n+")"}(Kt(e))+"; limitType="+e.limitType+")"}function lr(e,t){return t.isFoundDocument()&&function(n,r){var i=r.key.path;return n.collectionGroup!==null?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):C.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)}(e,t)&&function(n,r){for(var i=0,o=n.explicitOrderBy;i<o.length;i++){var s=o[i];if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1}return!0}(e,t)&&function(n,r){for(var i=0,o=n.filters;i<o.length;i++)if(!o[i].matches(r))return!1;return!0}(e,t)&&function(n,r){return!(n.startAt&&!Iu(n.startAt,rn(n),r))&&(!n.endAt||!Iu(n.endAt,rn(n),r))}(e,t)}function Kc(e){return function(t,n){for(var r=!1,i=0,o=rn(e);i<o.length;i++){var s=o[i],u=nd(s,t,n);if(u!==0)return u;r=r||s.field.isKeyField()}return 0}}function nd(e,t,n){var r=e.field.isKeyField()?C.comparator(t.key,n.key):function(i,o,s){var u=o.data.field(i),a=s.data.field(i);return u!==null&&a!==null?nn(u,a):D()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return D()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zc(e,t){if(e.I){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:$r(t)?"-0":t}}function Gc(e){return{integerValue:""+e}}function $c(e,t){return Mc(t)?Gc(t):zc(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ti=function(){this._=void 0};function rd(e,t,n){return e instanceof on?function(r,i){var o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&(o.fields.__previous_value__=i),{mapValue:o}}(n,t):e instanceof ke?Qc(e,t):e instanceof Re?Wc(e,t):function(r,i){var o=Hc(r,i),s=_u(o)+_u(r.A);return bo(o)&&bo(r.A)?Gc(s):zc(r.R,s)}(e,t)}function id(e,t,n){return e instanceof ke?Qc(e,t):e instanceof Re?Wc(e,t):n}function Hc(e,t){return e instanceof sn?bo(n=t)||function(r){return!!r&&"doubleValue"in r}(n)?t:{integerValue:0}:null;var n}var on=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return x(t,e),t}(Ti),ke=function(e){function t(n){var r=this;return(r=e.call(this)||this).elements=n,r}return x(t,e),t}(Ti);function Qc(e,t){for(var n=Yc(t),r=function(s){n.some(function(u){return jt(u,s)})||n.push(s)},i=0,o=e.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Re=function(e){function t(n){var r=this;return(r=e.call(this)||this).elements=n,r}return x(t,e),t}(Ti);function Wc(e,t){for(var n=Yc(t),r=function(s){n=n.filter(function(u){return!jt(u,s)})},i=0,o=e.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var sn=function(e){function t(n,r){var i=this;return(i=e.call(this)||this).R=n,i.A=r,i}return x(t,e),t}(Ti);function _u(e){return W(e.integerValue||e.doubleValue)}function Yc(e){return cs(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fr=function(e,t){this.field=e,this.transform=t},od=function(e,t){this.version=e,this.transformResults=t},ft=function(){function e(t,n){this.updateTime=t,this.exists=n}return e.none=function(){return new e},e.exists=function(t){return new e(void 0,t)},e.updateTime=function(t){return new e(t)},Object.defineProperty(e.prototype,"isNone",{get:function(){return this.updateTime===void 0&&this.exists===void 0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},e}();function kr(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}var _i=function(){};function sd(e,t,n){e instanceof pr?function(r,i,o){var s=r.value.clone(),u=Nu(r.fieldTransforms,i,o.transformResults);s.setAll(u),i.convertToFoundDocument(o.version,s).setHasCommittedMutations()}(e,t,n):e instanceof de?function(r,i,o){if(kr(r.precondition,i)){var s=Nu(r.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(Xc(r)),u.setAll(s),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}else i.convertToUnknownDocument(o.version)}(e,t,n):function(r,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,t,n)}function Io(e,t,n){e instanceof pr?function(r,i,o){if(kr(r.precondition,i)){var s=r.value.clone(),u=Du(r.fieldTransforms,o,i);s.setAll(u),i.convertToFoundDocument(Au(i),s).setHasLocalMutations()}}(e,t,n):e instanceof de?function(r,i,o){if(kr(r.precondition,i)){var s=Du(r.fieldTransforms,o,i),u=i.data;u.setAll(Xc(r)),u.setAll(s),i.convertToFoundDocument(Au(i),u).setHasLocalMutations()}}(e,t,n):function(r,i){kr(r.precondition,i)&&i.convertToNoDocument(P.min())}(e,t)}function ud(e,t){for(var n=null,r=0,i=e.fieldTransforms;r<i.length;r++){var o=i[r],s=t.data.field(o.field),u=Hc(o.transform,s||null);u!=null&&(n==null&&(n=Ct.empty()),n.set(o.field,u))}return n||null}function Su(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(n,r){return n===void 0&&r===void 0||!(!n||!r)&&Ze(n,r,function(i,o){return function(s,u){return s.field.isEqual(u.field)&&function(a,c){return a instanceof ke&&c instanceof ke||a instanceof Re&&c instanceof Re?Ze(a.elements,c.elements,jt):a instanceof sn&&c instanceof sn?jt(a.A,c.A):a instanceof on&&c instanceof on}(s.transform,u.transform)}(i,o)})}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}function Au(e){return e.isFoundDocument()?e.version:P.min()}var pr=function(e){function t(n,r,i,o){o===void 0&&(o=[]);var s=this;return(s=e.call(this)||this).key=n,s.value=r,s.precondition=i,s.fieldTransforms=o,s.type=0,s}return x(t,e),t}(_i),de=function(e){function t(n,r,i,o,s){s===void 0&&(s=[]);var u=this;return(u=e.call(this)||this).key=n,u.data=r,u.fieldMask=i,u.precondition=o,u.fieldTransforms=s,u.type=1,u}return x(t,e),t}(_i);function Xc(e){var t=new Map;return e.fieldMask.fields.forEach(function(n){if(!n.isEmpty()){var r=e.data.field(n);t.set(n,r)}}),t}function Nu(e,t,n){var r=new Map;k(e.length===n.length);for(var i=0;i<n.length;i++){var o=e[i],s=o.transform,u=t.data.field(o.field);r.set(o.field,id(s,u,n[i]))}return r}function Du(e,t,n){for(var r=new Map,i=0,o=e;i<o.length;i++){var s=o[i],u=s.transform,a=n.data.field(s.field);r.set(s.field,rd(u,a,t))}return r}var Q,M,dr=function(e){function t(n,r){var i=this;return(i=e.call(this)||this).key=n,i.precondition=r,i.type=2,i.fieldTransforms=[],i}return x(t,e),t}(_i),ps=function(e){function t(n,r){var i=this;return(i=e.call(this)||this).key=n,i.precondition=r,i.type=3,i.fieldTransforms=[],i}return x(t,e),t}(_i),ad=function(e){this.count=e};function Jc(e){switch(e){case g.OK:return D();case g.CANCELLED:case g.UNKNOWN:case g.DEADLINE_EXCEEDED:case g.RESOURCE_EXHAUSTED:case g.INTERNAL:case g.UNAVAILABLE:case g.UNAUTHENTICATED:return!1;case g.INVALID_ARGUMENT:case g.NOT_FOUND:case g.ALREADY_EXISTS:case g.PERMISSION_DENIED:case g.FAILED_PRECONDITION:case g.ABORTED:case g.OUT_OF_RANGE:case g.UNIMPLEMENTED:case g.DATA_LOSS:return!0;default:return D()}}function Zc(e){if(e===void 0)return Y("GRPC error has no .code"),g.UNKNOWN;switch(e){case Q.OK:return g.OK;case Q.CANCELLED:return g.CANCELLED;case Q.UNKNOWN:return g.UNKNOWN;case Q.DEADLINE_EXCEEDED:return g.DEADLINE_EXCEEDED;case Q.RESOURCE_EXHAUSTED:return g.RESOURCE_EXHAUSTED;case Q.INTERNAL:return g.INTERNAL;case Q.UNAVAILABLE:return g.UNAVAILABLE;case Q.UNAUTHENTICATED:return g.UNAUTHENTICATED;case Q.INVALID_ARGUMENT:return g.INVALID_ARGUMENT;case Q.NOT_FOUND:return g.NOT_FOUND;case Q.ALREADY_EXISTS:return g.ALREADY_EXISTS;case Q.PERMISSION_DENIED:return g.PERMISSION_DENIED;case Q.FAILED_PRECONDITION:return g.FAILED_PRECONDITION;case Q.ABORTED:return g.ABORTED;case Q.OUT_OF_RANGE:return g.OUT_OF_RANGE;case Q.UNIMPLEMENTED:return g.UNIMPLEMENTED;case Q.DATA_LOSS:return g.DATA_LOSS;default:return D()}}(M=Q||(Q={}))[M.OK=0]="OK",M[M.CANCELLED=1]="CANCELLED",M[M.UNKNOWN=2]="UNKNOWN",M[M.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",M[M.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",M[M.NOT_FOUND=5]="NOT_FOUND",M[M.ALREADY_EXISTS=6]="ALREADY_EXISTS",M[M.PERMISSION_DENIED=7]="PERMISSION_DENIED",M[M.UNAUTHENTICATED=16]="UNAUTHENTICATED",M[M.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",M[M.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",M[M.ABORTED=10]="ABORTED",M[M.OUT_OF_RANGE=11]="OUT_OF_RANGE",M[M.UNIMPLEMENTED=12]="UNIMPLEMENTED",M[M.INTERNAL=13]="INTERNAL",M[M.UNAVAILABLE=14]="UNAVAILABLE",M[M.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gt=function(){function e(t,n){this.comparator=t,this.root=n||re.EMPTY}return e.prototype.insert=function(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,re.BLACK,null,null))},e.prototype.remove=function(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,re.BLACK,null,null))},e.prototype.get=function(t){for(var n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null},e.prototype.indexOf=function(t){for(var n=0,r=this.root;!r.isEmpty();){var i=this.comparator(t,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1},e.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(e.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),e.prototype.minKey=function(){return this.root.minKey()},e.prototype.maxKey=function(){return this.root.maxKey()},e.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},e.prototype.forEach=function(t){this.inorderTraversal(function(n,r){return t(n,r),!1})},e.prototype.toString=function(){var t=[];return this.inorderTraversal(function(n,r){return t.push(n+":"+r),!1}),"{"+t.join(", ")+"}"},e.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},e.prototype.getIterator=function(){return new Tr(this.root,null,this.comparator,!1)},e.prototype.getIteratorFrom=function(t){return new Tr(this.root,t,this.comparator,!1)},e.prototype.getReverseIterator=function(){return new Tr(this.root,null,this.comparator,!0)},e.prototype.getReverseIteratorFrom=function(t){return new Tr(this.root,t,this.comparator,!0)},e}(),Tr=function(){function e(t,n,r,i){this.isReverse=i,this.nodeStack=[];for(var o=1;!t.isEmpty();)if(o=n?r(t.key,n):1,i&&(o*=-1),o<0)t=this.isReverse?t.left:t.right;else{if(o===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return e.prototype.getNext=function(){var t=this.nodeStack.pop(),n={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return n},e.prototype.hasNext=function(){return this.nodeStack.length>0},e.prototype.peek=function(){if(this.nodeStack.length===0)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},e}(),re=function(){function e(t,n,r,i,o){this.key=t,this.value=n,this.color=r!=null?r:e.RED,this.left=i!=null?i:e.EMPTY,this.right=o!=null?o:e.EMPTY,this.size=this.left.size+1+this.right.size}return e.prototype.copy=function(t,n,r,i,o){return new e(t!=null?t:this.key,n!=null?n:this.value,r!=null?r:this.color,i!=null?i:this.left,o!=null?o:this.right)},e.prototype.isEmpty=function(){return!1},e.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},e.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},e.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},e.prototype.minKey=function(){return this.min().key},e.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},e.prototype.insert=function(t,n,r){var i=this,o=r(t,i.key);return(i=o<0?i.copy(null,null,null,i.left.insert(t,n,r),null):o===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(t,n,r))).fixUp()},e.prototype.removeMin=function(){if(this.left.isEmpty())return e.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),(t=t.copy(null,null,null,t.left.removeMin(),null)).fixUp()},e.prototype.remove=function(t,n){var r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(t,i.key)===0){if(i.right.isEmpty())return e.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()},e.prototype.isRed=function(){return this.color},e.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},e.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},e.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},e.prototype.rotateLeft=function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},e.prototype.rotateRight=function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},e.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,n)},e.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},e.prototype.check=function(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw D();var t=this.left.check();if(t!==this.right.check())throw D();return t+(this.isRed()?0:1)},e}();re.EMPTY=null,re.RED=!0,re.BLACK=!1,re.EMPTY=new(function(){function e(){this.size=0}return Object.defineProperty(e.prototype,"key",{get:function(){throw D()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){throw D()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){throw D()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){throw D()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){throw D()},enumerable:!1,configurable:!0}),e.prototype.copy=function(t,n,r,i,o){return this},e.prototype.insert=function(t,n,r){return new re(t,n)},e.prototype.remove=function(t,n){return this},e.prototype.isEmpty=function(){return!0},e.prototype.inorderTraversal=function(t){return!1},e.prototype.reverseTraversal=function(t){return!1},e.prototype.minKey=function(){return null},e.prototype.maxKey=function(){return null},e.prototype.isRed=function(){return!1},e.prototype.checkMaxDepth=function(){return!0},e.prototype.check=function(){return 0},e}());/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var tt=function(){function e(t){this.comparator=t,this.data=new gt(this.comparator)}return e.prototype.has=function(t){return this.data.get(t)!==null},e.prototype.first=function(){return this.data.minKey()},e.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(e.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),e.prototype.indexOf=function(t){return this.data.indexOf(t)},e.prototype.forEach=function(t){this.data.inorderTraversal(function(n,r){return t(n),!1})},e.prototype.forEachInRange=function(t,n){for(var r=this.data.getIteratorFrom(t[0]);r.hasNext();){var i=r.getNext();if(this.comparator(i.key,t[1])>=0)return;n(i.key)}},e.prototype.forEachWhile=function(t,n){var r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!t(r.getNext().key))return},e.prototype.firstAfterOrEqual=function(t){var n=this.data.getIteratorFrom(t);return n.hasNext()?n.getNext().key:null},e.prototype.getIterator=function(){return new Cu(this.data.getIterator())},e.prototype.getIteratorFrom=function(t){return new Cu(this.data.getIteratorFrom(t))},e.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},e.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},e.prototype.isEmpty=function(){return this.data.isEmpty()},e.prototype.unionWith=function(t){var n=this;return n.size<t.size&&(n=t,t=this),t.forEach(function(r){n=n.add(r)}),n},e.prototype.isEqual=function(t){if(!(t instanceof e)||this.size!==t.size)return!1;for(var n=this.data.getIterator(),r=t.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0},e.prototype.toArray=function(){var t=[];return this.forEach(function(n){t.push(n)}),t},e.prototype.toString=function(){var t=[];return this.forEach(function(n){return t.push(n)}),"SortedSet("+t.toString()+")"},e.prototype.copy=function(t){var n=new e(this.comparator);return n.data=t,n},e}(),Cu=function(){function e(t){this.iter=t}return e.prototype.getNext=function(){return this.iter.getNext().key},e.prototype.hasNext=function(){return this.iter.hasNext()},e}(),cd=new gt(C.comparator);function Ft(){return cd}var hd=new gt(C.comparator);function To(){return hd}var ld=new gt(C.comparator);function fd(){return ld}var pd=new tt(C.comparator);function j(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=pd,r=0,i=e;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var dd=new tt(L);function Si(){return dd}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ds=function(){function e(t,n,r,i,o){this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}return e.createSynthesizedRemoteEventForCurrentChange=function(t,n){var r=new Map;return r.set(t,gs.createSynthesizedTargetChangeForCurrentChange(t,n)),new e(P.min(),r,Si(),Ft(),j())},e}(),gs=function(){function e(t,n,r,i,o){this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}return e.createSynthesizedTargetChangeForCurrentChange=function(t,n){return new e(_t.EMPTY_BYTE_STRING,n,j(),j(),j())},e}(),Rr=function(e,t,n,r){this.v=e,this.removedTargetIds=t,this.key=n,this.P=r},th=function(e,t){this.targetId=e,this.V=t},eh=function(e,t,n,r){n===void 0&&(n=_t.EMPTY_BYTE_STRING),r===void 0&&(r=null),this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r},xu=function(){function e(){this.S=0,this.D=Ru(),this.C=_t.EMPTY_BYTE_STRING,this.N=!1,this.k=!0}return Object.defineProperty(e.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"F",{get:function(){return this.S!==0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$",{get:function(){return this.k},enumerable:!1,configurable:!0}),e.prototype.O=function(t){t.approximateByteSize()>0&&(this.k=!0,this.C=t)},e.prototype.M=function(){var t=j(),n=j(),r=j();return this.D.forEach(function(i,o){switch(o){case 0:t=t.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:D()}}),new gs(this.C,this.N,t,n,r)},e.prototype.L=function(){this.k=!1,this.D=Ru()},e.prototype.B=function(t,n){this.k=!0,this.D=this.D.insert(t,n)},e.prototype.q=function(t){this.k=!0,this.D=this.D.remove(t)},e.prototype.U=function(){this.S+=1},e.prototype.K=function(){this.S-=1},e.prototype.j=function(){this.k=!0,this.N=!0},e}(),gd=function(){function e(t){this.W=t,this.G=new Map,this.H=Ft(),this.J=ku(),this.Y=new tt(L)}return e.prototype.X=function(t){for(var n=0,r=t.v;n<r.length;n++){var i=r[n];t.P&&t.P.isFoundDocument()?this.Z(i,t.P):this.tt(i,t.key,t.P)}for(var o=0,s=t.removedTargetIds;o<s.length;o++)i=s[o],this.tt(i,t.key,t.P)},e.prototype.et=function(t){var n=this;this.forEachTarget(t,function(r){var i=n.nt(r);switch(t.state){case 0:n.st(r)&&i.O(t.resumeToken);break;case 1:i.K(),i.F||i.L(),i.O(t.resumeToken);break;case 2:i.K(),i.F||n.removeTarget(r);break;case 3:n.st(r)&&(i.j(),i.O(t.resumeToken));break;case 4:n.st(r)&&(n.it(r),i.O(t.resumeToken));break;default:D()}})},e.prototype.forEachTarget=function(t,n){var r=this;t.targetIds.length>0?t.targetIds.forEach(n):this.G.forEach(function(i,o){r.st(o)&&n(o)})},e.prototype.rt=function(t){var n=t.targetId,r=t.V.count,i=this.ot(n);if(i){var o=i.target;if(Qr(o))if(r===0){var s=new C(o.path);this.tt(n,s,dt.newNoDocument(s,P.min()))}else k(r===1);else this.ct(n)!==r&&(this.it(n),this.Y=this.Y.add(n))}},e.prototype.ut=function(t){var n=this,r=new Map;this.G.forEach(function(s,u){var a=n.ot(u);if(a){if(s.current&&Qr(a.target)){var c=new C(a.target.path);n.H.get(c)!==null||n.at(u,c)||n.tt(u,c,dt.newNoDocument(c,t))}s.$&&(r.set(u,s.M()),s.L())}});var i=j();this.J.forEach(function(s,u){var a=!0;u.forEachWhile(function(c){var h=n.ot(c);return!h||h.purpose===2||(a=!1,!1)}),a&&(i=i.add(s))});var o=new ds(t,r,this.Y,this.H,i);return this.H=Ft(),this.J=ku(),this.Y=new tt(L),o},e.prototype.Z=function(t,n){if(this.st(t)){var r=this.at(t,n.key)?2:0;this.nt(t).B(n.key,r),this.H=this.H.insert(n.key,n),this.J=this.J.insert(n.key,this.ht(n.key).add(t))}},e.prototype.tt=function(t,n,r){if(this.st(t)){var i=this.nt(t);this.at(t,n)?i.B(n,1):i.q(n),this.J=this.J.insert(n,this.ht(n).delete(t)),r&&(this.H=this.H.insert(n,r))}},e.prototype.removeTarget=function(t){this.G.delete(t)},e.prototype.ct=function(t){var n=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+n.addedDocuments.size-n.removedDocuments.size},e.prototype.U=function(t){this.nt(t).U()},e.prototype.nt=function(t){var n=this.G.get(t);return n||(n=new xu,this.G.set(t,n)),n},e.prototype.ht=function(t){var n=this.J.get(t);return n||(n=new tt(L),this.J=this.J.insert(t,n)),n},e.prototype.st=function(t){var n=this.ot(t)!==null;return n||T("WatchChangeAggregator","Detected inactive target",t),n},e.prototype.ot=function(t){var n=this.G.get(t);return n&&n.F?null:this.W.lt(t)},e.prototype.it=function(t){var n=this;this.G.set(t,new xu),this.W.getRemoteKeysForTarget(t).forEach(function(r){n.tt(t,r,null)})},e.prototype.at=function(t,n){return this.W.getRemoteKeysForTarget(t).has(n)},e}();function ku(){return new gt(C.comparator)}function Ru(){return new gt(C.comparator)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vd={asc:"ASCENDING",desc:"DESCENDING"},yd={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},md=function(e,t){this.databaseId=e,this.I=t};function Gn(e,t){return e.I?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}}function nh(e,t){return e.I?t.toBase64():t.toUint8Array()}function wd(e,t){return Gn(e,t.toTimestamp())}function Et(e){return k(!!e),P.fromTimestamp(function(t){var n=ce(t);return new Tt(n.seconds,n.nanos)}(e))}function vs(e,t){return function(n){return new U(["projects",n.projectId,"databases",n.database])}(e).child("documents").child(t).canonicalString()}function rh(e){var t=U.fromString(e);return k(hh(t)),t}function $n(e,t){return vs(e.databaseId,t.path)}function Ht(e,t){var n=rh(t);if(n.get(1)!==e.databaseId.projectId)throw new w(g.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new w(g.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new C(oh(n))}function _o(e,t){return vs(e.databaseId,t)}function ih(e){var t=rh(e);return t.length===4?U.emptyPath():oh(t)}function Hn(e){return new U(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function oh(e){return k(e.length>4&&e.get(4)==="documents"),e.popFirst(5)}function Ou(e,t,n){return{name:$n(e,t),fields:n.value.mapValue.fields}}function bd(e,t,n){var r=Ht(e,t.name),i=Et(t.updateTime),o=new Ct({mapValue:{fields:t.fields}}),s=dt.newFoundDocument(r,i,o);return n&&s.setHasCommittedMutations(),n?s.setHasCommittedMutations():s}function Xr(e,t){var n;if(t instanceof pr)n={update:Ou(e,t.key,t.value)};else if(t instanceof dr)n={delete:$n(e,t.key)};else if(t instanceof de)n={update:Ou(e,t.key,t.data),updateMask:Sd(t.fieldMask)};else{if(!(t instanceof ps))return D();n={verify:$n(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(function(r){return function(i,o){var s=o.transform;if(s instanceof on)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(s instanceof ke)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:s.elements}};if(s instanceof Re)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:s.elements}};if(s instanceof sn)return{fieldPath:o.field.canonicalString(),increment:s.A};throw D()}(0,r)})),t.precondition.isNone||(n.currentDocument=function(r,i){return i.updateTime!==void 0?{updateTime:wd(r,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:D()}(e,t.precondition)),n}function Pu(e,t){var n=t.currentDocument?function(c){return c.updateTime!==void 0?ft.updateTime(Et(c.updateTime)):c.exists!==void 0?ft.exists(c.exists):ft.none()}(t.currentDocument):ft.none(),r=t.updateTransforms?t.updateTransforms.map(function(c){return function(h,l){var f=null;if("setToServerValue"in l)k(l.setToServerValue==="REQUEST_TIME"),f=new on;else if("appendMissingElements"in l){var p=l.appendMissingElements.values||[];f=new ke(p)}else if("removeAllFromArray"in l){var d=l.removeAllFromArray.values||[];f=new Re(d)}else"increment"in l?f=new sn(h,l.increment):D();var v=Vt.fromServerFormat(l.fieldPath);return new fr(v,f)}(e,c)}):[];if(t.update){t.update.name;var i=Ht(e,t.update.name),o=new Ct({mapValue:{fields:t.update.fields}});if(t.updateMask){var s=function(c){var h=c.fieldPaths||[];return new tn(h.map(function(l){return Vt.fromServerFormat(l)}))}(t.updateMask);return new de(i,o,s,n,r)}return new pr(i,o,n,r)}if(t.delete){var u=Ht(e,t.delete);return new dr(u,n)}if(t.verify){var a=Ht(e,t.verify);return new ps(a,n)}return D()}function sh(e,t){return{documents:[_o(e,t.path)]}}function uh(e,t){var n={structuredQuery:{}},r=t.path;t.collectionGroup!==null?(n.parent=_o(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=_o(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(u){if(u.length!==0){var a=u.map(function(c){return function(h){if(h.op==="=="){if(bu(h.value))return{unaryFilter:{field:je(h.field),op:"IS_NAN"}};if(wu(h.value))return{unaryFilter:{field:je(h.field),op:"IS_NULL"}}}else if(h.op==="!="){if(bu(h.value))return{unaryFilter:{field:je(h.field),op:"IS_NOT_NAN"}};if(wu(h.value))return{unaryFilter:{field:je(h.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:je(h.field),op:Id(h.op),value:h.value}}}(c)});return a.length===1?a[0]:{compositeFilter:{op:"AND",filters:a}}}}(t.filters);i&&(n.structuredQuery.where=i);var o=function(u){if(u.length!==0)return u.map(function(a){return function(c){return{field:je(c.field),direction:Ed(c.dir)}}(a)})}(t.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(u,a){return u.I||Fe(a)?a:{value:a}}(e,t.limit);return s!==null&&(n.structuredQuery.limit=s),t.startAt&&(n.structuredQuery.startAt=Lu(t.startAt)),t.endAt&&(n.structuredQuery.endAt=Lu(t.endAt)),n}function ah(e){var t=ih(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){k(r===1);var o=n.from[0];o.allDescendants?i=o.collectionId:t=t.child(o.collectionId)}var s=[];n.where&&(s=ch(n.where));var u=[];n.orderBy&&(u=n.orderBy.map(function(l){return function(f){return new Ye(Qe(f.field),function(p){switch(p){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(f.direction))}(l)}));var a=null;n.limit&&(a=function(l){var f;return Fe(f=typeof l=="object"?l.value:l)?null:f}(n.limit));var c=null;n.startAt&&(c=Fu(n.startAt));var h=null;return n.endAt&&(h=Fu(n.endAt)),qc(t,i,u,s,a,"F",c,h)}function ch(e){return e?e.unaryFilter!==void 0?[_d(e)]:e.fieldFilter!==void 0?[Td(e)]:e.compositeFilter!==void 0?e.compositeFilter.filters.map(function(t){return ch(t)}).reduce(function(t,n){return t.concat(n)}):D():[]}function Lu(e){return{before:e.before,values:e.position}}function Fu(e){var t=!!e.before,n=e.values||[];return new zn(n,t)}function Ed(e){return vd[e]}function Id(e){return yd[e]}function je(e){return{fieldPath:e.canonicalString()}}function Qe(e){return Vt.fromServerFormat(e.fieldPath)}function Td(e){return kt.create(Qe(e.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return D()}}(e.fieldFilter.op),e.fieldFilter.value)}function _d(e){switch(e.unaryFilter.op){case"IS_NAN":var t=Qe(e.unaryFilter.field);return kt.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=Qe(e.unaryFilter.field);return kt.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Qe(e.unaryFilter.field);return kt.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Qe(e.unaryFilter.field);return kt.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return D()}}function Sd(e){var t=[];return e.fields.forEach(function(n){return t.push(n.canonicalString())}),{fieldPaths:t}}function hh(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mt(e){for(var t="",n=0;n<e.length;n++)t.length>0&&(t=Mu(t)),t=Ad(e.get(n),t);return Mu(t)}function Ad(e,t){for(var n=t,r=e.length,i=0;i<r;i++){var o=e.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function Mu(e){return e+""}function $t(e){var t=e.length;if(k(t>=2),t===2)return k(e.charAt(0)===""&&e.charAt(1)===""),U.emptyPath();for(var n=t-2,r=[],i="",o=0;o<t;){var s=e.indexOf("",o);switch((s<0||s>n)&&D(),e.charAt(s+1)){case"":var u=e.substring(o,s),a=void 0;i.length===0?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=e.substring(o,s),i+="\0";break;case"":i+=e.substring(o,s+1);break;default:D()}o=s+2}return new U(r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Nd=function(e,t){this.seconds=e,this.nanoseconds=t},Nt=function(e,t,n){this.ownerId=e,this.allowTabSynchronization=t,this.leaseTimestampMs=n};Nt.store="owner",Nt.key="owner";var ue=function(e,t,n){this.userId=e,this.lastAcknowledgedBatchId=t,this.lastStreamToken=n};ue.store="mutationQueues",ue.keyPath="userId";var K=function(e,t,n,r,i){this.userId=e,this.batchId=t,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};K.store="mutations",K.keyPath="batchId",K.userMutationsIndex="userMutationsIndex",K.userMutationsKeyPath=["userId","batchId"];var ht=function(){function e(){}return e.prefixForUser=function(t){return[t]},e.prefixForPath=function(t,n){return[t,Mt(n)]},e.key=function(t,n,r){return[t,Mt(n),r]},e}();ht.store="documentMutations",ht.PLACEHOLDER=new ht;var Dd=function(e,t){this.path=e,this.readTime=t},Cd=function(e,t){this.path=e,this.version=t},$=function(e,t,n,r,i,o){this.unknownDocument=e,this.noDocument=t,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};$.store="remoteDocuments",$.readTimeIndex="readTimeIndex",$.readTimeIndexPath="readTime",$.collectionReadTimeIndex="collectionReadTimeIndex",$.collectionReadTimeIndexPath=["parentPath","readTime"];var qt=function(e){this.byteSize=e};qt.store="remoteDocumentGlobal",qt.key="remoteDocumentGlobalKey";var It=function(e,t,n,r,i,o,s){this.targetId=e,this.canonicalId=t,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};It.store="targets",It.keyPath="targetId",It.queryTargetsIndexName="queryTargetsIndex",It.queryTargetsKeyPath=["canonicalId","targetId"];var ot=function(e,t,n){this.targetId=e,this.path=t,this.sequenceNumber=n};ot.store="targetDocuments",ot.keyPath=["targetId","path"],ot.documentTargetsIndex="documentTargetsIndex",ot.documentTargetsKeyPath=["path","targetId"];var Dt=function(e,t,n,r){this.highestTargetId=e,this.highestListenSequenceNumber=t,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Dt.key="targetGlobalKey",Dt.store="targetGlobal";var _e=function(e,t){this.collectionId=e,this.parent=t};_e.store="collectionParents",_e.keyPath=["collectionId","parent"];var Qt=function(e,t,n,r){this.clientId=e,this.updateTimeMs=t,this.networkEnabled=n,this.inForeground=r};Qt.store="clientMetadata",Qt.keyPath="clientId";var un=function(e,t,n){this.bundleId=e,this.createTime=t,this.version=n};un.store="bundles",un.keyPath="bundleId";var an=function(e,t,n){this.name=e,this.readTime=t,this.bundledQuery=n};an.store="namedQueries",an.keyPath="name";var xd=H(H([],H(H([],H(H([],H(H([],[ue.store,K.store,ht.store,$.store,It.store,Nt.store,Dt.store,ot.store]),[Qt.store])),[qt.store])),[_e.store])),[un.store,an.store]),lh="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",fh=function(){function e(){this.onCommittedListeners=[]}return e.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},e.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach(function(t){return t()})},e}(),St=function(){var e=this;this.promise=new Promise(function(t,n){e.resolve=t,e.reject=n})},E=function(){function e(t){var n=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(r){n.isDone=!0,n.result=r,n.nextCallback&&n.nextCallback(r)},function(r){n.isDone=!0,n.error=r,n.catchCallback&&n.catchCallback(r)})}return e.prototype.catch=function(t){return this.next(void 0,t)},e.prototype.next=function(t,n){var r=this;return this.callbackAttached&&D(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e(function(i,o){r.nextCallback=function(s){r.wrapSuccess(t,s).next(i,o)},r.catchCallback=function(s){r.wrapFailure(n,s).next(i,o)}})},e.prototype.toPromise=function(){var t=this;return new Promise(function(n,r){t.next(n,r)})},e.prototype.wrapUserFunction=function(t){try{var n=t();return n instanceof e?n:e.resolve(n)}catch(r){return e.reject(r)}},e.prototype.wrapSuccess=function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.resolve(n)},e.prototype.wrapFailure=function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.reject(n)},e.resolve=function(t){return new e(function(n,r){n(t)})},e.reject=function(t){return new e(function(n,r){r(t)})},e.waitFor=function(t){return new e(function(n,r){var i=0,o=0,s=!1;t.forEach(function(u){++i,u.next(function(){++o,s&&o===i&&n()},function(a){return r(a)})}),s=!0,o===i&&n()})},e.or=function(t){for(var n=e.resolve(!1),r=function(s){n=n.next(function(u){return u?e.resolve(u):s()})},i=0,o=t;i<o.length;i++)r(o[i]);return n},e.forEach=function(t,n){var r=this,i=[];return t.forEach(function(o,s){i.push(n.call(r,o,s))}),this.waitFor(i)},e}(),ph=function(){function e(t,n){var r=this;this.action=t,this.transaction=n,this.aborted=!1,this.ft=new St,this.transaction.oncomplete=function(){r.ft.resolve()},this.transaction.onabort=function(){n.error?r.ft.reject(new Rn(t,n.error)):r.ft.resolve()},this.transaction.onerror=function(i){var o=ys(i.target.error);r.ft.reject(new Rn(t,o))}}return e.open=function(t,n,r,i){try{return new e(n,t.transaction(i,r))}catch(o){throw new Rn(n,o)}},Object.defineProperty(e.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),e.prototype.abort=function(t){t&&this.ft.reject(t),this.aborted||(T("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},e.prototype.store=function(t){var n=this.transaction.objectStore(t);return new Rd(n)},e}(),cn=function(){function e(t,n,r){this.name=t,this.version=n,this.wt=r,e._t(Ne())===12.2&&Y("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return e.delete=function(t){return T("SimpleDb","Removing database:",t),we(window.indexedDB.deleteDatabase(t)).toPromise()},e.yt=function(){if(typeof indexedDB>"u")return!1;if(e.gt())return!0;var t=Ne(),n=e._t(t),r=0<n&&n<10,i=e.Et(t),o=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||r||o)},e.gt=function(){var t;return typeof process<"u"&&((t=process.env)===null||t===void 0?void 0:t.Tt)==="YES"},e.It=function(t,n){return t.store(n)},e._t=function(t){var n=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)},e.Et=function(t){var n=t.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)},e.prototype.At=function(t){return m(this,void 0,void 0,function(){var n,r=this;return y(this,function(i){switch(i.label){case 0:return this.db?[3,2]:(T("SimpleDb","Opening database:",this.name),n=this,[4,new Promise(function(o,s){var u=indexedDB.open(r.name,r.version);u.onsuccess=function(a){var c=a.target.result;o(c)},u.onblocked=function(){s(new Rn(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},u.onerror=function(a){var c=a.target.error;c.name==="VersionError"?s(new w(g.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):s(new Rn(t,c))},u.onupgradeneeded=function(a){T("SimpleDb",'Database "'+r.name+'" requires upgrade from version:',a.oldVersion);var c=a.target.result;r.wt.Rt(c,u.transaction,a.oldVersion,r.version).next(function(){T("SimpleDb","Database upgrade to version "+r.version+" complete")})}})]);case 1:n.db=i.sent(),i.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(o){return r.bt(o)}),this.db)]}})})},e.prototype.vt=function(t){this.bt=t,this.db&&(this.db.onversionchange=function(n){return t(n)})},e.prototype.runTransaction=function(t,n,r,i){return m(this,void 0,void 0,function(){var o,s,u,a,c;return y(this,function(h){switch(h.label){case 0:o=n==="readonly",s=0,u=function(){var l,f,p,d,v;return y(this,function(b){switch(b.label){case 0:++s,b.label=1;case 1:return b.trys.push([1,4,,5]),[4,a.At(t)];case 2:return a.db=b.sent(),l=ph.open(a.db,t,o?"readonly":"readwrite",r),f=i(l).catch(function(I){return l.abort(I),E.reject(I)}).toPromise(),p={},f.catch(function(){}),[4,l.dt];case 3:return[2,(p.value=(b.sent(),f),p)];case 4:return d=b.sent(),v=d.name!=="FirebaseError"&&s<3,T("SimpleDb","Transaction failed with error:",d.message,"Retrying:",v),a.close(),v?[3,5]:[2,{value:Promise.reject(d)}];case 5:return[2]}})},a=this,h.label=1;case 1:return[5,u()];case 2:if(typeof(c=h.sent())=="object")return[2,c.value];h.label=3;case 3:return[3,1];case 4:return[2]}})})},e.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},e}(),kd=function(){function e(t){this.Pt=t,this.Vt=!1,this.St=null}return Object.defineProperty(e.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cursor",{set:function(t){this.Pt=t},enumerable:!1,configurable:!0}),e.prototype.done=function(){this.Vt=!0},e.prototype.Ct=function(t){this.St=t},e.prototype.delete=function(){return we(this.Pt.delete())},e}(),Rn=function(e){function t(n,r){var i=this;return(i=e.call(this,g.UNAVAILABLE,"IndexedDB transaction '"+n+"' failed: "+r)||this).name="IndexedDbTransactionError",i}return x(t,e),t}(w);function Me(e){return e.name==="IndexedDbTransactionError"}var Rd=function(){function e(t){this.store=t}return e.prototype.put=function(t,n){var r;return n!==void 0?(T("SimpleDb","PUT",this.store.name,t,n),r=this.store.put(n,t)):(T("SimpleDb","PUT",this.store.name,"<auto-key>",t),r=this.store.put(t)),we(r)},e.prototype.add=function(t){return T("SimpleDb","ADD",this.store.name,t,t),we(this.store.add(t))},e.prototype.get=function(t){var n=this;return we(this.store.get(t)).next(function(r){return r===void 0&&(r=null),T("SimpleDb","GET",n.store.name,t,r),r})},e.prototype.delete=function(t){return T("SimpleDb","DELETE",this.store.name,t),we(this.store.delete(t))},e.prototype.count=function(){return T("SimpleDb","COUNT",this.store.name),we(this.store.count())},e.prototype.Nt=function(t,n){var r=this.cursor(this.options(t,n)),i=[];return this.xt(r,function(o,s){i.push(s)}).next(function(){return i})},e.prototype.kt=function(t,n){T("SimpleDb","DELETE ALL",this.store.name);var r=this.options(t,n);r.Ft=!1;var i=this.cursor(r);return this.xt(i,function(o,s,u){return u.delete()})},e.prototype.$t=function(t,n){var r;n?r=t:(r={},n=t);var i=this.cursor(r);return this.xt(i,n)},e.prototype.Ot=function(t){var n=this.cursor({});return new E(function(r,i){n.onerror=function(o){var s=ys(o.target.error);i(s)},n.onsuccess=function(o){var s=o.target.result;s?t(s.primaryKey,s.value).next(function(u){u?s.continue():r()}):r()}})},e.prototype.xt=function(t,n){var r=[];return new E(function(i,o){t.onerror=function(s){o(s.target.error)},t.onsuccess=function(s){var u=s.target.result;if(u){var a=new kd(u),c=n(u.primaryKey,u.value,a);if(c instanceof E){var h=c.catch(function(l){return a.done(),E.reject(l)});r.push(h)}a.isDone?i():a.Dt===null?u.continue():u.continue(a.Dt)}else i()}}).next(function(){return E.waitFor(r)})},e.prototype.options=function(t,n){var r;return t!==void 0&&(typeof t=="string"?r=t:n=t),{index:r,range:n}},e.prototype.cursor=function(t){var n="next";if(t.reverse&&(n="prev"),t.index){var r=this.store.index(t.index);return t.Ft?r.openKeyCursor(t.range,n):r.openCursor(t.range,n)}return this.store.openCursor(t.range,n)},e}();function we(e){return new E(function(t,n){e.onsuccess=function(r){var i=r.target.result;t(i)},e.onerror=function(r){var i=ys(r.target.error);n(i)}})}var Vu=!1;function ys(e){var t=cn._t(Ne());if(t>=12.2&&t<13){var n="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(n)>=0){var r=new w("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Vu||(Vu=!0,setTimeout(function(){throw r},0)),r}}return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Uu=function(e){function t(n,r){var i=this;return(i=e.call(this)||this).Mt=n,i.currentSequenceNumber=r,i}return x(t,e),t}(fh);function At(e,t){var n=_(e);return cn.It(n.Mt,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ms=function(){function e(t,n,r,i){this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}return e.prototype.applyToRemoteDocument=function(t,n){for(var r=n.mutationResults,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t.key)&&sd(o,t,r[i])}},e.prototype.applyToLocalView=function(t){for(var n=0,r=this.baseMutations;n<r.length;n++)(s=r[n]).key.isEqual(t.key)&&Io(s,t,this.localWriteTime);for(var i=0,o=this.mutations;i<o.length;i++){var s;(s=o[i]).key.isEqual(t.key)&&Io(s,t,this.localWriteTime)}},e.prototype.applyToLocalDocumentSet=function(t){var n=this;this.mutations.forEach(function(r){var i=t.get(r.key),o=i;n.applyToLocalView(o),i.isValidDocument()||o.convertToNoDocument(P.min())})},e.prototype.keys=function(){return this.mutations.reduce(function(t,n){return t.add(n.key)},j())},e.prototype.isEqual=function(t){return this.batchId===t.batchId&&Ze(this.mutations,t.mutations,function(n,r){return Su(n,r)})&&Ze(this.baseMutations,t.baseMutations,function(n,r){return Su(n,r)})},e}(),Od=function(){function e(t,n,r,i){this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}return e.from=function(t,n,r){k(t.mutations.length===r.length);for(var i=fd(),o=t.mutations,s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new e(t,n,r,i)},e}(),Ai=function(){function e(t,n,r,i,o,s,u){o===void 0&&(o=P.min()),s===void 0&&(s=P.min()),u===void 0&&(u=_t.EMPTY_BYTE_STRING),this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=u}return e.prototype.withSequenceNumber=function(t){return new e(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},e.prototype.withResumeToken=function(t,n){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t)},e.prototype.withLastLimboFreeSnapshotVersion=function(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)},e}(),dh=function(e){this.Lt=e};function So(e,t){if(t.document)return bd(e.Lt,t.document,!!t.hasCommittedMutations);if(t.noDocument){var n=C.fromSegments(t.noDocument.path),r=ln(t.noDocument.readTime),i=dt.newNoDocument(n,r);return t.hasCommittedMutations?i.setHasCommittedMutations():i}if(t.unknownDocument){var o=C.fromSegments(t.unknownDocument.path);return r=ln(t.unknownDocument.version),dt.newUnknownDocument(o,r)}return D()}function qu(e,t,n){var r=ws(n),i=t.key.path.popLast().toArray();if(t.isFoundDocument()){var o=function(l,f){return{name:$n(l,f.key),fields:f.data.value.mapValue.fields,updateTime:Gn(l,f.version.toTimestamp())}}(e.Lt,t),s=t.hasCommittedMutations;return new $(null,null,o,s,r,i)}if(t.isNoDocument()){var u=t.key.path.toArray(),a=hn(t.version);return s=t.hasCommittedMutations,new $(null,new Dd(u,a),null,s,r,i)}if(t.isUnknownDocument()){var c=t.key.path.toArray(),h=hn(t.version);return new $(new Cd(c,h),null,null,!0,r,i)}return D()}function ws(e){var t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function gh(e){var t=new Tt(e[0],e[1]);return P.fromTimestamp(t)}function hn(e){var t=e.toTimestamp();return new Nd(t.seconds,t.nanoseconds)}function ln(e){var t=new Tt(e.seconds,e.nanoseconds);return P.fromTimestamp(t)}function Ge(e,t){for(var n=(t.baseMutations||[]).map(function(a){return Pu(e.Lt,a)}),r=0;r<t.mutations.length-1;++r){var i=t.mutations[r];if(r+1<t.mutations.length&&t.mutations[r+1].transform!==void 0){var o=t.mutations[r+1];i.updateTransforms=o.transform.fieldTransforms,t.mutations.splice(r+1,1),++r}}var s=t.mutations.map(function(a){return Pu(e.Lt,a)}),u=Tt.fromMillis(t.localWriteTimeMs);return new ms(t.batchId,u,n,s)}function Dn(e){var t,n,r=ln(e.readTime),i=e.lastLimboFreeSnapshotVersion!==void 0?ln(e.lastLimboFreeSnapshotVersion):P.min();return e.query.documents!==void 0?(k((n=e.query).documents.length===1),t=Kt(cr(ih(n.documents[0])))):t=function(o){return Kt(ah(o))}(e.query),new Ai(t,e.targetId,0,e.lastListenSequenceNumber,r,i,_t.fromBase64String(e.resumeToken))}function vh(e,t){var n,r=hn(t.snapshotVersion),i=hn(t.lastLimboFreeSnapshotVersion);n=Qr(t.target)?sh(e.Lt,t.target):uh(e.Lt,t.target);var o=t.resumeToken.toBase64();return new It(t.targetId,ar(t.target),r,o,t.sequenceNumber,i,n)}function yh(e){var t=ah({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?Bc(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Pd=function(){function e(){}return e.prototype.getBundleMetadata=function(t,n){return Bu(t).get(n).next(function(r){if(r)return{id:(i=r).bundleId,createTime:ln(i.createTime),version:i.version};var i})},e.prototype.saveBundleMetadata=function(t,n){return Bu(t).put({bundleId:(r=n).id,createTime:hn(Et(r.createTime)),version:r.version});var r},e.prototype.getNamedQuery=function(t,n){return ju(t).get(n).next(function(r){if(r)return{name:(i=r).name,query:yh(i.bundledQuery),readTime:ln(i.readTime)};var i})},e.prototype.saveNamedQuery=function(t,n){return ju(t).put(function(r){return{name:r.name,readTime:hn(Et(r.readTime)),bundledQuery:r.bundledQuery}}(n))},e}();function Bu(e){return At(e,un.store)}function ju(e){return At(e,an.store)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ld=function(){function e(){this.Bt=new bs}return e.prototype.addToCollectionParentIndex=function(t,n){return this.Bt.add(n),E.resolve()},e.prototype.getCollectionParents=function(t,n){return E.resolve(this.Bt.getEntries(n))},e}(),bs=function(){function e(){this.index={}}return e.prototype.add=function(t){var n=t.lastSegment(),r=t.popLast(),i=this.index[n]||new tt(U.comparator),o=!i.has(r);return this.index[n]=i.add(r),o},e.prototype.has=function(t){var n=t.lastSegment(),r=t.popLast(),i=this.index[n];return i&&i.has(r)},e.prototype.getEntries=function(t){return(this.index[t]||new tt(U.comparator)).toArray()},e}(),Fd=function(){function e(){this.qt=new bs}return e.prototype.addToCollectionParentIndex=function(t,n){var r=this;if(!this.qt.has(n)){var i=n.lastSegment(),o=n.popLast();t.addOnCommittedListener(function(){r.qt.add(n)});var s={collectionId:i,parent:Mt(o)};return Ku(t).put(s)}return E.resolve()},e.prototype.getCollectionParents=function(t,n){var r=[],i=IDBKeyRange.bound([n,""],[Oc(n),""],!1,!0);return Ku(t).Nt(i).next(function(o){for(var s=0,u=o;s<u.length;s++){var a=u[s];if(a.collectionId!==n)break;r.push($t(a.parent))}return r})},e}();function Ku(e){return At(e,_e.store)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var zu={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Ut=function(){function e(t,n,r){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}return e.withCacheSize=function(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},e}();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mh(e,t,n){var r=e.store(K.store),i=e.store(ht.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.$t({range:s},function(d,v,b){return u++,b.delete()});o.push(a.next(function(){k(u===1)}));for(var c=[],h=0,l=n.mutations;h<l.length;h++){var f=l[h],p=ht.key(t,f.key.path,n.batchId);o.push(i.delete(p)),c.push(f.key)}return E.waitFor(o).next(function(){return c})}function Jr(e){if(!e)return 0;var t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw D();t=e.noDocument}return JSON.stringify(t).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ut.DEFAULT_COLLECTION_PERCENTILE=10,Ut.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ut.DEFAULT=new Ut(41943040,Ut.DEFAULT_COLLECTION_PERCENTILE,Ut.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ut.DISABLED=new Ut(-1,0,0);var Md=function(){function e(t,n,r,i){this.userId=t,this.R=n,this.Ut=r,this.referenceDelegate=i,this.Kt={}}return e.Qt=function(t,n,r,i){return k(t.uid!==""),new e(t.isAuthenticated()?t.uid:"",n,r,i)},e.prototype.checkEmpty=function(t){var n=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return te(t).$t({index:K.userMutationsIndex,range:r},function(i,o,s){n=!1,s.done()}).next(function(){return n})},e.prototype.addMutationBatch=function(t,n,r,i){var o=this,s=$e(t),u=te(t);return u.add({}).next(function(a){k(typeof a=="number");for(var c=new ms(a,n,r,i),h=function(I,N,A){var O=A.baseMutations.map(function(B){return Xr(I.Lt,B)}),F=A.mutations.map(function(B){return Xr(I.Lt,B)});return new K(N,A.batchId,A.localWriteTime.toMillis(),O,F)}(o.R,o.userId,c),l=[],f=new tt(function(I,N){return L(I.canonicalString(),N.canonicalString())}),p=0,d=i;p<d.length;p++){var v=d[p],b=ht.key(o.userId,v.key.path,a);f=f.add(v.key.path.popLast()),l.push(u.put(h)),l.push(s.put(b,ht.PLACEHOLDER))}return f.forEach(function(I){l.push(o.Ut.addToCollectionParentIndex(t,I))}),t.addOnCommittedListener(function(){o.Kt[a]=c.keys()}),E.waitFor(l).next(function(){return c})})},e.prototype.lookupMutationBatch=function(t,n){var r=this;return te(t).get(n).next(function(i){return i?(k(i.userId===r.userId),Ge(r.R,i)):null})},e.prototype.jt=function(t,n){var r=this;return this.Kt[n]?E.resolve(this.Kt[n]):this.lookupMutationBatch(t,n).next(function(i){if(i){var o=i.keys();return r.Kt[n]=o,o}return null})},e.prototype.getNextMutationBatchAfterBatchId=function(t,n){var r=this,i=n+1,o=IDBKeyRange.lowerBound([this.userId,i]),s=null;return te(t).$t({index:K.userMutationsIndex,range:o},function(u,a,c){a.userId===r.userId&&(k(a.batchId>=i),s=Ge(r.R,a)),c.done()}).next(function(){return s})},e.prototype.getHighestUnacknowledgedBatchId=function(t){var n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return te(t).$t({index:K.userMutationsIndex,range:n,reverse:!0},function(i,o,s){r=o.batchId,s.done()}).next(function(){return r})},e.prototype.getAllMutationBatches=function(t){var n=this,r=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return te(t).Nt(K.userMutationsIndex,r).next(function(i){return i.map(function(o){return Ge(n.R,o)})})},e.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,n){var r=this,i=ht.prefixForPath(this.userId,n.path),o=IDBKeyRange.lowerBound(i),s=[];return $e(t).$t({range:o},function(u,a,c){var h=u[0],l=u[1],f=u[2],p=$t(l);if(h===r.userId&&n.path.isEqual(p))return te(t).get(f).next(function(d){if(!d)throw D();k(d.userId===r.userId),s.push(Ge(r.R,d))});c.done()}).next(function(){return s})},e.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,n){var r=this,i=new tt(L),o=[];return n.forEach(function(s){var u=ht.prefixForPath(r.userId,s.path),a=IDBKeyRange.lowerBound(u),c=$e(t).$t({range:a},function(h,l,f){var p=h[0],d=h[1],v=h[2],b=$t(d);p===r.userId&&s.path.isEqual(b)?i=i.add(v):f.done()});o.push(c)}),E.waitFor(o).next(function(){return r.Wt(t,i)})},e.prototype.getAllMutationBatchesAffectingQuery=function(t,n){var r=this,i=n.path,o=i.length+1,s=ht.prefixForPath(this.userId,i),u=IDBKeyRange.lowerBound(s),a=new tt(L);return $e(t).$t({range:u},function(c,h,l){var f=c[0],p=c[1],d=c[2],v=$t(p);f===r.userId&&i.isPrefixOf(v)?v.length===o&&(a=a.add(d)):l.done()}).next(function(){return r.Wt(t,a)})},e.prototype.Wt=function(t,n){var r=this,i=[],o=[];return n.forEach(function(s){o.push(te(t).get(s).next(function(u){if(u===null)throw D();k(u.userId===r.userId),i.push(Ge(r.R,u))}))}),E.waitFor(o).next(function(){return i})},e.prototype.removeMutationBatch=function(t,n){var r=this;return mh(t.Mt,this.userId,n).next(function(i){return t.addOnCommittedListener(function(){r.Gt(n.batchId)}),E.forEach(i,function(o){return r.referenceDelegate.markPotentiallyOrphaned(t,o)})})},e.prototype.Gt=function(t){delete this.Kt[t]},e.prototype.performConsistencyCheck=function(t){var n=this;return this.checkEmpty(t).next(function(r){if(!r)return E.resolve();var i=IDBKeyRange.lowerBound(ht.prefixForUser(n.userId)),o=[];return $e(t).$t({range:i},function(s,u,a){if(s[0]===n.userId){var c=$t(s[1]);o.push(c)}else a.done()}).next(function(){k(o.length===0)})})},e.prototype.containsKey=function(t,n){return wh(t,this.userId,n)},e.prototype.zt=function(t){var n=this;return bh(t).get(this.userId).next(function(r){return r||new ue(n.userId,-1,"")})},e}();function wh(e,t,n){var r=ht.prefixForPath(t,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return $e(e).$t({range:o,Ft:!0},function(u,a,c){var h=u[0],l=u[1];u[2],h===t&&l===i&&(s=!0),c.done()}).next(function(){return s})}function te(e){return At(e,K.store)}function $e(e){return At(e,ht.store)}function bh(e){return At(e,ue.store)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Zr=function(){function e(t){this.Ht=t}return e.prototype.next=function(){return this.Ht+=2,this.Ht},e.Jt=function(){return new e(0)},e.Yt=function(){return new e(-1)},e}(),Vd=function(){function e(t,n){this.referenceDelegate=t,this.R=n}return e.prototype.allocateTargetId=function(t){var n=this;return this.Xt(t).next(function(r){var i=new Zr(r.highestTargetId);return r.highestTargetId=i.next(),n.Zt(t,r).next(function(){return r.highestTargetId})})},e.prototype.getLastRemoteSnapshotVersion=function(t){return this.Xt(t).next(function(n){return P.fromTimestamp(new Tt(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds))})},e.prototype.getHighestSequenceNumber=function(t){return this.Xt(t).next(function(n){return n.highestListenSequenceNumber})},e.prototype.setTargetsMetadata=function(t,n,r){var i=this;return this.Xt(t).next(function(o){return o.highestListenSequenceNumber=n,r&&(o.lastRemoteSnapshotVersion=r.toTimestamp()),n>o.highestListenSequenceNumber&&(o.highestListenSequenceNumber=n),i.Zt(t,o)})},e.prototype.addTargetData=function(t,n){var r=this;return this.te(t,n).next(function(){return r.Xt(t).next(function(i){return i.targetCount+=1,r.ee(n,i),r.Zt(t,i)})})},e.prototype.updateTargetData=function(t,n){return this.te(t,n)},e.prototype.removeTargetData=function(t,n){var r=this;return this.removeMatchingKeysForTargetId(t,n.targetId).next(function(){return Ke(t).delete(n.targetId)}).next(function(){return r.Xt(t)}).next(function(i){return k(i.targetCount>0),i.targetCount-=1,r.Zt(t,i)})},e.prototype.removeTargets=function(t,n,r){var i=this,o=0,s=[];return Ke(t).$t(function(u,a){var c=Dn(a);c.sequenceNumber<=n&&r.get(c.targetId)===null&&(o++,s.push(i.removeTargetData(t,c)))}).next(function(){return E.waitFor(s)}).next(function(){return o})},e.prototype.forEachTarget=function(t,n){return Ke(t).$t(function(r,i){var o=Dn(i);n(o)})},e.prototype.Xt=function(t){return Gu(t).get(Dt.key).next(function(n){return k(n!==null),n})},e.prototype.Zt=function(t,n){return Gu(t).put(Dt.key,n)},e.prototype.te=function(t,n){return Ke(t).put(vh(this.R,n))},e.prototype.ee=function(t,n){var r=!1;return t.targetId>n.highestTargetId&&(n.highestTargetId=t.targetId,r=!0),t.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=t.sequenceNumber,r=!0),r},e.prototype.getTargetCount=function(t){return this.Xt(t).next(function(n){return n.targetCount})},e.prototype.getTargetData=function(t,n){var r=ar(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return Ke(t).$t({range:i,index:It.queryTargetsIndexName},function(s,u,a){var c=Dn(u);Ii(n,c.target)&&(o=c,a.done())}).next(function(){return o})},e.prototype.addMatchingKeys=function(t,n,r){var i=this,o=[],s=ie(t);return n.forEach(function(u){var a=Mt(u.path);o.push(s.put(new ot(r,a))),o.push(i.referenceDelegate.addReference(t,r,u))}),E.waitFor(o)},e.prototype.removeMatchingKeys=function(t,n,r){var i=this,o=ie(t);return E.forEach(n,function(s){var u=Mt(s.path);return E.waitFor([o.delete([r,u]),i.referenceDelegate.removeReference(t,r,s)])})},e.prototype.removeMatchingKeysForTargetId=function(t,n){var r=ie(t),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)},e.prototype.getMatchingKeysForTargetId=function(t,n){var r=IDBKeyRange.bound([n],[n+1],!1,!0),i=ie(t),o=j();return i.$t({range:r,Ft:!0},function(s,u,a){var c=$t(s[1]),h=new C(c);o=o.add(h)}).next(function(){return o})},e.prototype.containsKey=function(t,n){var r=Mt(n.path),i=IDBKeyRange.bound([r],[Oc(r)],!1,!0),o=0;return ie(t).$t({index:ot.documentTargetsIndex,Ft:!0,range:i},function(s,u,a){var c=s[0];s[1],c!==0&&(o++,a.done())}).next(function(){return o>0})},e.prototype.lt=function(t,n){return Ke(t).get(n).next(function(r){return r?Dn(r):null})},e}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ke(e){return At(e,It.store)}function Gu(e){return At(e,Dt.store)}function ie(e){return At(e,ot.store)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ve(e){return m(this,void 0,void 0,function(){return y(this,function(t){if(e.code!==g.FAILED_PRECONDITION||e.message!==lh)throw e;return T("LocalStore","Unexpectedly lost primary lease"),[2]})})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $u(e,t){var n=e[0],r=e[1],i=t[0],o=t[1],s=L(n,i);return s===0?L(r,o):s}var Ud=function(){function e(t){this.ne=t,this.buffer=new tt($u),this.se=0}return e.prototype.ie=function(){return++this.se},e.prototype.re=function(t){var n=[t,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(n);else{var r=this.buffer.last();$u(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}},Object.defineProperty(e.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),e}(),qd=function(){function e(t,n){this.garbageCollector=t,this.asyncQueue=n,this.oe=!1,this.ce=null}return e.prototype.start=function(t){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.ue(t)},e.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(e.prototype,"started",{get:function(){return this.ce!==null},enumerable:!1,configurable:!0}),e.prototype.ue=function(t){var n=this,r=this.oe?3e5:6e4;T("LruGarbageCollector","Garbage collection scheduled in "+r+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",r,function(){return m(n,void 0,void 0,function(){var i;return y(this,function(o){switch(o.label){case 0:this.ce=null,this.oe=!0,o.label=1;case 1:return o.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return o.sent(),[3,7];case 3:return Me(i=o.sent())?(T("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",i),[3,6]):[3,4];case 4:return[4,Ve(i)];case 5:o.sent(),o.label=6;case 6:return[3,7];case 7:return[4,this.ue(t)];case 8:return o.sent(),[2]}})})})},e}(),Bd=function(){function e(t,n){this.ae=t,this.params=n}return e.prototype.calculateTargetCount=function(t,n){return this.ae.he(t).next(function(r){return Math.floor(n/100*r)})},e.prototype.nthSequenceNumber=function(t,n){var r=this;if(n===0)return E.resolve(xt.o);var i=new Ud(n);return this.ae.forEachTarget(t,function(o){return i.re(o.sequenceNumber)}).next(function(){return r.ae.le(t,function(o){return i.re(o)})}).next(function(){return i.maxValue})},e.prototype.removeTargets=function(t,n,r){return this.ae.removeTargets(t,n,r)},e.prototype.removeOrphanedDocuments=function(t,n){return this.ae.removeOrphanedDocuments(t,n)},e.prototype.collect=function(t,n){var r=this;return this.params.cacheSizeCollectionThreshold===-1?(T("LruGarbageCollector","Garbage collection skipped; disabled"),E.resolve(zu)):this.getCacheSize(t).next(function(i){return i<r.params.cacheSizeCollectionThreshold?(T("LruGarbageCollector","Garbage collection skipped; Cache size "+i+" is lower than threshold "+r.params.cacheSizeCollectionThreshold),zu):r.fe(t,n)})},e.prototype.getCacheSize=function(t){return this.ae.getCacheSize(t)},e.prototype.fe=function(t,n){var r,i,o,s,u,a,c,h=this,l=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(function(f){return f>h.params.maximumSequenceNumbersToCollect?(T("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.maximumSequenceNumbersToCollect+" from "+f),i=h.params.maximumSequenceNumbersToCollect):i=f,s=Date.now(),h.nthSequenceNumber(t,i)}).next(function(f){return r=f,u=Date.now(),h.removeTargets(t,r,n)}).next(function(f){return o=f,a=Date.now(),h.removeOrphanedDocuments(t,r)}).next(function(f){return c=Date.now(),mo()<=V.DEBUG&&T("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in `+(s-l)+`ms
	Determined least recently used `+i+" in "+(u-s)+`ms
	Removed `+o+" targets in "+(a-u)+`ms
	Removed `+f+" documents in "+(c-a)+`ms
Total Duration: `+(c-l)+"ms"),E.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:f})})},e}(),jd=function(){function e(t,n){this.db=t,this.garbageCollector=function(r,i){return new Bd(r,i)}(this,n)}return e.prototype.he=function(t){var n=this.de(t);return this.db.getTargetCache().getTargetCount(t).next(function(r){return n.next(function(i){return r+i})})},e.prototype.de=function(t){var n=0;return this.le(t,function(r){n++}).next(function(){return n})},e.prototype.forEachTarget=function(t,n){return this.db.getTargetCache().forEachTarget(t,n)},e.prototype.le=function(t,n){return this.we(t,function(r,i){return n(i)})},e.prototype.addReference=function(t,n,r){return _r(t,r)},e.prototype.removeReference=function(t,n,r){return _r(t,r)},e.prototype.removeTargets=function(t,n,r){return this.db.getTargetCache().removeTargets(t,n,r)},e.prototype.markPotentiallyOrphaned=function(t,n){return _r(t,n)},e.prototype._e=function(t,n){return function(r,i){var o=!1;return bh(r).Ot(function(s){return wh(r,s,i).next(function(u){return u&&(o=!0),E.resolve(!u)})}).next(function(){return o})}(t,n)},e.prototype.removeOrphanedDocuments=function(t,n){var r=this,i=this.db.getRemoteDocumentCache().newChangeBuffer(),o=[],s=0;return this.we(t,function(u,a){if(a<=n){var c=r._e(t,u).next(function(h){if(!h)return s++,i.getEntry(t,u).next(function(){return i.removeEntry(u),ie(t).delete([0,Mt(u.path)])})});o.push(c)}}).next(function(){return E.waitFor(o)}).next(function(){return i.apply(t)}).next(function(){return s})},e.prototype.removeTarget=function(t,n){var r=n.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,r)},e.prototype.updateLimboDocument=function(t,n){return _r(t,n)},e.prototype.we=function(t,n){var r,i=ie(t),o=xt.o;return i.$t({index:ot.documentTargetsIndex},function(s,u){var a=s[0];s[1];var c=u.path,h=u.sequenceNumber;a===0?(o!==xt.o&&n(new C($t(r)),o),o=h,r=c):o=xt.o}).next(function(){o!==xt.o&&n(new C($t(r)),o)})},e.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},e}();function _r(e,t){return ie(e).put(function(n,r){return new ot(0,Mt(n.path),r)}(t,e.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var wn=function(){function e(t,n){this.mapKeyFn=t,this.equalsFn=n,this.inner={}}return e.prototype.get=function(t){var n=this.mapKeyFn(t),r=this.inner[n];if(r!==void 0)for(var i=0,o=r;i<o.length;i++){var s=o[i],u=s[0],a=s[1];if(this.equalsFn(u,t))return a}},e.prototype.has=function(t){return this.get(t)!==void 0},e.prototype.set=function(t,n){var r=this.mapKeyFn(t),i=this.inner[r];if(i!==void 0){for(var o=0;o<i.length;o++)if(this.equalsFn(i[o][0],t))return void(i[o]=[t,n]);i.push([t,n])}else this.inner[r]=[[t,n]]},e.prototype.delete=function(t){var n=this.mapKeyFn(t),r=this.inner[n];if(r===void 0)return!1;for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return r.length===1?delete this.inner[n]:r.splice(i,1),!0;return!1},e.prototype.forEach=function(t){Le(this.inner,function(n,r){for(var i=0,o=r;i<o.length;i++){var s=o[i],u=s[0],a=s[1];t(u,a)}})},e.prototype.isEmpty=function(){return Pc(this.inner)},e}(),Eh=function(){function e(){this.changes=new wn(function(t){return t.toString()},function(t,n){return t.isEqual(n)}),this.changesApplied=!1}return e.prototype.getReadTime=function(t){var n=this.changes.get(t);return n?n.readTime:P.min()},e.prototype.addEntry=function(t,n){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:n})},e.prototype.removeEntry=function(t,n){n===void 0&&(n=null),this.assertNotApplied(),this.changes.set(t,{document:dt.newInvalidDocument(t),readTime:n})},e.prototype.getEntry=function(t,n){this.assertNotApplied();var r=this.changes.get(n);return r!==void 0?E.resolve(r.document):this.getFromCache(t,n)},e.prototype.getEntries=function(t,n){return this.getAllFromCache(t,n)},e.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},e.prototype.assertNotApplied=function(){},e}(),Kd=function(){function e(t,n){this.R=t,this.Ut=n}return e.prototype.addEntry=function(t,n,r){return ne(t).put(Sr(n),r)},e.prototype.removeEntry=function(t,n){var r=ne(t),i=Sr(n);return r.delete(i)},e.prototype.updateMetadata=function(t,n){var r=this;return this.getMetadata(t).next(function(i){return i.byteSize+=n,r.me(t,i)})},e.prototype.getEntry=function(t,n){var r=this;return ne(t).get(Sr(n)).next(function(i){return r.ye(n,i)})},e.prototype.ge=function(t,n){var r=this;return ne(t).get(Sr(n)).next(function(i){return{document:r.ye(n,i),size:Jr(i)}})},e.prototype.getEntries=function(t,n){var r=this,i=Ft();return this.pe(t,n,function(o,s){var u=r.ye(o,s);i=i.insert(o,u)}).next(function(){return i})},e.prototype.Ee=function(t,n){var r=this,i=Ft(),o=new gt(C.comparator);return this.pe(t,n,function(s,u){var a=r.ye(s,u);i=i.insert(s,a),o=o.insert(s,Jr(u))}).next(function(){return{documents:i,Te:o}})},e.prototype.pe=function(t,n,r){if(n.isEmpty())return E.resolve();var i=IDBKeyRange.bound(n.first().path.toArray(),n.last().path.toArray()),o=n.getIterator(),s=o.getNext();return ne(t).$t({range:i},function(u,a,c){for(var h=C.fromSegments(u);s&&C.comparator(s,h)<0;)r(s,null),s=o.getNext();s&&s.isEqual(h)&&(r(s,a),s=o.hasNext()?o.getNext():null),s?c.Ct(s.path.toArray()):c.done()}).next(function(){for(;s;)r(s,null),s=o.hasNext()?o.getNext():null})},e.prototype.getDocumentsMatchingQuery=function(t,n,r){var i=this,o=Ft(),s=n.path.length+1,u={};if(r.isEqual(P.min())){var a=n.path.toArray();u.range=IDBKeyRange.lowerBound(a)}else{var c=n.path.toArray(),h=ws(r);u.range=IDBKeyRange.lowerBound([c,h],!0),u.index=$.collectionReadTimeIndex}return ne(t).$t(u,function(l,f,p){if(l.length===s){var d=So(i.R,f);n.path.isPrefixOf(d.key.path)?lr(n,d)&&(o=o.insert(d.key,d)):p.done()}}).next(function(){return o})},e.prototype.newChangeBuffer=function(t){return new zd(this,!!t&&t.trackRemovals)},e.prototype.getSize=function(t){return this.getMetadata(t).next(function(n){return n.byteSize})},e.prototype.getMetadata=function(t){return Hu(t).get(qt.key).next(function(n){return k(!!n),n})},e.prototype.me=function(t,n){return Hu(t).put(qt.key,n)},e.prototype.ye=function(t,n){if(n){var r=So(this.R,n);if(!r.isNoDocument()||!r.version.isEqual(P.min()))return r}return dt.newInvalidDocument(t)},e}(),zd=function(e){function t(n,r){var i=this;return(i=e.call(this)||this).Ie=n,i.trackRemovals=r,i.Ae=new wn(function(o){return o.toString()},function(o,s){return o.isEqual(s)}),i}return x(t,e),t.prototype.applyChanges=function(n){var r=this,i=[],o=0,s=new tt(function(u,a){return L(u.canonicalString(),a.canonicalString())});return this.changes.forEach(function(u,a){var c=r.Ae.get(u);if(a.document.isValidDocument()){var h=qu(r.Ie.R,a.document,r.getReadTime(u));s=s.add(u.path.popLast());var l=Jr(h);o+=l-c,i.push(r.Ie.addEntry(n,u,h))}else if(o-=c,r.trackRemovals){var f=qu(r.Ie.R,dt.newNoDocument(u,P.min()),r.getReadTime(u));i.push(r.Ie.addEntry(n,u,f))}else i.push(r.Ie.removeEntry(n,u))}),s.forEach(function(u){i.push(r.Ie.Ut.addToCollectionParentIndex(n,u))}),i.push(this.Ie.updateMetadata(n,o)),E.waitFor(i)},t.prototype.getFromCache=function(n,r){var i=this;return this.Ie.ge(n,r).next(function(o){return i.Ae.set(r,o.size),o.document})},t.prototype.getAllFromCache=function(n,r){var i=this;return this.Ie.Ee(n,r).next(function(o){var s=o.documents;return o.Te.forEach(function(u,a){i.Ae.set(u,a)}),s})},t}(Eh);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hu(e){return At(e,qt.store)}function ne(e){return At(e,$.store)}function Sr(e){return e.path.toArray()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Gd=function(){function e(t){this.R=t}return e.prototype.Rt=function(t,n,r,i){var o=this;k(r<i&&r>=0&&i<=11);var s=new ph("createOrUpgrade",n);r<1&&i>=1&&(function(a){a.createObjectStore(Nt.store)}(t),function(a){a.createObjectStore(ue.store,{keyPath:ue.keyPath}),a.createObjectStore(K.store,{keyPath:K.keyPath,autoIncrement:!0}).createIndex(K.userMutationsIndex,K.userMutationsKeyPath,{unique:!0}),a.createObjectStore(ht.store)}(t),Qu(t),function(a){a.createObjectStore($.store)}(t));var u=E.resolve();return r<3&&i>=3&&(r!==0&&(function(a){a.deleteObjectStore(ot.store),a.deleteObjectStore(It.store),a.deleteObjectStore(Dt.store)}(t),Qu(t)),u=u.next(function(){return function(a){var c=a.store(Dt.store),h=new Dt(0,0,P.min().toTimestamp(),0);return c.put(Dt.key,h)}(s)})),r<4&&i>=4&&(r!==0&&(u=u.next(function(){return function(a,c){return c.store(K.store).Nt().next(function(h){a.deleteObjectStore(K.store),a.createObjectStore(K.store,{keyPath:K.keyPath,autoIncrement:!0}).createIndex(K.userMutationsIndex,K.userMutationsKeyPath,{unique:!0});var l=c.store(K.store),f=h.map(function(p){return l.put(p)});return E.waitFor(f)})}(t,s)})),u=u.next(function(){(function(a){a.createObjectStore(Qt.store,{keyPath:Qt.keyPath})})(t)})),r<5&&i>=5&&(u=u.next(function(){return o.Re(s)})),r<6&&i>=6&&(u=u.next(function(){return function(a){a.createObjectStore(qt.store)}(t),o.be(s)})),r<7&&i>=7&&(u=u.next(function(){return o.ve(s)})),r<8&&i>=8&&(u=u.next(function(){return o.Pe(t,s)})),r<9&&i>=9&&(u=u.next(function(){(function(a){a.objectStoreNames.contains("remoteDocumentChanges")&&a.deleteObjectStore("remoteDocumentChanges")})(t),function(a){var c=a.objectStore($.store);c.createIndex($.readTimeIndex,$.readTimeIndexPath,{unique:!1}),c.createIndex($.collectionReadTimeIndex,$.collectionReadTimeIndexPath,{unique:!1})}(n)})),r<10&&i>=10&&(u=u.next(function(){return o.Ve(s)})),r<11&&i>=11&&(u=u.next(function(){(function(a){a.createObjectStore(un.store,{keyPath:un.keyPath})})(t),function(a){a.createObjectStore(an.store,{keyPath:an.keyPath})}(t)})),u},e.prototype.be=function(t){var n=0;return t.store($.store).$t(function(r,i){n+=Jr(i)}).next(function(){var r=new qt(n);return t.store(qt.store).put(qt.key,r)})},e.prototype.Re=function(t){var n=this,r=t.store(ue.store),i=t.store(K.store);return r.Nt().next(function(o){return E.forEach(o,function(s){var u=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return i.Nt(K.userMutationsIndex,u).next(function(a){return E.forEach(a,function(c){k(c.userId===s.userId);var h=Ge(n.R,c);return mh(t,s.userId,h).next(function(){})})})})})},e.prototype.ve=function(t){var n=t.store(ot.store),r=t.store($.store);return t.store(Dt.store).get(Dt.key).next(function(i){var o=[];return r.$t(function(s,u){var a=new U(s),c=function(h){return[0,Mt(h)]}(a);o.push(n.get(c).next(function(h){return h?E.resolve():function(l){return n.put(new ot(0,Mt(l),i.highestListenSequenceNumber))}(a)}))}).next(function(){return E.waitFor(o)})})},e.prototype.Pe=function(t,n){t.createObjectStore(_e.store,{keyPath:_e.keyPath});var r=n.store(_e.store),i=new bs,o=function(s){if(i.add(s)){var u=s.lastSegment(),a=s.popLast();return r.put({collectionId:u,parent:Mt(a)})}};return n.store($.store).$t({Ft:!0},function(s,u){var a=new U(s);return o(a.popLast())}).next(function(){return n.store(ht.store).$t({Ft:!0},function(s,u){s[0];var a=s[1];s[2];var c=$t(a);return o(c.popLast())})})},e.prototype.Ve=function(t){var n=this,r=t.store(It.store);return r.$t(function(i,o){var s=Dn(o),u=vh(n.R,s);return r.put(u)})},e}();function Qu(e){e.createObjectStore(ot.store,{keyPath:ot.keyPath}).createIndex(ot.documentTargetsIndex,ot.documentTargetsKeyPath,{unique:!0}),e.createObjectStore(It.store,{keyPath:It.keyPath}).createIndex(It.queryTargetsIndexName,It.queryTargetsKeyPath,{unique:!0}),e.createObjectStore(Dt.store)}var Xi="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",$d=function(){function e(t,n,r,i,o,s,u,a,c,h){if(this.allowTabSynchronization=t,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=s,this.document=u,this.De=c,this.Ce=h,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ke=null,this.inForeground=!1,this.Fe=null,this.$e=null,this.Oe=Number.NEGATIVE_INFINITY,this.Me=function(l){return Promise.resolve()},!e.yt())throw new w(g.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new jd(this,i),this.Le=n+"main",this.R=new dh(a),this.Be=new cn(this.Le,11,new Gd(this.R)),this.qe=new Vd(this.referenceDelegate,this.R),this.Ut=new Fd,this.Ue=function(l,f){return new Kd(l,f)}(this.R,this.Ut),this.Ke=new Pd,this.window&&this.window.localStorage?this.Qe=this.window.localStorage:(this.Qe=null,h===!1&&Y("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return e.prototype.start=function(){var t=this;return this.je().then(function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new w(g.FAILED_PRECONDITION,Xi);return t.We(),t.Ge(),t.ze(),t.runTransaction("getHighestListenSequenceNumber","readonly",function(n){return t.qe.getHighestSequenceNumber(n)})}).then(function(n){t.Ne=new xt(n,t.De)}).then(function(){t.xe=!0}).catch(function(n){return t.Be&&t.Be.close(),Promise.reject(n)})},e.prototype.He=function(t){var n=this;return this.Me=function(r){return m(n,void 0,void 0,function(){return y(this,function(i){return this.started?[2,t(r)]:[2]})})},t(this.isPrimary)},e.prototype.setDatabaseDeletedListener=function(t){var n=this;this.Be.vt(function(r){return m(n,void 0,void 0,function(){return y(this,function(i){switch(i.label){case 0:return r.newVersion===null?[4,t()]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}})})})},e.prototype.setNetworkEnabled=function(t){var n=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Se.enqueueAndForget(function(){return m(n,void 0,void 0,function(){return y(this,function(r){switch(r.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}})})}))},e.prototype.je=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(n){return Ar(n).put(new Qt(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next(function(){if(t.isPrimary)return t.Je(n).next(function(r){r||(t.isPrimary=!1,t.Se.enqueueRetryable(function(){return t.Me(!1)}))})}).next(function(){return t.Ye(n)}).next(function(r){return t.isPrimary&&!r?t.Xe(n).next(function(){return!1}):!!r&&t.Ze(n).next(function(){return!0})})}).catch(function(n){if(Me(n))return T("IndexedDbPersistence","Failed to extend owner lease: ",n),t.isPrimary;if(!t.allowTabSynchronization)throw n;return T("IndexedDbPersistence","Releasing owner lease after error during lease refresh",n),!1}).then(function(n){t.isPrimary!==n&&t.Se.enqueueRetryable(function(){return t.Me(n)}),t.isPrimary=n})},e.prototype.Je=function(t){var n=this;return An(t).get(Nt.key).next(function(r){return E.resolve(n.tn(r))})},e.prototype.en=function(t){return Ar(t).delete(this.clientId)},e.prototype.nn=function(){return m(this,void 0,void 0,function(){var t,n,r,i,o=this;return y(this,function(s){switch(s.label){case 0:return!this.isPrimary||this.sn(this.Oe,18e5)?[3,2]:(this.Oe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(u){var a=At(u,Qt.store);return a.Nt().next(function(c){var h=o.rn(c,18e5),l=c.filter(function(f){return h.indexOf(f)===-1});return E.forEach(l,function(f){return a.delete(f.clientId)}).next(function(){return l})})}).catch(function(){return[]})]);case 1:if(t=s.sent(),this.Qe)for(n=0,r=t;n<r.length;n++)i=r[n],this.Qe.removeItem(this.on(i.clientId));s.label=2;case 2:return[2]}})})},e.prototype.ze=function(){var t=this;this.$e=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,function(){return t.je().then(function(){return t.nn()}).then(function(){return t.ze()})})},e.prototype.tn=function(t){return!!t&&t.ownerId===this.clientId},e.prototype.Ye=function(t){var n=this;return this.Ce?E.resolve(!0):An(t).get(Nt.key).next(function(r){if(r!==null&&n.sn(r.leaseTimestampMs,5e3)&&!n.cn(r.ownerId)){if(n.tn(r)&&n.networkEnabled)return!0;if(!n.tn(r)){if(!r.allowTabSynchronization)throw new w(g.FAILED_PRECONDITION,Xi);return!1}}return!(!n.networkEnabled||!n.inForeground)||Ar(t).Nt().next(function(i){return n.rn(i,5e3).find(function(o){if(n.clientId!==o.clientId){var s=!n.networkEnabled&&o.networkEnabled,u=!n.inForeground&&o.inForeground,a=n.networkEnabled===o.networkEnabled;if(s||u&&a)return!0}return!1})===void 0})}).next(function(r){return n.isPrimary!==r&&T("IndexedDbPersistence","Client "+(r?"is":"is not")+" eligible for a primary lease."),r})},e.prototype.shutdown=function(){return m(this,void 0,void 0,function(){var t=this;return y(this,function(n){switch(n.label){case 0:return this.xe=!1,this.un(),this.$e&&(this.$e.cancel(),this.$e=null),this.an(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[Nt.store,Qt.store],function(r){var i=new Uu(r,xt.o);return t.Xe(i).next(function(){return t.en(i)})})];case 1:return n.sent(),this.Be.close(),this.ln(),[2]}})})},e.prototype.rn=function(t,n){var r=this;return t.filter(function(i){return r.sn(i.updateTimeMs,n)&&!r.cn(i.clientId)})},e.prototype.fn=function(){var t=this;return this.runTransaction("getActiveClients","readonly",function(n){return Ar(n).Nt().next(function(r){return t.rn(r,18e5).map(function(i){return i.clientId})})})},Object.defineProperty(e.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),e.prototype.getMutationQueue=function(t){return Md.Qt(t,this.R,this.Ut,this.referenceDelegate)},e.prototype.getTargetCache=function(){return this.qe},e.prototype.getRemoteDocumentCache=function(){return this.Ue},e.prototype.getIndexManager=function(){return this.Ut},e.prototype.getBundleCache=function(){return this.Ke},e.prototype.runTransaction=function(t,n,r){var i=this;T("IndexedDbPersistence","Starting transaction:",t);var o,s=n==="readonly"?"readonly":"readwrite";return this.Be.runTransaction(t,s,xd,function(u){return o=new Uu(u,i.Ne?i.Ne.next():xt.o),n==="readwrite-primary"?i.Je(o).next(function(a){return!!a||i.Ye(o)}).next(function(a){if(!a)throw Y("Failed to obtain primary lease for action '"+t+"'."),i.isPrimary=!1,i.Se.enqueueRetryable(function(){return i.Me(!1)}),new w(g.FAILED_PRECONDITION,lh);return r(o)}).next(function(a){return i.Ze(o).next(function(){return a})}):i.dn(o).next(function(){return r(o)})}).then(function(u){return o.raiseOnCommittedEvent(),u})},e.prototype.dn=function(t){var n=this;return An(t).get(Nt.key).next(function(r){if(r!==null&&n.sn(r.leaseTimestampMs,5e3)&&!n.cn(r.ownerId)&&!n.tn(r)&&!(n.Ce||n.allowTabSynchronization&&r.allowTabSynchronization))throw new w(g.FAILED_PRECONDITION,Xi)})},e.prototype.Ze=function(t){var n=new Nt(this.clientId,this.allowTabSynchronization,Date.now());return An(t).put(Nt.key,n)},e.yt=function(){return cn.yt()},e.prototype.Xe=function(t){var n=this,r=An(t);return r.get(Nt.key).next(function(i){return n.tn(i)?(T("IndexedDbPersistence","Releasing primary lease."),r.delete(Nt.key)):E.resolve()})},e.prototype.sn=function(t,n){var r=Date.now();return!(t<r-n||t>r&&(Y("Detected an update time that is in the future: "+t+" > "+r),1))},e.prototype.We=function(){var t=this;this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Fe=function(){t.Se.enqueueAndForget(function(){return t.inForeground=t.document.visibilityState==="visible",t.je()})},this.document.addEventListener("visibilitychange",this.Fe),this.inForeground=this.document.visibilityState==="visible")},e.prototype.an=function(){this.Fe&&(this.document.removeEventListener("visibilitychange",this.Fe),this.Fe=null)},e.prototype.Ge=function(){var t,n=this;typeof((t=this.window)===null||t===void 0?void 0:t.addEventListener)=="function"&&(this.ke=function(){n.un(),Jl()&&navigator.appVersion.match("Version/14")&&n.Se.enterRestrictedMode(!0),n.Se.enqueueAndForget(function(){return n.shutdown()})},this.window.addEventListener("pagehide",this.ke))},e.prototype.hn=function(){this.ke&&(this.window.removeEventListener("pagehide",this.ke),this.ke=null)},e.prototype.cn=function(t){var n;try{var r=((n=this.Qe)===null||n===void 0?void 0:n.getItem(this.on(t)))!==null;return T("IndexedDbPersistence","Client '"+t+"' "+(r?"is":"is not")+" zombied in LocalStorage"),r}catch(i){return Y("IndexedDbPersistence","Failed to get zombied client id.",i),!1}},e.prototype.un=function(){if(this.Qe)try{this.Qe.setItem(this.on(this.clientId),String(Date.now()))}catch(t){Y("Failed to set zombie client id.",t)}},e.prototype.ln=function(){if(this.Qe)try{this.Qe.removeItem(this.on(this.clientId))}catch{}},e.prototype.on=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},e}();function An(e){return At(e,Nt.store)}function Ar(e){return At(e,Qt.store)}function Es(e,t){var n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}var Ih=function(){function e(t,n,r){this.Ue=t,this._n=n,this.Ut=r}return e.prototype.mn=function(t,n){var r=this;return this._n.getAllMutationBatchesAffectingDocumentKey(t,n).next(function(i){return r.yn(t,n,i)})},e.prototype.yn=function(t,n,r){return this.Ue.getEntry(t,n).next(function(i){for(var o=0,s=r;o<s.length;o++)s[o].applyToLocalView(i);return i})},e.prototype.gn=function(t,n){t.forEach(function(r,i){for(var o=0,s=n;o<s.length;o++)s[o].applyToLocalView(i)})},e.prototype.pn=function(t,n){var r=this;return this.Ue.getEntries(t,n).next(function(i){return r.En(t,i).next(function(){return i})})},e.prototype.En=function(t,n){var r=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,n).next(function(i){return r.gn(n,i)})},e.prototype.getDocumentsMatchingQuery=function(t,n,r){return function(i){return C.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}(n)?this.Tn(t,n.path):fs(n)?this.In(t,n,r):this.An(t,n,r)},e.prototype.Tn=function(t,n){return this.mn(t,new C(n)).next(function(r){var i=To();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})},e.prototype.In=function(t,n,r){var i=this,o=n.collectionGroup,s=To();return this.Ut.getCollectionParents(t,o).next(function(u){return E.forEach(u,function(a){var c=function(h,l){return new Jt(l,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(n,a.child(o));return i.An(t,c,r).next(function(h){h.forEach(function(l,f){s=s.insert(l,f)})})}).next(function(){return s})})},e.prototype.An=function(t,n,r){var i,o,s=this;return this.Ue.getDocumentsMatchingQuery(t,n,r).next(function(u){return i=u,s._n.getAllMutationBatchesAffectingQuery(t,n)}).next(function(u){return o=u,s.Rn(t,o,i).next(function(a){i=a;for(var c=0,h=o;c<h.length;c++)for(var l=h[c],f=0,p=l.mutations;f<p.length;f++){var d=p[f],v=d.key,b=i.get(v);b==null&&(b=dt.newInvalidDocument(v),i=i.insert(v,b)),Io(d,b,l.localWriteTime),b.isFoundDocument()||(i=i.remove(v))}})}).next(function(){return i.forEach(function(u,a){lr(n,a)||(i=i.remove(u))}),i})},e.prototype.Rn=function(t,n,r){for(var i=j(),o=0,s=n;o<s.length;o++)for(var u=0,a=s[o].mutations;u<a.length;u++){var c=a[u];c instanceof de&&r.get(c.key)===null&&(i=i.add(c.key))}var h=r;return this.Ue.getEntries(t,i).next(function(l){return l.forEach(function(f,p){p.isFoundDocument()&&(h=h.insert(f,p))}),h})},e}(),Hd=function(){function e(t,n,r,i){this.targetId=t,this.fromCache=n,this.bn=r,this.vn=i}return e.Pn=function(t,n){for(var r=j(),i=j(),o=0,s=n.docChanges;o<s.length;o++){var u=s[o];switch(u.type){case 0:r=r.add(u.doc.key);break;case 1:i=i.add(u.doc.key)}}return new e(t,n.fromCache,r,i)},e}(),Th=function(){function e(){}return e.prototype.Vn=function(t){this.Sn=t},e.prototype.getDocumentsMatchingQuery=function(t,n,r,i){var o=this;return function(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}(n)||r.isEqual(P.min())?this.Dn(t,n):this.Sn.pn(t,i).next(function(s){var u=o.Cn(n,s);return(xr(n)||Yr(n))&&o.Nn(n.limitType,u,i,r)?o.Dn(t,n):(mo()<=V.DEBUG&&T("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Eo(n)),o.Sn.getDocumentsMatchingQuery(t,n,r).next(function(a){return u.forEach(function(c){a=a.insert(c.key,c)}),a}))})},e.prototype.Cn=function(t,n){var r=new tt(Kc(t));return n.forEach(function(i,o){lr(t,o)&&(r=r.add(o))}),r},e.prototype.Nn=function(t,n,r,i){if(r.size!==n.size)return!0;var o=t==="F"?n.last():n.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)},e.prototype.Dn=function(t,n){return mo()<=V.DEBUG&&T("QueryEngine","Using full collection scan to execute query:",Eo(n)),this.Sn.getDocumentsMatchingQuery(t,n,P.min())},e}(),Qd=function(){function e(t,n,r,i){this.persistence=t,this.xn=n,this.R=i,this.kn=new gt(L),this.Fn=new wn(function(o){return ar(o)},Ii),this.$n=P.min(),this._n=t.getMutationQueue(r),this.On=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new Ih(this.On,this._n,this.persistence.getIndexManager()),this.Ke=t.getBundleCache(),this.xn.Vn(this.Mn)}return e.prototype.collectGarbage=function(t){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(r){return t.collect(r,n.kn)})},e}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _h(e,t,n,r){return new Qd(e,t,n,r)}function Sh(e,t){return m(this,void 0,void 0,function(){var n,r,i,o;return y(this,function(s){switch(s.label){case 0:return n=_(e),r=n._n,i=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",function(u){var a;return n._n.getAllMutationBatches(u).next(function(c){return a=c,r=n.persistence.getMutationQueue(t),i=new Ih(n.On,r,n.persistence.getIndexManager()),r.getAllMutationBatches(u)}).next(function(c){for(var h=[],l=[],f=j(),p=0,d=a;p<d.length;p++){var v=d[p];h.push(v.batchId);for(var b=0,I=v.mutations;b<I.length;b++){var N=I[b];f=f.add(N.key)}}for(var A=0,O=c;A<O.length;A++){var F=O[A];l.push(F.batchId);for(var B=0,rt=F.mutations;B<rt.length;B++){var Vi=rt[B];f=f.add(Vi.key)}}return i.pn(u,f).next(function(_n){return{Ln:_n,removedBatchIds:h,addedBatchIds:l}})})})];case 1:return o=s.sent(),[2,(n._n=r,n.Mn=i,n.xn.Vn(n.Mn),o)]}})})}function Wd(e,t){var n=_(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(r){var i=t.batch.keys(),o=n.On.newChangeBuffer({trackRemovals:!0});return function(s,u,a,c){var h=a.batch,l=h.keys(),f=E.resolve();return l.forEach(function(p){f=f.next(function(){return c.getEntry(u,p)}).next(function(d){var v=a.docVersions.get(p);k(v!==null),d.version.compareTo(v)<0&&(h.applyToRemoteDocument(d,a),d.isValidDocument()&&c.addEntry(d,a.commitVersion))})}),f.next(function(){return s._n.removeMutationBatch(u,h)})}(n,r,t,o).next(function(){return o.apply(r)}).next(function(){return n._n.performConsistencyCheck(r)}).next(function(){return n.Mn.pn(r,i)})})}function Ah(e){var t=_(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",function(n){return t.qe.getLastRemoteSnapshotVersion(n)})}function Yd(e,t){var n=_(e),r=t.snapshotVersion,i=n.kn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var s=n.On.newChangeBuffer({trackRemovals:!0});i=n.kn;var u=[];t.targetChanges.forEach(function(h,l){var f=i.get(l);if(f){u.push(n.qe.removeMatchingKeys(o,h.removedDocuments,l).next(function(){return n.qe.addMatchingKeys(o,h.addedDocuments,l)}));var p=h.resumeToken;if(p.approximateByteSize()>0){var d=f.withResumeToken(p,r).withSequenceNumber(o.currentSequenceNumber);i=i.insert(l,d),function(v,b,I){return k(b.resumeToken.approximateByteSize()>0),v.resumeToken.approximateByteSize()===0||b.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=3e8||I.addedDocuments.size+I.modifiedDocuments.size+I.removedDocuments.size>0}(f,d,h)&&u.push(n.qe.updateTargetData(o,d))}}});var a=Ft();if(t.documentUpdates.forEach(function(h,l){t.resolvedLimboDocuments.has(h)&&u.push(n.persistence.referenceDelegate.updateLimboDocument(o,h))}),u.push(Xd(o,s,t.documentUpdates,r,void 0).next(function(h){a=h})),!r.isEqual(P.min())){var c=n.qe.getLastRemoteSnapshotVersion(o).next(function(h){return n.qe.setTargetsMetadata(o,o.currentSequenceNumber,r)});u.push(c)}return E.waitFor(u).next(function(){return s.apply(o)}).next(function(){return n.Mn.En(o,a)}).next(function(){return a})}).then(function(o){return n.kn=i,o})}function Xd(e,t,n,r,i){var o=j();return n.forEach(function(s){return o=o.add(s)}),t.getEntries(e,o).next(function(s){var u=Ft();return n.forEach(function(a,c){var h=s.get(a),l=(i==null?void 0:i.get(a))||r;c.isNoDocument()&&c.version.isEqual(P.min())?(t.removeEntry(a,l),u=u.insert(a,c)):!h.isValidDocument()||c.version.compareTo(h.version)>0||c.version.compareTo(h.version)===0&&h.hasPendingWrites?(t.addEntry(c,l),u=u.insert(a,c)):T("LocalStore","Ignoring outdated watch update for ",a,". Current version:",h.version," Watch version:",c.version)}),u})}function Jd(e,t){var n=_(e);return n.persistence.runTransaction("Get next mutation batch","readonly",function(r){return t===void 0&&(t=-1),n._n.getNextMutationBatchAfterBatchId(r,t)})}function ti(e,t){var n=_(e);return n.persistence.runTransaction("Allocate target","readwrite",function(r){var i;return n.qe.getTargetData(r,t).next(function(o){return o?(i=o,E.resolve(i)):n.qe.allocateTargetId(r).next(function(s){return i=new Ai(t,s,0,r.currentSequenceNumber),n.qe.addTargetData(r,i).next(function(){return i})})})}).then(function(r){var i=n.kn.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.kn=n.kn.insert(r.targetId,r),n.Fn.set(t,r.targetId)),r})}function fn(e,t,n){return m(this,void 0,void 0,function(){var r,i,o,s;return y(this,function(u){switch(u.label){case 0:r=_(e),i=r.kn.get(t),o=n?"readwrite":"readwrite-primary",u.label=1;case 1:return u.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,function(a){return r.persistence.referenceDelegate.removeTarget(a,i)})];case 2:u.sent(),u.label=3;case 3:return[3,5];case 4:if(!Me(s=u.sent()))throw s;return T("LocalStore","Failed to update sequence numbers for target "+t+": "+s),[3,5];case 5:return r.kn=r.kn.remove(t),r.Fn.delete(i.target),[2]}})})}function ei(e,t,n){var r=_(e),i=P.min(),o=j();return r.persistence.runTransaction("Execute query","readonly",function(s){return function(u,a,c){var h=_(u),l=h.Fn.get(c);return l!==void 0?E.resolve(h.kn.get(l)):h.qe.getTargetData(a,c)}(r,s,Kt(t)).next(function(u){if(u)return i=u.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(s,u.targetId).next(function(a){o=a})}).next(function(){return r.xn.getDocumentsMatchingQuery(s,t,n?i:P.min(),n?o:j())}).next(function(u){return{documents:u,Bn:o}})})}function Nh(e,t){var n=_(e),r=_(n.qe),i=n.kn.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(o){return r.lt(o,t).next(function(s){return s?s.target:null})})}function Dh(e){var t=_(e);return t.persistence.runTransaction("Get new document changes","readonly",function(n){return function(r,i,o){var s=_(r),u=Ft(),a=ws(o),c=ne(i),h=IDBKeyRange.lowerBound(a,!0);return c.$t({index:$.readTimeIndex,range:h},function(l,f){var p=So(s.R,f);u=u.insert(p.key,p),a=f.readTime}).next(function(){return{wn:u,readTime:gh(a)}})}(t.On,n,t.$n)}).then(function(n){var r=n.wn,i=n.readTime;return t.$n=i,r})}function Zd(e){return m(this,void 0,void 0,function(){var t;return y(this,function(n){return[2,(t=_(e)).persistence.runTransaction("Synchronize last document change read time","readonly",function(r){return function(i){var o=ne(i),s=P.min();return o.$t({index:$.readTimeIndex,reverse:!0},function(u,a,c){a.readTime&&(s=gh(a.readTime)),c.done()}).next(function(){return s})}(r)}).then(function(r){t.$n=r})]})})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var tg=function(){function e(t){this.R=t,this.Qn=new Map,this.jn=new Map}return e.prototype.getBundleMetadata=function(t,n){return E.resolve(this.Qn.get(n))},e.prototype.saveBundleMetadata=function(t,n){var r;return this.Qn.set(n.id,{id:(r=n).id,version:r.version,createTime:Et(r.createTime)}),E.resolve()},e.prototype.getNamedQuery=function(t,n){return E.resolve(this.jn.get(n))},e.prototype.saveNamedQuery=function(t,n){return this.jn.set(n.name,function(r){return{name:r.name,query:yh(r.bundledQuery),readTime:Et(r.readTime)}}(n)),E.resolve()},e}(),Is=function(){function e(){this.Wn=new tt(et.Gn),this.zn=new tt(et.Hn)}return e.prototype.isEmpty=function(){return this.Wn.isEmpty()},e.prototype.addReference=function(t,n){var r=new et(t,n);this.Wn=this.Wn.add(r),this.zn=this.zn.add(r)},e.prototype.Jn=function(t,n){var r=this;t.forEach(function(i){return r.addReference(i,n)})},e.prototype.removeReference=function(t,n){this.Yn(new et(t,n))},e.prototype.Xn=function(t,n){var r=this;t.forEach(function(i){return r.removeReference(i,n)})},e.prototype.Zn=function(t){var n=this,r=new C(new U([])),i=new et(r,t),o=new et(r,t+1),s=[];return this.zn.forEachInRange([i,o],function(u){n.Yn(u),s.push(u.key)}),s},e.prototype.ts=function(){var t=this;this.Wn.forEach(function(n){return t.Yn(n)})},e.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},e.prototype.es=function(t){var n=new C(new U([])),r=new et(n,t),i=new et(n,t+1),o=j();return this.zn.forEachInRange([r,i],function(s){o=o.add(s.key)}),o},e.prototype.containsKey=function(t){var n=new et(t,0),r=this.Wn.firstAfterOrEqual(n);return r!==null&&t.isEqual(r.key)},e}(),et=function(){function e(t,n){this.key=t,this.ns=n}return e.Gn=function(t,n){return C.comparator(t.key,n.key)||L(t.ns,n.ns)},e.Hn=function(t,n){return L(t.ns,n.ns)||C.comparator(t.key,n.key)},e}(),eg=function(){function e(t,n){this.Ut=t,this.referenceDelegate=n,this._n=[],this.ss=1,this.rs=new tt(et.Gn)}return e.prototype.checkEmpty=function(t){return E.resolve(this._n.length===0)},e.prototype.addMutationBatch=function(t,n,r,i){var o=this.ss;this.ss++,this._n.length>0&&this._n[this._n.length-1];var s=new ms(o,n,r,i);this._n.push(s);for(var u=0,a=i;u<a.length;u++){var c=a[u];this.rs=this.rs.add(new et(c.key,o)),this.Ut.addToCollectionParentIndex(t,c.key.path.popLast())}return E.resolve(s)},e.prototype.lookupMutationBatch=function(t,n){return E.resolve(this.os(n))},e.prototype.getNextMutationBatchAfterBatchId=function(t,n){var r=n+1,i=this.cs(r),o=i<0?0:i;return E.resolve(this._n.length>o?this._n[o]:null)},e.prototype.getHighestUnacknowledgedBatchId=function(){return E.resolve(this._n.length===0?-1:this.ss-1)},e.prototype.getAllMutationBatches=function(t){return E.resolve(this._n.slice())},e.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,n){var r=this,i=new et(n,0),o=new et(n,Number.POSITIVE_INFINITY),s=[];return this.rs.forEachInRange([i,o],function(u){var a=r.os(u.ns);s.push(a)}),E.resolve(s)},e.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,n){var r=this,i=new tt(L);return n.forEach(function(o){var s=new et(o,0),u=new et(o,Number.POSITIVE_INFINITY);r.rs.forEachInRange([s,u],function(a){i=i.add(a.ns)})}),E.resolve(this.us(i))},e.prototype.getAllMutationBatchesAffectingQuery=function(t,n){var r=n.path,i=r.length+1,o=r;C.isDocumentKey(o)||(o=o.child(""));var s=new et(new C(o),0),u=new tt(L);return this.rs.forEachWhile(function(a){var c=a.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(u=u.add(a.ns)),!0)},s),E.resolve(this.us(u))},e.prototype.us=function(t){var n=this,r=[];return t.forEach(function(i){var o=n.os(i);o!==null&&r.push(o)}),r},e.prototype.removeMutationBatch=function(t,n){var r=this;k(this.hs(n.batchId,"removed")===0),this._n.shift();var i=this.rs;return E.forEach(n.mutations,function(o){var s=new et(o.key,n.batchId);return i=i.delete(s),r.referenceDelegate.markPotentiallyOrphaned(t,o.key)}).next(function(){r.rs=i})},e.prototype.Gt=function(t){},e.prototype.containsKey=function(t,n){var r=new et(n,0),i=this.rs.firstAfterOrEqual(r);return E.resolve(n.isEqual(i&&i.key))},e.prototype.performConsistencyCheck=function(t){return this._n.length,E.resolve()},e.prototype.hs=function(t,n){return this.cs(t)},e.prototype.cs=function(t){return this._n.length===0?0:t-this._n[0].batchId},e.prototype.os=function(t){var n=this.cs(t);return n<0||n>=this._n.length?null:this._n[n]},e}(),ng=function(){function e(t,n){this.Ut=t,this.ls=n,this.docs=new gt(C.comparator),this.size=0}return e.prototype.addEntry=function(t,n,r){var i=n.key,o=this.docs.get(i),s=o?o.size:0,u=this.ls(n);return this.docs=this.docs.insert(i,{document:n.clone(),size:u,readTime:r}),this.size+=u-s,this.Ut.addToCollectionParentIndex(t,i.path.popLast())},e.prototype.removeEntry=function(t){var n=this.docs.get(t);n&&(this.docs=this.docs.remove(t),this.size-=n.size)},e.prototype.getEntry=function(t,n){var r=this.docs.get(n);return E.resolve(r?r.document.clone():dt.newInvalidDocument(n))},e.prototype.getEntries=function(t,n){var r=this,i=Ft();return n.forEach(function(o){var s=r.docs.get(o);i=i.insert(o,s?s.document.clone():dt.newInvalidDocument(o))}),E.resolve(i)},e.prototype.getDocumentsMatchingQuery=function(t,n,r){for(var i=Ft(),o=new C(n.path.child("")),s=this.docs.getIteratorFrom(o);s.hasNext();){var u=s.getNext(),a=u.key,c=u.value,h=c.document,l=c.readTime;if(!n.path.isPrefixOf(a.path))break;l.compareTo(r)<=0||lr(n,h)&&(i=i.insert(h.key,h.clone()))}return E.resolve(i)},e.prototype.fs=function(t,n){return E.forEach(this.docs,function(r){return n(r)})},e.prototype.newChangeBuffer=function(t){return new rg(this)},e.prototype.getSize=function(t){return E.resolve(this.size)},e}(),rg=function(e){function t(n){var r=this;return(r=e.call(this)||this).Ie=n,r}return x(t,e),t.prototype.applyChanges=function(n){var r=this,i=[];return this.changes.forEach(function(o,s){s.document.isValidDocument()?i.push(r.Ie.addEntry(n,s.document,r.getReadTime(o))):r.Ie.removeEntry(o)}),E.waitFor(i)},t.prototype.getFromCache=function(n,r){return this.Ie.getEntry(n,r)},t.prototype.getAllFromCache=function(n,r){return this.Ie.getEntries(n,r)},t}(Eh),ig=function(){function e(t){this.persistence=t,this.ds=new wn(function(n){return ar(n)},Ii),this.lastRemoteSnapshotVersion=P.min(),this.highestTargetId=0,this.ws=0,this._s=new Is,this.targetCount=0,this.ys=Zr.Jt()}return e.prototype.forEachTarget=function(t,n){return this.ds.forEach(function(r,i){return n(i)}),E.resolve()},e.prototype.getLastRemoteSnapshotVersion=function(t){return E.resolve(this.lastRemoteSnapshotVersion)},e.prototype.getHighestSequenceNumber=function(t){return E.resolve(this.ws)},e.prototype.allocateTargetId=function(t){return this.highestTargetId=this.ys.next(),E.resolve(this.highestTargetId)},e.prototype.setTargetsMetadata=function(t,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.ws&&(this.ws=n),E.resolve()},e.prototype.te=function(t){this.ds.set(t.target,t);var n=t.targetId;n>this.highestTargetId&&(this.ys=new Zr(n),this.highestTargetId=n),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},e.prototype.addTargetData=function(t,n){return this.te(n),this.targetCount+=1,E.resolve()},e.prototype.updateTargetData=function(t,n){return this.te(n),E.resolve()},e.prototype.removeTargetData=function(t,n){return this.ds.delete(n.target),this._s.Zn(n.targetId),this.targetCount-=1,E.resolve()},e.prototype.removeTargets=function(t,n,r){var i=this,o=0,s=[];return this.ds.forEach(function(u,a){a.sequenceNumber<=n&&r.get(a.targetId)===null&&(i.ds.delete(u),s.push(i.removeMatchingKeysForTargetId(t,a.targetId)),o++)}),E.waitFor(s).next(function(){return o})},e.prototype.getTargetCount=function(t){return E.resolve(this.targetCount)},e.prototype.getTargetData=function(t,n){var r=this.ds.get(n)||null;return E.resolve(r)},e.prototype.addMatchingKeys=function(t,n,r){return this._s.Jn(n,r),E.resolve()},e.prototype.removeMatchingKeys=function(t,n,r){this._s.Xn(n,r);var i=this.persistence.referenceDelegate,o=[];return i&&n.forEach(function(s){o.push(i.markPotentiallyOrphaned(t,s))}),E.waitFor(o)},e.prototype.removeMatchingKeysForTargetId=function(t,n){return this._s.Zn(n),E.resolve()},e.prototype.getMatchingKeysForTargetId=function(t,n){var r=this._s.es(n);return E.resolve(r)},e.prototype.containsKey=function(t,n){return E.resolve(this._s.containsKey(n))},e}(),og=function(){function e(t,n){var r=this;this.gs={},this.Ne=new xt(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new ig(this),this.Ut=new Ld,this.Ue=function(i,o){return new ng(i,function(s){return r.referenceDelegate.ps(s)})}(this.Ut),this.R=new dh(n),this.Ke=new tg(this.R)}return e.prototype.start=function(){return Promise.resolve()},e.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(e.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),e.prototype.setDatabaseDeletedListener=function(){},e.prototype.setNetworkEnabled=function(){},e.prototype.getIndexManager=function(){return this.Ut},e.prototype.getMutationQueue=function(t){var n=this.gs[t.toKey()];return n||(n=new eg(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=n),n},e.prototype.getTargetCache=function(){return this.qe},e.prototype.getRemoteDocumentCache=function(){return this.Ue},e.prototype.getBundleCache=function(){return this.Ke},e.prototype.runTransaction=function(t,n,r){var i=this;T("MemoryPersistence","Starting transaction:",t);var o=new sg(this.Ne.next());return this.referenceDelegate.Es(),r(o).next(function(s){return i.referenceDelegate.Ts(o).next(function(){return s})}).toPromise().then(function(s){return o.raiseOnCommittedEvent(),s})},e.prototype.Is=function(t,n){return E.or(Object.values(this.gs).map(function(r){return function(){return r.containsKey(t,n)}}))},e}(),sg=function(e){function t(n){var r=this;return(r=e.call(this)||this).currentSequenceNumber=n,r}return x(t,e),t}(fh),ug=function(){function e(t){this.persistence=t,this.As=new Is,this.Rs=null}return e.bs=function(t){return new e(t)},Object.defineProperty(e.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw D()},enumerable:!1,configurable:!0}),e.prototype.addReference=function(t,n,r){return this.As.addReference(r,n),this.vs.delete(r.toString()),E.resolve()},e.prototype.removeReference=function(t,n,r){return this.As.removeReference(r,n),this.vs.add(r.toString()),E.resolve()},e.prototype.markPotentiallyOrphaned=function(t,n){return this.vs.add(n.toString()),E.resolve()},e.prototype.removeTarget=function(t,n){var r=this;this.As.Zn(n.targetId).forEach(function(o){return r.vs.add(o.toString())});var i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(t,n.targetId).next(function(o){o.forEach(function(s){return r.vs.add(s.toString())})}).next(function(){return i.removeTargetData(t,n)})},e.prototype.Es=function(){this.Rs=new Set},e.prototype.Ts=function(t){var n=this,r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return E.forEach(this.vs,function(i){var o=C.fromPath(i);return n.Ps(t,o).next(function(s){s||r.removeEntry(o)})}).next(function(){return n.Rs=null,r.apply(t)})},e.prototype.updateLimboDocument=function(t,n){var r=this;return this.Ps(t,n).next(function(i){i?r.vs.delete(n.toString()):r.vs.add(n.toString())})},e.prototype.ps=function(t){return 0},e.prototype.Ps=function(t,n){var r=this;return E.or([function(){return E.resolve(r.As.containsKey(n))},function(){return r.persistence.getTargetCache().containsKey(t,n)},function(){return r.persistence.Is(t,n)}])},e}(),it=function(){function e(t){this.uid=t}return e.prototype.isAuthenticated=function(){return this.uid!=null},e.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},e.prototype.isEqual=function(t){return t.uid===this.uid},e}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wu(e,t){return"firestore_clients_"+e+"_"+t}function Yu(e,t,n){var r="firestore_mutations_"+e+"_"+n;return t.isAuthenticated()&&(r+="_"+t.uid),r}function Ji(e,t){return"firestore_targets_"+e+"_"+t}it.UNAUTHENTICATED=new it(null),it.GOOGLE_CREDENTIALS=new it("google-credentials-uid"),it.FIRST_PARTY=new it("first-party-uid"),it.MOCK_USER=new it("mock-user");var Xu=function(){function e(t,n,r,i){this.user=t,this.batchId=n,this.state=r,this.error=i}return e.Vs=function(t,n,r){var i,o=JSON.parse(r),s=typeof o=="object"&&["pending","acknowledged","rejected"].indexOf(o.state)!==-1&&(o.error===void 0||typeof o.error=="object");return s&&o.error&&(s=typeof o.error.message=="string"&&typeof o.error.code=="string")&&(i=new w(o.error.code,o.error.message)),s?new e(t,n,o.state,i):(Y("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},e.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},e}(),Zi=function(){function e(t,n,r){this.targetId=t,this.state=n,this.error=r}return e.Vs=function(t,n){var r,i=JSON.parse(n),o=typeof i=="object"&&["not-current","current","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string")&&(r=new w(i.error.code,i.error.message)),o?new e(t,i.state,r):(Y("SharedClientState","Failed to parse target state for ID '"+t+"': "+n),null)},e.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},e}(),Ju=function(){function e(t,n){this.clientId=t,this.activeTargetIds=n}return e.Vs=function(t,n){for(var r=JSON.parse(n),i=typeof r=="object"&&r.activeTargetIds instanceof Array,o=Si(),s=0;i&&s<r.activeTargetIds.length;++s)i=Mc(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new e(t,o):(Y("SharedClientState","Failed to parse client data for instance '"+t+"': "+n),null)},e}(),ag=function(){function e(t,n){this.clientId=t,this.onlineState=n}return e.Vs=function(t){var n=JSON.parse(t);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new e(n.clientId,n.onlineState):(Y("SharedClientState","Failed to parse online state: "+t),null)},e}(),Ao=function(){function e(){this.activeTargetIds=Si()}return e.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},e.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},e.prototype.Ss=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},e}(),to=function(){function e(t,n,r,i,o){this.window=t,this.Se=n,this.persistenceKey=r,this.Ns=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.ks.bind(this),this.Fs=new gt(L),this.started=!1,this.$s=[];var s=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.Os=Wu(this.persistenceKey,this.Ns),this.Ms=function(u){return"firestore_sequence_number_"+u}(this.persistenceKey),this.Fs=this.Fs.insert(this.Ns,new Ao),this.Ls=new RegExp("^firestore_clients_"+s+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+s+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+s+"_(\\d+)$"),this.Us=function(u){return"firestore_online_state_"+u}(this.persistenceKey),this.Ks=function(u){return"firestore_bundle_loaded_"+u}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}return e.yt=function(t){return!(!t||!t.localStorage)},e.prototype.start=function(){return m(this,void 0,void 0,function(){var t,n,r,i,o,s,u,a,c,h,l,f=this;return y(this,function(p){switch(p.label){case 0:return[4,this.syncEngine.fn()];case 1:for(t=p.sent(),n=0,r=t;n<r.length;n++)(i=r[n])!==this.Ns&&(o=this.getItem(Wu(this.persistenceKey,i)))&&(s=Ju.Vs(i,o))&&(this.Fs=this.Fs.insert(s.clientId,s));for(this.Qs(),(u=this.storage.getItem(this.Us))&&(a=this.js(u))&&this.Ws(a),c=0,h=this.$s;c<h.length;c++)l=h[c],this.ks(l);return this.$s=[],this.window.addEventListener("pagehide",function(){return f.shutdown()}),this.started=!0,[2]}})})},e.prototype.writeSequenceNumber=function(t){this.setItem(this.Ms,JSON.stringify(t))},e.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.Fs)},e.prototype.isActiveQueryTarget=function(t){var n=!1;return this.Fs.forEach(function(r,i){i.activeTargetIds.has(t)&&(n=!0)}),n},e.prototype.addPendingMutation=function(t){this.zs(t,"pending")},e.prototype.updateMutationState=function(t,n,r){this.zs(t,n,r),this.Hs(t)},e.prototype.addLocalQueryTarget=function(t){var n="not-current";if(this.isActiveQueryTarget(t)){var r=this.storage.getItem(Ji(this.persistenceKey,t));if(r){var i=Zi.Vs(t,r);i&&(n=i.state)}}return this.Js.Ds(t),this.Qs(),n},e.prototype.removeLocalQueryTarget=function(t){this.Js.Cs(t),this.Qs()},e.prototype.isLocalQueryTarget=function(t){return this.Js.activeTargetIds.has(t)},e.prototype.clearQueryState=function(t){this.removeItem(Ji(this.persistenceKey,t))},e.prototype.updateQueryState=function(t,n,r){this.Ys(t,n,r)},e.prototype.handleUserChange=function(t,n,r){var i=this;n.forEach(function(o){i.Hs(o)}),this.currentUser=t,r.forEach(function(o){i.addPendingMutation(o)})},e.prototype.setOnlineState=function(t){this.Xs(t)},e.prototype.notifyBundleLoaded=function(){this.Zs()},e.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Os),this.started=!1)},e.prototype.getItem=function(t){var n=this.storage.getItem(t);return T("SharedClientState","READ",t,n),n},e.prototype.setItem=function(t,n){T("SharedClientState","SET",t,n),this.storage.setItem(t,n)},e.prototype.removeItem=function(t){T("SharedClientState","REMOVE",t),this.storage.removeItem(t)},e.prototype.ks=function(t){var n=this,r=t;if(r.storageArea===this.storage){if(T("SharedClientState","EVENT",r.key,r.newValue),r.key===this.Os)return void Y("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable(function(){return m(n,void 0,void 0,function(){var i,o,s,u,a,c;return y(this,function(h){if(this.started){if(r.key!==null){if(this.Ls.test(r.key)){if(r.newValue==null)return i=this.ti(r.key),[2,this.ei(i,null)];if(o=this.ni(r.key,r.newValue))return[2,this.ei(o.clientId,o)]}else if(this.Bs.test(r.key)){if(r.newValue!==null&&(s=this.si(r.key,r.newValue)))return[2,this.ii(s)]}else if(this.qs.test(r.key)){if(r.newValue!==null&&(u=this.ri(r.key,r.newValue)))return[2,this.oi(u)]}else if(r.key===this.Us){if(r.newValue!==null&&(a=this.js(r.newValue)))return[2,this.Ws(a)]}else if(r.key===this.Ms)(c=function(l){var f=xt.o;if(l!=null)try{var p=JSON.parse(l);k(typeof p=="number"),f=p}catch(d){Y("SharedClientState","Failed to read sequence number from WebStorage",d)}return f}(r.newValue))!==xt.o&&this.sequenceNumberHandler(c);else if(r.key===this.Ks)return[2,this.syncEngine.ci()]}}else this.$s.push(r);return[2]})})})}},Object.defineProperty(e.prototype,"Js",{get:function(){return this.Fs.get(this.Ns)},enumerable:!1,configurable:!0}),e.prototype.Qs=function(){this.setItem(this.Os,this.Js.Ss())},e.prototype.zs=function(t,n,r){var i=new Xu(this.currentUser,t,n,r),o=Yu(this.persistenceKey,this.currentUser,t);this.setItem(o,i.Ss())},e.prototype.Hs=function(t){var n=Yu(this.persistenceKey,this.currentUser,t);this.removeItem(n)},e.prototype.Xs=function(t){var n={clientId:this.Ns,onlineState:t};this.storage.setItem(this.Us,JSON.stringify(n))},e.prototype.Ys=function(t,n,r){var i=Ji(this.persistenceKey,t),o=new Zi(t,n,r);this.setItem(i,o.Ss())},e.prototype.Zs=function(){this.setItem(this.Ks,"value-not-used")},e.prototype.ti=function(t){var n=this.Ls.exec(t);return n?n[1]:null},e.prototype.ni=function(t,n){var r=this.ti(t);return Ju.Vs(r,n)},e.prototype.si=function(t,n){var r=this.Bs.exec(t),i=Number(r[1]),o=r[2]!==void 0?r[2]:null;return Xu.Vs(new it(o),i,n)},e.prototype.ri=function(t,n){var r=this.qs.exec(t),i=Number(r[1]);return Zi.Vs(i,n)},e.prototype.js=function(t){return ag.Vs(t)},e.prototype.ii=function(t){return m(this,void 0,void 0,function(){return y(this,function(n){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(t.batchId,t.state,t.error)]:(T("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])})})},e.prototype.oi=function(t){return this.syncEngine.ai(t.targetId,t.state,t.error)},e.prototype.ei=function(t,n){var r=this,i=n?this.Fs.insert(t,n):this.Fs.remove(t),o=this.Gs(this.Fs),s=this.Gs(i),u=[],a=[];return s.forEach(function(c){o.has(c)||u.push(c)}),o.forEach(function(c){s.has(c)||a.push(c)}),this.syncEngine.hi(u,a).then(function(){r.Fs=i})},e.prototype.Ws=function(t){this.Fs.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},e.prototype.Gs=function(t){var n=Si();return t.forEach(function(r,i){n=n.unionWith(i.activeTargetIds)}),n},e}(),Ch=function(){function e(){this.li=new Ao,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return e.prototype.addPendingMutation=function(t){},e.prototype.updateMutationState=function(t,n,r){},e.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||"not-current"},e.prototype.updateQueryState=function(t,n,r){this.fi[t]=n},e.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},e.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},e.prototype.clearQueryState=function(t){delete this.fi[t]},e.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},e.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},e.prototype.start=function(){return this.li=new Ao,Promise.resolve()},e.prototype.handleUserChange=function(t,n,r){},e.prototype.setOnlineState=function(t){},e.prototype.shutdown=function(){},e.prototype.writeSequenceNumber=function(t){},e.prototype.notifyBundleLoaded=function(){},e}(),cg=function(){function e(){}return e.prototype.di=function(t){},e.prototype.shutdown=function(){},e}(),Zu=function(){function e(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}return e.prototype.di=function(t){this.gi.push(t)},e.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},e.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},e.prototype._i=function(){T("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,n=this.gi;t<n.length;t++)(0,n[t])(0)},e.prototype.yi=function(){T("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,n=this.gi;t<n.length;t++)(0,n[t])(1)},e.yt=function(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0},e}(),hg={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},lg=function(){function e(t){this.Ei=t.Ei,this.Ti=t.Ti}return e.prototype.Ii=function(t){this.Ai=t},e.prototype.Ri=function(t){this.bi=t},e.prototype.onMessage=function(t){this.vi=t},e.prototype.close=function(){this.Ti()},e.prototype.send=function(t){this.Ei(t)},e.prototype.Pi=function(){this.Ai()},e.prototype.Vi=function(t){this.bi(t)},e.prototype.Si=function(t){this.vi(t)},e}(),fg=function(e){function t(n){var r=this;return(r=e.call(this,n)||this).forceLongPolling=n.forceLongPolling,r.autoDetectLongPolling=n.autoDetectLongPolling,r.useFetchStreams=n.useFetchStreams,r}return x(t,e),t.prototype.Fi=function(n,r,i,o){return new Promise(function(s,u){var a=new Kp;a.listenOnce(qp.COMPLETE,function(){try{switch(a.getLastErrorCode()){case Yi.NO_ERROR:var h=a.getResponseJson();T("Connection","XHR received:",JSON.stringify(h)),s(h);break;case Yi.TIMEOUT:T("Connection",'RPC "'+n+'" timed out'),u(new w(g.DEADLINE_EXCEEDED,"Request time out"));break;case Yi.HTTP_ERROR:var l=a.getStatus();if(T("Connection",'RPC "'+n+'" failed with status:',l,"response text:",a.getResponseText()),l>0){var f=a.getResponseJson().error;if(f&&f.status&&f.message){var p=function(d){var v=d.toLowerCase().replace(/_/g,"-");return Object.values(g).indexOf(v)>=0?v:g.UNKNOWN}(f.status);u(new w(p,f.message))}else u(new w(g.UNKNOWN,"Server responded with status "+a.getStatus()))}else u(new w(g.UNAVAILABLE,"Connection failed."));break;default:D()}}finally{T("Connection",'RPC "'+n+'" completed.')}});var c=JSON.stringify(o);a.send(r,"POST",c,i,15)})},t.prototype.Oi=function(n,r){var i=[this.Di,"/","google.firestore.v1.Firestore","/",n,"/channel"],o=Vp(),s=Up(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(u.xmlHttpFactory=new jp({})),this.ki(u.initMessageHeaders,r),Gl()||Ql()||Wl()||Yl()||Xl()||Hl()||(u.httpHeadersOverwriteParam="$httpHeaders");var a=i.join("");T("Connection","Creating WebChannel: "+a,u);var c=o.createWebChannel(a,u),h=!1,l=!1,f=new lg({Ei:function(d){l?T("Connection","Not sending because WebChannel is closed:",d):(h||(T("Connection","Opening WebChannel transport."),c.open(),h=!0),T("Connection","WebChannel sending:",d),c.send(d))},Ti:function(){return c.close()}}),p=function(d,v,b){d.listen(v,function(I){try{b(I)}catch(N){setTimeout(function(){throw N},0)}})};return p(c,Ir.EventType.OPEN,function(){l||T("Connection","WebChannel transport opened.")}),p(c,Ir.EventType.CLOSE,function(){l||(l=!0,T("Connection","WebChannel transport closed"),f.Vi())}),p(c,Ir.EventType.ERROR,function(d){l||(l=!0,Gr("Connection","WebChannel transport errored:",d),f.Vi(new w(g.UNAVAILABLE,"The operation could not be completed")))}),p(c,Ir.EventType.MESSAGE,function(d){var v;if(!l){var b=d.data[0];k(!!b);var I=b,N=I.error||((v=I[0])===null||v===void 0?void 0:v.error);if(N){T("Connection","WebChannel received error:",N);var A=N.status,O=function(B){var rt=Q[B];if(rt!==void 0)return Zc(rt)}(A),F=N.message;O===void 0&&(O=g.INTERNAL,F="Unknown error status: "+A+" with message "+N.message),l=!0,f.Vi(new w(O,F)),c.close()}else T("Connection","WebChannel received:",b),f.Si(b)}}),p(s,Bp.STAT_EVENT,function(d){d.stat===vu.PROXY?T("Connection","Detected buffering proxy"):d.stat===vu.NOPROXY&&T("Connection","Detected no buffering proxy")}),setTimeout(function(){f.Pi()},0),f},t}(function(){function e(t){this.databaseInfo=t,this.databaseId=t.databaseId;var n=t.ssl?"https":"http";this.Di=n+"://"+t.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return e.prototype.Ni=function(t,n,r,i){var o=this.xi(t,n);T("RestConnection","Sending: ",o,r);var s={};return this.ki(s,i),this.Fi(t,o,s,r).then(function(u){return T("RestConnection","Received: ",u),u},function(u){throw Gr("RestConnection",t+" failed with error: ",u,"url: ",o,"request:",r),u})},e.prototype.$i=function(t,n,r,i){return this.Ni(t,n,r,i)},e.prototype.ki=function(t,n){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.10.1",t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),n)for(var r in n.authHeaders)n.authHeaders.hasOwnProperty(r)&&(t[r]=n.authHeaders[r])},e.prototype.xi=function(t,n){var r=hg[t];return this.Di+"/v1/"+n+":"+r},e}());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xh(){return typeof window<"u"?window:null}function Or(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ni(e){return new md(e,!0)}var Ts=function(){function e(t,n,r,i,o){r===void 0&&(r=1e3),i===void 0&&(i=1.5),o===void 0&&(o=6e4),this.Se=t,this.timerId=n,this.Mi=r,this.Li=i,this.Bi=o,this.qi=0,this.Ui=null,this.Ki=Date.now(),this.reset()}return e.prototype.reset=function(){this.qi=0},e.prototype.Qi=function(){this.qi=this.Bi},e.prototype.ji=function(t){var n=this;this.cancel();var r=Math.floor(this.qi+this.Wi()),i=Math.max(0,Date.now()-this.Ki),o=Math.max(0,r-i);o>0&&T("ExponentialBackoff","Backing off for "+o+" ms (base delay: "+this.qi+" ms, delay with jitter: "+r+" ms, last attempt: "+i+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,o,function(){return n.Ki=Date.now(),t()}),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},e.prototype.Gi=function(){this.Ui!==null&&(this.Ui.skipDelay(),this.Ui=null)},e.prototype.cancel=function(){this.Ui!==null&&(this.Ui.cancel(),this.Ui=null)},e.prototype.Wi=function(){return(Math.random()-.5)*this.qi},e}(),kh=function(){function e(t,n,r,i,o,s){this.Se=t,this.zi=r,this.Hi=i,this.Ji=o,this.listener=s,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new Ts(t,n)}return e.prototype.tr=function(){return this.state===1||this.state===2||this.state===4},e.prototype.er=function(){return this.state===2},e.prototype.start=function(){this.state!==3?this.auth():this.nr()},e.prototype.stop=function(){return m(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},e.prototype.sr=function(){this.state=0,this.Zi.reset()},e.prototype.ir=function(){var t=this;this.er()&&this.Xi===null&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,function(){return t.rr()}))},e.prototype.cr=function(t){this.ur(),this.stream.send(t)},e.prototype.rr=function(){return m(this,void 0,void 0,function(){return y(this,function(t){return this.er()?[2,this.close(0)]:[2]})})},e.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},e.prototype.close=function(t,n){return m(this,void 0,void 0,function(){return y(this,function(r){switch(r.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,t!==3?this.Zi.reset():n&&n.code===g.RESOURCE_EXHAUSTED?(Y(n.toString()),Y("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Qi()):n&&n.code===g.UNAUTHENTICATED&&this.Ji.invalidateToken(),this.stream!==null&&(this.ar(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ri(n)];case 1:return r.sent(),[2]}})})},e.prototype.ar=function(){},e.prototype.auth=function(){var t=this;this.state=1;var n=this.hr(this.Yi),r=this.Yi;this.Ji.getToken().then(function(i){t.Yi===r&&t.lr(i)},function(i){n(function(){var o=new w(g.UNKNOWN,"Fetching auth token failed: "+i.message);return t.dr(o)})})},e.prototype.lr=function(t){var n=this,r=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii(function(){r(function(){return n.state=2,n.listener.Ii()})}),this.stream.Ri(function(i){r(function(){return n.dr(i)})}),this.stream.onMessage(function(i){r(function(){return n.onMessage(i)})})},e.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji(function(){return m(t,void 0,void 0,function(){return y(this,function(n){return this.state=0,this.start(),[2]})})})},e.prototype.dr=function(t){return T("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},e.prototype.hr=function(t){var n=this;return function(r){n.Se.enqueueAndForget(function(){return n.Yi===t?r():(T("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},e}(),pg=function(e){function t(n,r,i,o,s){var u=this;return(u=e.call(this,n,"listen_stream_connection_backoff","listen_stream_idle",r,i,s)||this).R=o,u}return x(t,e),t.prototype.wr=function(n){return this.Hi.Oi("Listen",n)},t.prototype.onMessage=function(n){this.Zi.reset();var r=function(o,s){var u;if("targetChange"in s){s.targetChange;var a=function(b){return b==="NO_CHANGE"?0:b==="ADD"?1:b==="REMOVE"?2:b==="CURRENT"?3:b==="RESET"?4:D()}(s.targetChange.targetChangeType||"NO_CHANGE"),c=s.targetChange.targetIds||[],h=function(b,I){return b.I?(k(I===void 0||typeof I=="string"),_t.fromBase64String(I||"")):(k(I===void 0||I instanceof Uint8Array),_t.fromUint8Array(I||new Uint8Array))}(o,s.targetChange.resumeToken),l=(f=s.targetChange.cause)&&function(b){var I=b.code===void 0?g.UNKNOWN:Zc(b.code);return new w(I,b.message||"")}(f);u=new eh(a,c,h,l||null)}else if("documentChange"in s){s.documentChange,(a=s.documentChange).document,a.document.name,a.document.updateTime,c=Ht(o,a.document.name),h=Et(a.document.updateTime);var f=new Ct({mapValue:{fields:a.document.fields}}),p=(l=dt.newFoundDocument(c,h,f),a.targetIds||[]),d=a.removedTargetIds||[];u=new Rr(p,d,l.key,l)}else if("documentDelete"in s)s.documentDelete,(a=s.documentDelete).document,c=Ht(o,a.document),h=a.readTime?Et(a.readTime):P.min(),f=dt.newNoDocument(c,h),l=a.removedTargetIds||[],u=new Rr([],l,f.key,f);else if("documentRemove"in s)s.documentRemove,(a=s.documentRemove).document,c=Ht(o,a.document),h=a.removedTargetIds||[],u=new Rr([],h,c,null);else{if(!("filter"in s))return D();s.filter;var v=s.filter;v.targetId,a=v.count||0,c=new ad(a),h=v.targetId,u=new th(h,c)}return u}(this.R,n),i=function(o){if(!("targetChange"in o))return P.min();var s=o.targetChange;return s.targetIds&&s.targetIds.length?P.min():s.readTime?Et(s.readTime):P.min()}(n);return this.listener._r(r,i)},t.prototype.mr=function(n){var r={};r.database=Hn(this.R),r.addTarget=function(o,s){var u,a=s.target;return(u=Qr(a)?{documents:sh(o,a)}:{query:uh(o,a)}).targetId=s.targetId,s.resumeToken.approximateByteSize()>0?u.resumeToken=nh(o,s.resumeToken):s.snapshotVersion.compareTo(P.min())>0&&(u.readTime=Gn(o,s.snapshotVersion.toTimestamp())),u}(this.R,n);var i=function(o,s){var u=function(a,c){switch(c){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return D()}}(0,s.purpose);return u==null?null:{"goog-listen-tags":u}}(this.R,n);i&&(r.labels=i),this.cr(r)},t.prototype.yr=function(n){var r={};r.database=Hn(this.R),r.removeTarget=n,this.cr(r)},t}(kh),dg=function(e){function t(n,r,i,o,s){var u=this;return(u=e.call(this,n,"write_stream_connection_backoff","write_stream_idle",r,i,s)||this).R=o,u.gr=!1,u}return x(t,e),Object.defineProperty(t.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),t.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,e.prototype.start.call(this)},t.prototype.ar=function(){this.gr&&this.Er([])},t.prototype.wr=function(n){return this.Hi.Oi("Write",n)},t.prototype.onMessage=function(n){if(k(!!n.streamToken),this.lastStreamToken=n.streamToken,this.gr){this.Zi.reset();var r=function(o,s){return o&&o.length>0?(k(s!==void 0),o.map(function(u){return function(a,c){var h=a.updateTime?Et(a.updateTime):Et(c);return h.isEqual(P.min())&&(h=Et(c)),new od(h,a.transformResults||[])}(u,s)})):[]}(n.writeResults,n.commitTime),i=Et(n.commitTime);return this.listener.Tr(i,r)}return k(!n.writeResults||n.writeResults.length===0),this.gr=!0,this.listener.Ir()},t.prototype.Ar=function(){var n={};n.database=Hn(this.R),this.cr(n)},t.prototype.Er=function(n){var r=this,i={streamToken:this.lastStreamToken,writes:n.map(function(o){return Xr(r.R,o)})};this.cr(i)},t}(kh),gg=function(e){function t(n,r,i){var o=this;return(o=e.call(this)||this).credentials=n,o.Hi=r,o.R=i,o.Rr=!1,o}return x(t,e),t.prototype.br=function(){if(this.Rr)throw new w(g.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.Ni=function(n,r,i){var o=this;return this.br(),this.credentials.getToken().then(function(s){return o.Hi.Ni(n,r,i,s)}).catch(function(s){throw s.name==="FirebaseError"?(s.code===g.UNAUTHENTICATED&&o.credentials.invalidateToken(),s):new w(g.UNKNOWN,s.toString())})},t.prototype.$i=function(n,r,i){var o=this;return this.br(),this.credentials.getToken().then(function(s){return o.Hi.$i(n,r,i,s)}).catch(function(s){throw s.name==="FirebaseError"?(s.code===g.UNAUTHENTICATED&&o.credentials.invalidateToken(),s):new w(g.UNKNOWN,s.toString())})},t.prototype.terminate=function(){this.Rr=!0},t}(function(){}),vg=function(){function e(t,n){this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return e.prototype.Sr=function(){var t=this;this.vr===0&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,function(){return t.Pr=null,t.Cr("Backend didn't respond within 10 seconds."),t.Dr("Offline"),Promise.resolve()}))},e.prototype.Nr=function(t){this.state==="Online"?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.kr(),this.Cr("Connection failed 1 times. Most recent error: "+t.toString()),this.Dr("Offline")))},e.prototype.set=function(t){this.kr(),this.vr=0,t==="Online"&&(this.Vr=!1),this.Dr(t)},e.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},e.prototype.Cr=function(t){var n="Could not reach Cloud Firestore backend. "+t+`
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.Vr?(Y(n),this.Vr=!1):T("OnlineStateTracker",n)},e.prototype.kr=function(){this.Pr!==null&&(this.Pr.cancel(),this.Pr=null)},e}(),yg=function(e,t,n,r,i){var o=this;this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Fr=[],this.$r=new Map,this.Or=new Set,this.Mr=[],this.Lr=i,this.Lr.di(function(s){n.enqueueAndForget(function(){return m(o,void 0,void 0,function(){return y(this,function(u){switch(u.label){case 0:return ge(this)?(T("RemoteStore","Restarting streams for network reachability change."),[4,function(a){return m(this,void 0,void 0,function(){var c;return y(this,function(h){switch(h.label){case 0:return(c=_(a)).Or.add(4),[4,bn(c)];case 1:return h.sent(),c.Br.set("Unknown"),c.Or.delete(4),[4,gr(c)];case 2:return h.sent(),[2]}})})}(this)]):[3,2];case 1:u.sent(),u.label=2;case 2:return[2]}})})})}),this.Br=new vg(n,r)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gr(e){return m(this,void 0,void 0,function(){var t,n;return y(this,function(r){switch(r.label){case 0:if(!ge(e))return[3,4];t=0,n=e.Mr,r.label=1;case 1:return t<n.length?[4,(0,n[t])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return t++,[3,1];case 4:return[2]}})})}function bn(e){return m(this,void 0,void 0,function(){var t,n;return y(this,function(r){switch(r.label){case 0:t=0,n=e.Mr,r.label=1;case 1:return t<n.length?[4,(0,n[t])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return t++,[3,1];case 4:return[2]}})})}function Di(e,t){var n=_(e);n.$r.has(t.targetId)||(n.$r.set(t.targetId,t),As(n)?Ss(n):In(n).er()&&_s(n,t))}function Qn(e,t){var n=_(e),r=In(n);n.$r.delete(t),r.er()&&Rh(n,t),n.$r.size===0&&(r.er()?r.ir():ge(n)&&n.Br.set("Unknown"))}function _s(e,t){e.qr.U(t.targetId),In(e).mr(t)}function Rh(e,t){e.qr.U(t),In(e).yr(t)}function Ss(e){e.qr=new gd({getRemoteKeysForTarget:function(t){return e.remoteSyncer.getRemoteKeysForTarget(t)},lt:function(t){return e.$r.get(t)||null}}),In(e).start(),e.Br.Sr()}function As(e){return ge(e)&&!In(e).tr()&&e.$r.size>0}function ge(e){return _(e).Or.size===0}function Oh(e){e.qr=void 0}function mg(e){return m(this,void 0,void 0,function(){return y(this,function(t){return e.$r.forEach(function(n,r){_s(e,n)}),[2]})})}function wg(e,t){return m(this,void 0,void 0,function(){return y(this,function(n){return Oh(e),As(e)?(e.Br.Nr(t),Ss(e)):e.Br.set("Unknown"),[2]})})}function bg(e,t,n){return m(this,void 0,void 0,function(){var r,i,o;return y(this,function(s){switch(s.label){case 0:if(e.Br.set("Online"),!(t instanceof eh&&t.state===2&&t.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(u,a){return m(this,void 0,void 0,function(){var c,h,l,f;return y(this,function(p){switch(p.label){case 0:c=a.cause,h=0,l=a.targetIds,p.label=1;case 1:return h<l.length?(f=l[h],u.$r.has(f)?[4,u.remoteSyncer.rejectListen(f,c)]:[3,3]):[3,5];case 2:p.sent(),u.$r.delete(f),u.qr.removeTarget(f),p.label=3;case 3:p.label=4;case 4:return h++,[3,1];case 5:return[2]}})})}(e,t)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),T("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),r),[4,ni(e,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(t instanceof Rr?e.qr.X(t):t instanceof th?e.qr.rt(t):e.qr.et(t),n.isEqual(P.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,Ah(e.localStore)];case 8:return i=s.sent(),n.compareTo(i)>=0?[4,function(u,a){var c=u.qr.ut(a);return c.targetChanges.forEach(function(h,l){if(h.resumeToken.approximateByteSize()>0){var f=u.$r.get(l);f&&u.$r.set(l,f.withResumeToken(h.resumeToken,a))}}),c.targetMismatches.forEach(function(h){var l=u.$r.get(h);if(l){u.$r.set(h,l.withResumeToken(_t.EMPTY_BYTE_STRING,l.snapshotVersion)),Rh(u,h);var f=new Ai(l.target,h,1,l.sequenceNumber);_s(u,f)}}),u.remoteSyncer.applyRemoteEvent(c)}(e,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return T("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,ni(e,o)];case 12:return s.sent(),[3,13];case 13:return[2]}})})}function ni(e,t,n){return m(this,void 0,void 0,function(){var r=this;return y(this,function(i){switch(i.label){case 0:if(!Me(t))throw t;return e.Or.add(1),[4,bn(e)];case 1:return i.sent(),e.Br.set("Offline"),n||(n=function(){return Ah(e.localStore)}),e.asyncQueue.enqueueRetryable(function(){return m(r,void 0,void 0,function(){return y(this,function(o){switch(o.label){case 0:return T("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return o.sent(),e.Or.delete(1),[4,gr(e)];case 2:return o.sent(),[2]}})})}),[2]}})})}function Ph(e,t){return t().catch(function(n){return ni(e,n,t)})}function En(e){return m(this,void 0,void 0,function(){var t,n,r,i,o;return y(this,function(s){switch(s.label){case 0:t=_(e),n=he(t),r=t.Fr.length>0?t.Fr[t.Fr.length-1].batchId:-1,s.label=1;case 1:if(!function(u){return ge(u)&&u.Fr.length<10}(t))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,Jd(t.localStore,r)];case 3:return(i=s.sent())===null?(t.Fr.length===0&&n.ir(),[3,7]):(r=i.batchId,function(u,a){u.Fr.push(a);var c=he(u);c.er()&&c.pr&&c.Er(a.mutations)}(t,i),[3,6]);case 4:return o=s.sent(),[4,ni(t,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return Lh(t)&&Fh(t),[2]}})})}function Lh(e){return ge(e)&&!he(e).tr()&&e.Fr.length>0}function Fh(e){he(e).start()}function Eg(e){return m(this,void 0,void 0,function(){return y(this,function(t){return he(e).Ar(),[2]})})}function Ig(e){return m(this,void 0,void 0,function(){var t,n,r,i;return y(this,function(o){for(t=he(e),n=0,r=e.Fr;n<r.length;n++)i=r[n],t.Er(i.mutations);return[2]})})}function Tg(e,t,n){return m(this,void 0,void 0,function(){var r,i;return y(this,function(o){switch(o.label){case 0:return r=e.Fr.shift(),i=Od.from(r,t,n),[4,Ph(e,function(){return e.remoteSyncer.applySuccessfulWrite(i)})];case 1:return o.sent(),[4,En(e)];case 2:return o.sent(),[2]}})})}function _g(e,t){return m(this,void 0,void 0,function(){return y(this,function(n){switch(n.label){case 0:return t&&he(e).pr?[4,function(r,i){return m(this,void 0,void 0,function(){var o,s;return y(this,function(u){switch(u.label){case 0:return Jc(s=i.code)&&s!==g.ABORTED?(o=r.Fr.shift(),he(r).sr(),[4,Ph(r,function(){return r.remoteSyncer.rejectFailedWrite(o.batchId,i)})]):[3,3];case 1:return u.sent(),[4,En(r)];case 2:u.sent(),u.label=3;case 3:return[2]}})})}(e,t)]:[3,2];case 1:n.sent(),n.label=2;case 2:return Lh(e)&&Fh(e),[2]}})})}function No(e,t){return m(this,void 0,void 0,function(){var n;return y(this,function(r){switch(r.label){case 0:return n=_(e),t?(n.Or.delete(2),[4,gr(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return t?[3,4]:(n.Or.add(2),[4,bn(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}})})}function In(e){var t=this;return e.Ur||(e.Ur=function(n,r,i){var o=_(n);return o.br(),new pg(r,o.Hi,o.credentials,o.R,i)}(e.datastore,e.asyncQueue,{Ii:mg.bind(null,e),Ri:wg.bind(null,e),_r:bg.bind(null,e)}),e.Mr.push(function(n){return m(t,void 0,void 0,function(){return y(this,function(r){switch(r.label){case 0:return n?(e.Ur.sr(),As(e)?Ss(e):e.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,e.Ur.stop()];case 2:r.sent(),Oh(e),r.label=3;case 3:return[2]}})})})),e.Ur}function he(e){var t=this;return e.Kr||(e.Kr=function(n,r,i){var o=_(n);return o.br(),new dg(r,o.Hi,o.credentials,o.R,i)}(e.datastore,e.asyncQueue,{Ii:Eg.bind(null,e),Ri:_g.bind(null,e),Ir:Ig.bind(null,e),Tr:Tg.bind(null,e)}),e.Mr.push(function(n){return m(t,void 0,void 0,function(){return y(this,function(r){switch(r.label){case 0:return n?(e.Kr.sr(),[4,En(e)]):[3,2];case 1:return r.sent(),[3,4];case 2:return[4,e.Kr.stop()];case 3:r.sent(),e.Fr.length>0&&(T("RemoteStore","Stopping write stream with "+e.Fr.length+" pending writes"),e.Fr=[]),r.label=4;case 4:return[2]}})})})),e.Kr}var Sg=function(){function e(t,n,r,i,o){this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new St,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(function(s){})}return e.createAndSchedule=function(t,n,r,i,o){var s=new e(t,n,Date.now()+r,i,o);return s.start(r),s},e.prototype.start=function(t){var n=this;this.timerHandle=setTimeout(function(){return n.handleDelayElapsed()},t)},e.prototype.skipDelay=function(){return this.handleDelayElapsed()},e.prototype.cancel=function(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new w(g.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},e.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget(function(){return t.timerHandle!==null?(t.clearTimeout(),t.op().then(function(n){return t.deferred.resolve(n)})):Promise.resolve()})},e.prototype.clearTimeout=function(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},e}();function Tn(e,t){if(Y("AsyncQueue",t+": "+e),Me(e))return new w(g.UNAVAILABLE,t+": "+e);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Mh=function(){function e(t){this.comparator=t?function(n,r){return t(n,r)||C.comparator(n.key,r.key)}:function(n,r){return C.comparator(n.key,r.key)},this.keyedMap=To(),this.sortedSet=new gt(this.comparator)}return e.emptySet=function(t){return new e(t.comparator)},e.prototype.has=function(t){return this.keyedMap.get(t)!=null},e.prototype.get=function(t){return this.keyedMap.get(t)},e.prototype.first=function(){return this.sortedSet.minKey()},e.prototype.last=function(){return this.sortedSet.maxKey()},e.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},e.prototype.indexOf=function(t){var n=this.keyedMap.get(t);return n?this.sortedSet.indexOf(n):-1},Object.defineProperty(e.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),e.prototype.forEach=function(t){this.sortedSet.inorderTraversal(function(n,r){return t(n),!1})},e.prototype.add=function(t){var n=this.delete(t.key);return n.copy(n.keyedMap.insert(t.key,t),n.sortedSet.insert(t,null))},e.prototype.delete=function(t){var n=this.get(t);return n?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(n)):this},e.prototype.isEqual=function(t){if(!(t instanceof e)||this.size!==t.size)return!1;for(var n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},e.prototype.toString=function(){var t=[];return this.forEach(function(n){t.push(n.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`},e.prototype.copy=function(t,n){var r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r},e}(),ta=function(){function e(){this.Qr=new gt(C.comparator)}return e.prototype.track=function(t){var n=t.doc.key,r=this.Qr.get(n);r?t.type!==0&&r.type===3?this.Qr=this.Qr.insert(n,t):t.type===3&&r.type!==1?this.Qr=this.Qr.insert(n,{type:r.type,doc:t.doc}):t.type===2&&r.type===2?this.Qr=this.Qr.insert(n,{type:2,doc:t.doc}):t.type===2&&r.type===0?this.Qr=this.Qr.insert(n,{type:0,doc:t.doc}):t.type===1&&r.type===0?this.Qr=this.Qr.remove(n):t.type===1&&r.type===2?this.Qr=this.Qr.insert(n,{type:1,doc:r.doc}):t.type===0&&r.type===1?this.Qr=this.Qr.insert(n,{type:2,doc:t.doc}):D():this.Qr=this.Qr.insert(n,t)},e.prototype.jr=function(){var t=[];return this.Qr.inorderTraversal(function(n,r){t.push(r)}),t},e}(),ri=function(){function e(t,n,r,i,o,s,u,a){this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=u,this.excludesMetadataChanges=a}return e.fromInitialDocuments=function(t,n,r,i){var o=[];return n.forEach(function(s){o.push({type:0,doc:s})}),new e(t,n,Mh.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&hr(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var n=this.docChanges,r=t.docChanges;if(n.length!==r.length)return!1;for(var i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0},e}(),Ag=function(){this.Wr=void 0,this.listeners=[]},Ng=function(){this.queries=new wn(function(e){return jc(e)},hr),this.onlineState="Unknown",this.Gr=new Set};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ns(e,t){return m(this,void 0,void 0,function(){var n,r,i,o,s,u,a;return y(this,function(c){switch(c.label){case 0:if(n=_(e),r=t.query,i=!1,(o=n.queries.get(r))||(i=!0,o=new Ag),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.onListen(r)];case 2:return s.Wr=c.sent(),[3,4];case 3:return u=c.sent(),a=Tn(u,"Initialization of query '"+Eo(t.query)+"' failed"),[2,void t.onError(a)];case 4:return n.queries.set(r,o),o.listeners.push(t),t.zr(n.onlineState),o.Wr&&t.Hr(o.Wr)&&Cs(n),[2]}})})}function Ds(e,t){return m(this,void 0,void 0,function(){var n,r,i,o,s;return y(this,function(u){return n=_(e),r=t.query,i=!1,(o=n.queries.get(r))&&(s=o.listeners.indexOf(t))>=0&&(o.listeners.splice(s,1),i=o.listeners.length===0),i?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]})})}function Dg(e,t){for(var n=_(e),r=!1,i=0,o=t;i<o.length;i++){var s=o[i],u=s.query,a=n.queries.get(u);if(a){for(var c=0,h=a.listeners;c<h.length;c++)h[c].Hr(s)&&(r=!0);a.Wr=s}}r&&Cs(n)}function Cg(e,t,n){var r=_(e),i=r.queries.get(t);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(t)}function Cs(e){e.Gr.forEach(function(t){t.next()})}var xs=function(){function e(t,n,r){this.query=t,this.Jr=n,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=r||{}}return e.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var n=[],r=0,i=t.docChanges;r<i.length;r++){var o=i[r];o.type!==3&&n.push(o)}t=new ri(t.query,t.docs,t.oldDocs,n,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var s=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),s=!0):this.eo(t,this.onlineState)&&(this.no(t),s=!0),this.Xr=t,s},e.prototype.onError=function(t){this.Jr.error(t)},e.prototype.zr=function(t){this.onlineState=t;var n=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),n=!0),n},e.prototype.eo=function(t,n){if(!t.fromCache)return!0;var r=n!=="Offline";return!(this.options.so&&r||t.docs.isEmpty()&&n!=="Offline")},e.prototype.Zr=function(t){if(t.docChanges.length>0)return!0;var n=this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0},e.prototype.no=function(t){t=ri.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},e}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Vh=function(e){this.key=e},Uh=function(e){this.key=e},qh=function(){function e(t,n){this.query=t,this.uo=n,this.ao=null,this.current=!1,this.ho=j(),this.mutatedKeys=j(),this.lo=Kc(t),this.fo=new Mh(this.lo)}return Object.defineProperty(e.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),e.prototype._o=function(t,n){var r=this,i=n?n.mo:new ta,o=n?n.fo:this.fo,s=n?n.mutatedKeys:this.mutatedKeys,u=o,a=!1,c=xr(this.query)&&o.size===this.query.limit?o.last():null,h=Yr(this.query)&&o.size===this.query.limit?o.first():null;if(t.inorderTraversal(function(f,p){var d=o.get(f),v=lr(r.query,p)?p:null,b=!!d&&r.mutatedKeys.has(d.key),I=!!v&&(v.hasLocalMutations||r.mutatedKeys.has(v.key)&&v.hasCommittedMutations),N=!1;d&&v?d.data.isEqual(v.data)?b!==I&&(i.track({type:3,doc:v}),N=!0):r.yo(d,v)||(i.track({type:2,doc:v}),N=!0,(c&&r.lo(v,c)>0||h&&r.lo(v,h)<0)&&(a=!0)):!d&&v?(i.track({type:0,doc:v}),N=!0):d&&!v&&(i.track({type:1,doc:d}),N=!0,(c||h)&&(a=!0)),N&&(v?(u=u.add(v),s=I?s.add(f):s.delete(f)):(u=u.delete(f),s=s.delete(f)))}),xr(this.query)||Yr(this.query))for(;u.size>this.query.limit;){var l=xr(this.query)?u.last():u.first();u=u.delete(l.key),s=s.delete(l.key),i.track({type:1,doc:l})}return{fo:u,mo:i,Nn:a,mutatedKeys:s}},e.prototype.yo=function(t,n){return t.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations},e.prototype.applyChanges=function(t,n,r){var i=this,o=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var s=t.mo.jr();s.sort(function(h,l){return function(f,p){var d=function(v){switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return D()}};return d(f)-d(p)}(h.type,l.type)||i.lo(h.doc,l.doc)}),this.po(r);var u=n?this.Eo():[],a=this.ho.size===0&&this.current?1:0,c=a!==this.ao;return this.ao=a,s.length!==0||c?{snapshot:new ri(this.query,t.fo,o,s,t.mutatedKeys,a===0,c,!1),To:u}:{To:u}},e.prototype.zr=function(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({fo:this.fo,mo:new ta,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},e.prototype.Io=function(t){return!this.uo.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},e.prototype.po=function(t){var n=this;t&&(t.addedDocuments.forEach(function(r){return n.uo=n.uo.add(r)}),t.modifiedDocuments.forEach(function(r){}),t.removedDocuments.forEach(function(r){return n.uo=n.uo.delete(r)}),this.current=t.current)},e.prototype.Eo=function(){var t=this;if(!this.current)return[];var n=this.ho;this.ho=j(),this.fo.forEach(function(i){t.Io(i.key)&&(t.ho=t.ho.add(i.key))});var r=[];return n.forEach(function(i){t.ho.has(i)||r.push(new Uh(i))}),this.ho.forEach(function(i){n.has(i)||r.push(new Vh(i))}),r},e.prototype.Ao=function(t){this.uo=t.Bn,this.ho=j();var n=this._o(t.documents);return this.applyChanges(n,!0)},e.prototype.Ro=function(){return ri.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,this.ao===0)},e}(),xg=function(e,t,n){this.query=e,this.targetId=t,this.view=n},kg=function(e){this.key=e,this.bo=!1},Rg=function(){function e(t,n,r,i,o,s){this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.vo={},this.Po=new wn(function(u){return jc(u)},hr),this.Vo=new Map,this.So=new Set,this.Do=new gt(C.comparator),this.Co=new Map,this.No=new Is,this.xo={},this.ko=new Map,this.Fo=Zr.Yt(),this.onlineState="Unknown",this.$o=void 0}return Object.defineProperty(e.prototype,"isPrimaryClient",{get:function(){return this.$o===!0},enumerable:!1,configurable:!0}),e}();function Og(e,t){return m(this,void 0,void 0,function(){var n,r,i,o,s,u;return y(this,function(a){switch(a.label){case 0:return n=Ls(e),(o=n.Po.get(t))?(r=o.targetId,n.sharedClientState.addLocalQueryTarget(r),i=o.view.Ro(),[3,4]):[3,1];case 1:return[4,ti(n.localStore,Kt(t))];case 2:return s=a.sent(),u=n.sharedClientState.addLocalQueryTarget(s.targetId),r=s.targetId,[4,ks(n,t,r,u==="current")];case 3:i=a.sent(),n.isPrimaryClient&&Di(n.remoteStore,s),a.label=4;case 4:return[2,i]}})})}function ks(e,t,n,r){return m(this,void 0,void 0,function(){var i,o,s,u,a,c;return y(this,function(h){switch(h.label){case 0:return e.Oo=function(l,f,p){return function(d,v,b,I){return m(this,void 0,void 0,function(){var N,A,O;return y(this,function(F){switch(F.label){case 0:return N=v.view._o(b),N.Nn?[4,ei(d.localStore,v.query,!1).then(function(B){var rt=B.documents;return v.view._o(rt,N)})]:[3,2];case 1:N=F.sent(),F.label=2;case 2:return A=I&&I.targetChanges.get(v.targetId),O=v.view.applyChanges(N,d.isPrimaryClient,A),[2,(Do(d,v.targetId,O.To),O.snapshot)]}})})}(e,l,f,p)},[4,ei(e.localStore,t,!0)];case 1:return i=h.sent(),o=new qh(t,i.Bn),s=o._o(i.documents),u=gs.createSynthesizedTargetChangeForCurrentChange(n,r&&e.onlineState!=="Offline"),a=o.applyChanges(s,e.isPrimaryClient,u),Do(e,n,a.To),c=new xg(t,n,o),[2,(e.Po.set(t,c),e.Vo.has(n)?e.Vo.get(n).push(t):e.Vo.set(n,[t]),a.snapshot)]}})})}function Pg(e,t){return m(this,void 0,void 0,function(){var n,r,i;return y(this,function(o){switch(o.label){case 0:return n=_(e),r=n.Po.get(t),(i=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,i.filter(function(s){return!hr(s,t)})),void n.Po.delete(t))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,fn(n.localStore,r.targetId,!1).then(function(){n.sharedClientState.clearQueryState(r.targetId),Qn(n.remoteStore,r.targetId),pn(n,r.targetId)}).catch(Ve)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return pn(n,r.targetId),[4,fn(n.localStore,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}})})}function Lg(e,t,n){return m(this,void 0,void 0,function(){var r,i,o,s;return y(this,function(u){switch(u.label){case 0:r=Fs(e),u.label=1;case 1:return u.trys.push([1,5,,6]),[4,function(a,c){var h,l=_(a),f=Tt.now(),p=c.reduce(function(d,v){return d.add(v.key)},j());return l.persistence.runTransaction("Locally write mutations","readwrite",function(d){return l.Mn.pn(d,p).next(function(v){h=v;for(var b=[],I=0,N=c;I<N.length;I++){var A=N[I],O=ud(A,h.get(A.key));O!=null&&b.push(new de(A.key,O,Vc(O.value.mapValue),ft.exists(!0)))}return l._n.addMutationBatch(d,f,b,c)})}).then(function(d){return d.applyToLocalDocumentSet(h),{batchId:d.batchId,changes:h}})}(r.localStore,t)];case 2:return i=u.sent(),r.sharedClientState.addPendingMutation(i.batchId),function(a,c,h){var l=a.xo[a.currentUser.toKey()];l||(l=new gt(L)),l=l.insert(c,h),a.xo[a.currentUser.toKey()]=l}(r,i.batchId,n),[4,ve(r,i.changes)];case 3:return u.sent(),[4,En(r.remoteStore)];case 4:return u.sent(),[3,6];case 5:return o=u.sent(),s=Tn(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}})})}function Bh(e,t){return m(this,void 0,void 0,function(){var n,r;return y(this,function(i){switch(i.label){case 0:n=_(e),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Yd(n.localStore,t)];case 2:return r=i.sent(),t.targetChanges.forEach(function(o,s){var u=n.Co.get(s);u&&(k(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1),o.addedDocuments.size>0?u.bo=!0:o.modifiedDocuments.size>0?k(u.bo):o.removedDocuments.size>0&&(k(u.bo),u.bo=!1))}),[4,ve(n,r,t)];case 3:return i.sent(),[3,6];case 4:return[4,Ve(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}})})}function ea(e,t,n){var r=_(e);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){var i=[];r.Po.forEach(function(o,s){var u=s.view.zr(t);u.snapshot&&i.push(u.snapshot)}),function(o,s){var u=_(o);u.onlineState=s;var a=!1;u.queries.forEach(function(c,h){for(var l=0,f=h.listeners;l<f.length;l++)f[l].zr(s)&&(a=!0)}),a&&Cs(u)}(r.eventManager,t),i.length&&r.vo._r(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function Fg(e,t,n){return m(this,void 0,void 0,function(){var r,i,o,s,u,a;return y(this,function(c){switch(c.label){case 0:return(r=_(e)).sharedClientState.updateQueryState(t,"rejected",n),i=r.Co.get(t),(o=i&&i.key)?(s=(s=new gt(C.comparator)).insert(o,dt.newNoDocument(o,P.min())),u=j().add(o),a=new ds(P.min(),new Map,new tt(L),s,u),[4,Bh(r,a)]):[3,2];case 1:return c.sent(),r.Do=r.Do.remove(o),r.Co.delete(t),Ps(r),[3,4];case 2:return[4,fn(r.localStore,t,!1).then(function(){return pn(r,t,n)}).catch(Ve)];case 3:c.sent(),c.label=4;case 4:return[2]}})})}function Mg(e,t){return m(this,void 0,void 0,function(){var n,r,i;return y(this,function(o){switch(o.label){case 0:n=_(e),r=t.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,Wd(n.localStore,t)];case 2:return i=o.sent(),Os(n,r,null),Rs(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,ve(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,Ve(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function Vg(e,t,n){return m(this,void 0,void 0,function(){var r,i;return y(this,function(o){switch(o.label){case 0:r=_(e),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(s,u){var a=_(s);return a.persistence.runTransaction("Reject batch","readwrite-primary",function(c){var h;return a._n.lookupMutationBatch(c,u).next(function(l){return k(l!==null),h=l.keys(),a._n.removeMutationBatch(c,l)}).next(function(){return a._n.performConsistencyCheck(c)}).next(function(){return a.Mn.pn(c,h)})})}(r.localStore,t)];case 2:return i=o.sent(),Os(r,t,n),Rs(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),[4,ve(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,Ve(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function Ug(e,t){return m(this,void 0,void 0,function(){var n,r,i,o,s;return y(this,function(u){switch(u.label){case 0:ge((n=_(e)).remoteStore)||T("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,function(a){var c=_(a);return c.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(h){return c._n.getHighestUnacknowledgedBatchId(h)})}(n.localStore)];case 2:return(r=u.sent())===-1?[2,void t.resolve()]:((i=n.ko.get(r)||[]).push(t),n.ko.set(r,i),[3,4]);case 3:return o=u.sent(),s=Tn(o,"Initialization of waitForPendingWrites() operation failed"),t.reject(s),[3,4];case 4:return[2]}})})}function Rs(e,t){(e.ko.get(t)||[]).forEach(function(n){n.resolve()}),e.ko.delete(t)}function Os(e,t,n){var r=_(e),i=r.xo[r.currentUser.toKey()];if(i){var o=i.get(t);o&&(n?o.reject(n):o.resolve(),i=i.remove(t)),r.xo[r.currentUser.toKey()]=i}}function pn(e,t,n){n===void 0&&(n=null),e.sharedClientState.removeLocalQueryTarget(t);for(var r=0,i=e.Vo.get(t);r<i.length;r++){var o=i[r];e.Po.delete(o),n&&e.vo.Mo(o,n)}e.Vo.delete(t),e.isPrimaryClient&&e.No.Zn(t).forEach(function(s){e.No.containsKey(s)||jh(e,s)})}function jh(e,t){e.So.delete(t.path.canonicalString());var n=e.Do.get(t);n!==null&&(Qn(e.remoteStore,n),e.Do=e.Do.remove(t),e.Co.delete(n),Ps(e))}function Do(e,t,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Vh?(e.No.addReference(o.key,t),qg(e,o)):o instanceof Uh?(T("SyncEngine","Document no longer in limbo: "+o.key),e.No.removeReference(o.key,t),e.No.containsKey(o.key)||jh(e,o.key)):D()}}function qg(e,t){var n=t.key,r=n.path.canonicalString();e.Do.get(n)||e.So.has(r)||(T("SyncEngine","New document in limbo: "+n),e.So.add(r),Ps(e))}function Ps(e){for(;e.So.size>0&&e.Do.size<e.maxConcurrentLimboResolutions;){var t=e.So.values().next().value;e.So.delete(t);var n=new C(U.fromString(t)),r=e.Fo.next();e.Co.set(r,new kg(n)),e.Do=e.Do.insert(n,r),Di(e.remoteStore,new Ai(Kt(cr(n.path)),r,2,xt.o))}}function ve(e,t,n){return m(this,void 0,void 0,function(){var r,i,o,s;return y(this,function(u){switch(u.label){case 0:return r=_(e),i=[],o=[],s=[],r.Po.isEmpty()?[3,3]:(r.Po.forEach(function(a,c){s.push(r.Oo(c,t,n).then(function(h){if(h){r.isPrimaryClient&&r.sharedClientState.updateQueryState(c.targetId,h.fromCache?"not-current":"current"),i.push(h);var l=Hd.Pn(c.targetId,h);o.push(l)}}))}),[4,Promise.all(s)]);case 1:return u.sent(),r.vo._r(i),[4,function(a,c){return m(this,void 0,void 0,function(){var h,l,f,p,d,v,b,I,N;return y(this,function(A){switch(A.label){case 0:h=_(a),A.label=1;case 1:return A.trys.push([1,3,,4]),[4,h.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(O){return E.forEach(c,function(F){return E.forEach(F.bn,function(B){return h.persistence.referenceDelegate.addReference(O,F.targetId,B)}).next(function(){return E.forEach(F.vn,function(B){return h.persistence.referenceDelegate.removeReference(O,F.targetId,B)})})})})];case 2:return A.sent(),[3,4];case 3:if(!Me(l=A.sent()))throw l;return T("LocalStore","Failed to update sequence numbers: "+l),[3,4];case 4:for(f=0,p=c;f<p.length;f++)d=p[f],v=d.targetId,d.fromCache||(b=h.kn.get(v),I=b.snapshotVersion,N=b.withLastLimboFreeSnapshotVersion(I),h.kn=h.kn.insert(v,N));return[2]}})})}(r.localStore,o)];case 2:u.sent(),u.label=3;case 3:return[2]}})})}function Bg(e,t){return m(this,void 0,void 0,function(){var n,r;return y(this,function(i){switch(i.label){case 0:return(n=_(e)).currentUser.isEqual(t)?[3,3]:(T("SyncEngine","User change. New user:",t.toKey()),[4,Sh(n.localStore,t)]);case 1:return r=i.sent(),n.currentUser=t,function(o,s){o.ko.forEach(function(u){u.forEach(function(a){a.reject(new w(g.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),o.ko.clear()}(n),n.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),[4,ve(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}function jg(e,t){var n=_(e),r=n.Co.get(t);if(r&&r.bo)return j().add(r.key);var i=j(),o=n.Vo.get(t);if(!o)return i;for(var s=0,u=o;s<u.length;s++){var a=u[s],c=n.Po.get(a);i=i.unionWith(c.view.wo)}return i}function Kg(e,t){return m(this,void 0,void 0,function(){var n,r,i;return y(this,function(o){switch(o.label){case 0:return[4,ei((n=_(e)).localStore,t.query,!0)];case 1:return r=o.sent(),i=t.view.Ao(r),[2,(n.isPrimaryClient&&Do(n,t.targetId,i.To),i)]}})})}function zg(e){return m(this,void 0,void 0,function(){var t;return y(this,function(n){return[2,Dh((t=_(e)).localStore).then(function(r){return ve(t,r)})]})})}function Gg(e,t,n,r){return m(this,void 0,void 0,function(){var i,o;return y(this,function(s){switch(s.label){case 0:return[4,function(u,a){var c=_(u),h=_(c._n);return c.persistence.runTransaction("Lookup mutation documents","readonly",function(l){return h.jt(l,a).next(function(f){return f?c.Mn.pn(l,f):E.resolve(null)})})}((i=_(e)).localStore,t)];case 1:return(o=s.sent())===null?[3,6]:n!=="pending"?[3,3]:[4,En(i.remoteStore)];case 2:return s.sent(),[3,4];case 3:n==="acknowledged"||n==="rejected"?(Os(i,t,r||null),Rs(i,t),function(u,a){_(_(u)._n).Gt(a)}(i.localStore,t)):D(),s.label=4;case 4:return[4,ve(i,o)];case 5:return s.sent(),[3,7];case 6:T("SyncEngine","Cannot apply mutation batch with id: "+t),s.label=7;case 7:return[2]}})})}function $g(e,t){return m(this,void 0,void 0,function(){var n,r,i,o,s,u,a,c;return y(this,function(h){switch(h.label){case 0:return Ls(n=_(e)),Fs(n),t!==!0||n.$o===!0?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,na(n,r.toArray())]);case 1:return i=h.sent(),n.$o=!0,[4,No(n.remoteStore,!0)];case 2:for(h.sent(),o=0,s=i;o<s.length;o++)u=s[o],Di(n.remoteStore,u);return[3,7];case 3:return t!==!1||n.$o===!1?[3,7]:(a=[],c=Promise.resolve(),n.Vo.forEach(function(l,f){n.sharedClientState.isLocalQueryTarget(f)?a.push(f):c=c.then(function(){return pn(n,f),fn(n.localStore,f,!0)}),Qn(n.remoteStore,f)}),[4,c]);case 4:return h.sent(),[4,na(n,a)];case 5:return h.sent(),function(l){var f=_(l);f.Co.forEach(function(p,d){Qn(f.remoteStore,d)}),f.No.ts(),f.Co=new Map,f.Do=new gt(C.comparator)}(n),n.$o=!1,[4,No(n.remoteStore,!1)];case 6:h.sent(),h.label=7;case 7:return[2]}})})}function na(e,t,n){return m(this,void 0,void 0,function(){var r,i,o,s,u,a,c,h,l,f,p,d,v,b;return y(this,function(I){switch(I.label){case 0:r=_(e),i=[],o=[],s=0,u=t,I.label=1;case 1:return s<u.length?(a=u[s],c=void 0,(h=r.Vo.get(a))&&h.length!==0?[4,ti(r.localStore,Kt(h[0]))]:[3,7]):[3,13];case 2:c=I.sent(),l=0,f=h,I.label=3;case 3:return l<f.length?(p=f[l],d=r.Po.get(p),[4,Kg(r,d)]):[3,6];case 4:(v=I.sent()).snapshot&&o.push(v.snapshot),I.label=5;case 5:return l++,[3,3];case 6:return[3,11];case 7:return[4,Nh(r.localStore,a)];case 8:return b=I.sent(),[4,ti(r.localStore,b)];case 9:return c=I.sent(),[4,ks(r,Kh(b),a,!1)];case 10:I.sent(),I.label=11;case 11:i.push(c),I.label=12;case 12:return s++,[3,1];case 13:return[2,(r.vo._r(o),i)]}})})}function Kh(e){return qc(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function Hg(e){var t=_(e);return _(_(t.localStore).persistence).fn()}function Qg(e,t,n,r){return m(this,void 0,void 0,function(){var i,o,s;return y(this,function(u){switch(u.label){case 0:return(i=_(e)).$o?(T("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Vo.has(t))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Dh(i.localStore)];case 3:return o=u.sent(),s=ds.createSynthesizedRemoteEventForCurrentChange(t,n==="current"),[4,ve(i,o,s)];case 4:return u.sent(),[3,8];case 5:return[4,fn(i.localStore,t,!0)];case 6:return u.sent(),pn(i,t,r),[3,8];case 7:D(),u.label=8;case 8:return[2]}})})}function Wg(e,t,n){return m(this,void 0,void 0,function(){var r,i,o,s,u,a,c,h,l,f;return y(this,function(p){switch(p.label){case 0:if(!(r=Ls(e)).$o)return[3,10];i=0,o=t,p.label=1;case 1:return i<o.length?(s=o[i],r.Vo.has(s)?(T("SyncEngine","Adding an already active target "+s),[3,5]):[4,Nh(r.localStore,s)]):[3,6];case 2:return u=p.sent(),[4,ti(r.localStore,u)];case 3:return a=p.sent(),[4,ks(r,Kh(u),a.targetId,!1)];case 4:p.sent(),Di(r.remoteStore,a),p.label=5;case 5:return i++,[3,1];case 6:c=function(d){return y(this,function(v){switch(v.label){case 0:return r.Vo.has(d)?[4,fn(r.localStore,d,!1).then(function(){Qn(r.remoteStore,d),pn(r,d)}).catch(Ve)]:[3,2];case 1:v.sent(),v.label=2;case 2:return[2]}})},h=0,l=n,p.label=7;case 7:return h<l.length?(f=l[h],[5,c(f)]):[3,10];case 8:p.sent(),p.label=9;case 9:return h++,[3,7];case 10:return[2]}})})}function Ls(e){var t=_(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Bh.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=jg.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Fg.bind(null,t),t.vo._r=Dg.bind(null,t.eventManager),t.vo.Mo=Cg.bind(null,t.eventManager),t}function Fs(e){var t=_(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Mg.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Vg.bind(null,t),t}var zh=function(){function e(){this.synchronizeTabs=!1}return e.prototype.initialize=function(t){return m(this,void 0,void 0,function(){return y(this,function(n){switch(n.label){case 0:return this.R=Ni(t.databaseInfo.databaseId),this.sharedClientState=this.Bo(t),this.persistence=this.qo(t),[4,this.persistence.start()];case 1:return n.sent(),this.gcScheduler=this.Uo(t),this.localStore=this.Ko(t),[2]}})})},e.prototype.Uo=function(t){return null},e.prototype.Ko=function(t){return _h(this.persistence,new Th,t.initialUser,this.R)},e.prototype.qo=function(t){return new og(ug.bs,this.R)},e.prototype.Bo=function(t){return new Ch},e.prototype.terminate=function(){return m(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}})})},e}(),Gh=function(e){function t(n,r,i){var o=this;return(o=e.call(this)||this).Qo=n,o.cacheSizeBytes=r,o.forceOwnership=i,o.synchronizeTabs=!1,o}return x(t,e),t.prototype.initialize=function(n){return m(this,void 0,void 0,function(){var r=this;return y(this,function(i){switch(i.label){case 0:return[4,e.prototype.initialize.call(this,n)];case 1:return i.sent(),[4,Zd(this.localStore)];case 2:return i.sent(),[4,this.Qo.initialize(this,n)];case 3:return i.sent(),[4,Fs(this.Qo.syncEngine)];case 4:return i.sent(),[4,En(this.Qo.remoteStore)];case 5:return i.sent(),[4,this.persistence.He(function(){return r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(r.localStore),Promise.resolve()})];case 6:return i.sent(),[2]}})})},t.prototype.Ko=function(n){return _h(this.persistence,new Th,n.initialUser,this.R)},t.prototype.Uo=function(n){var r=this.persistence.referenceDelegate.garbageCollector;return new qd(r,n.asyncQueue)},t.prototype.qo=function(n){var r=Es(n.databaseInfo.databaseId,n.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?Ut.withCacheSize(this.cacheSizeBytes):Ut.DEFAULT;return new $d(this.synchronizeTabs,r,n.clientId,i,n.asyncQueue,xh(),Or(),this.R,this.sharedClientState,!!this.forceOwnership)},t.prototype.Bo=function(n){return new Ch},t}(zh),Yg=function(e){function t(n,r){var i=this;return(i=e.call(this,n,r,!1)||this).Qo=n,i.cacheSizeBytes=r,i.synchronizeTabs=!0,i}return x(t,e),t.prototype.initialize=function(n){return m(this,void 0,void 0,function(){var r,i=this;return y(this,function(o){switch(o.label){case 0:return[4,e.prototype.initialize.call(this,n)];case 1:return o.sent(),r=this.Qo.syncEngine,this.sharedClientState instanceof to?(this.sharedClientState.syncEngine={ui:Gg.bind(null,r),ai:Qg.bind(null,r),hi:Wg.bind(null,r),fn:Hg.bind(null,r),ci:zg.bind(null,r)},[4,this.sharedClientState.start()]):[3,3];case 2:o.sent(),o.label=3;case 3:return[4,this.persistence.He(function(s){return m(i,void 0,void 0,function(){return y(this,function(u){switch(u.label){case 0:return[4,$g(this.Qo.syncEngine,s)];case 1:return u.sent(),this.gcScheduler&&(s&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):s||this.gcScheduler.stop()),[2]}})})})];case 4:return o.sent(),[2]}})})},t.prototype.Bo=function(n){var r=xh();if(!to.yt(r))throw new w(g.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var i=Es(n.databaseInfo.databaseId,n.databaseInfo.persistenceKey);return new to(r,n.asyncQueue,i,n.clientId,n.initialUser)},t}(Gh),Co=function(){function e(){}return e.prototype.initialize=function(t,n){return m(this,void 0,void 0,function(){var r=this;return y(this,function(i){switch(i.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(o){return ea(r.syncEngine,o,1)},this.remoteStore.remoteSyncer.handleCredentialChange=Bg.bind(null,this.syncEngine),[4,No(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:i.sent(),i.label=2;case 2:return[2]}})})},e.prototype.createEventManager=function(t){return new Ng},e.prototype.createDatastore=function(t){var n,r=Ni(t.databaseInfo.databaseId),i=(n=t.databaseInfo,new fg(n));return function(o,s,u){return new gg(o,s,u)}(t.credentials,i,r)},e.prototype.createRemoteStore=function(t){var n,r,i,o,s,u=this;return n=this.localStore,r=this.datastore,i=t.asyncQueue,o=function(a){return ea(u.syncEngine,a,0)},s=Zu.yt()?new Zu:new cg,new yg(n,r,i,o,s)},e.prototype.createSyncEngine=function(t,n){return function(r,i,o,s,u,a,c){var h=new Rg(r,i,o,s,u,a);return c&&(h.$o=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,n)},e.prototype.terminate=function(){return function(t){return m(this,void 0,void 0,function(){var n;return y(this,function(r){switch(r.label){case 0:return n=_(t),T("RemoteStore","RemoteStore shutting down."),n.Or.add(5),[4,bn(n)];case 1:return r.sent(),n.Lr.shutdown(),n.Br.set("Unknown"),[2]}})})}(this.remoteStore)},e}();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ci=function(){function e(t){this.observer=t,this.muted=!1}return e.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},e.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},e.prototype.Wo=function(){this.muted=!0},e.prototype.jo=function(t,n){var r=this;this.muted||setTimeout(function(){r.muted||t(n)},0)},e}(),Xg=function(){function e(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return e.prototype.lookup=function(t){return m(this,void 0,void 0,function(){var n,r=this;return y(this,function(i){switch(i.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new w(g.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(o,s){return m(this,void 0,void 0,function(){var u,a,c,h,l,f;return y(this,function(p){switch(p.label){case 0:return u=_(o),a=Hn(u.R)+"/documents",c={documents:s.map(function(d){return $n(u.R,d)})},[4,u.$i("BatchGetDocuments",a,c)];case 1:return h=p.sent(),l=new Map,h.forEach(function(d){var v=function(b,I){return"found"in I?function(N,A){k(!!A.found),A.found.name,A.found.updateTime;var O=Ht(N,A.found.name),F=Et(A.found.updateTime),B=new Ct({mapValue:{fields:A.found.fields}});return dt.newFoundDocument(O,F,B)}(b,I):"missing"in I?function(N,A){k(!!A.missing),k(!!A.readTime);var O=Ht(N,A.missing),F=Et(A.readTime);return dt.newNoDocument(O,F)}(b,I):D()}(u.R,d);l.set(v.key.toString(),v)}),f=[],[2,(s.forEach(function(d){var v=l.get(d.toString());k(!!v),f.push(v)}),f)]}})})}(this.datastore,t)];case 1:return[2,((n=i.sent()).forEach(function(o){return r.recordVersion(o)}),n)]}})})},e.prototype.set=function(t,n){this.write(n.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},e.prototype.update=function(t,n){try{this.write(n.toMutation(t,this.preconditionForUpdate(t)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(t.toString())},e.prototype.delete=function(t){this.write(new dr(t,this.precondition(t))),this.writtenDocs.add(t.toString())},e.prototype.commit=function(){return m(this,void 0,void 0,function(){var t,n=this;return y(this,function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach(function(i){t.delete(i.key.toString())}),t.forEach(function(i,o){var s=C.fromPath(o);n.mutations.push(new ps(s,n.precondition(s)))}),[4,function(i,o){return m(this,void 0,void 0,function(){var s,u,a;return y(this,function(c){switch(c.label){case 0:return s=_(i),u=Hn(s.R)+"/documents",a={writes:o.map(function(h){return Xr(s.R,h)})},[4,s.Ni("Commit",u,a)];case 1:return c.sent(),[2]}})})}(this.datastore,this.mutations)];case 1:return r.sent(),this.committed=!0,[2]}})})},e.prototype.recordVersion=function(t){var n;if(t.isFoundDocument())n=t.version;else{if(!t.isNoDocument())throw D();n=P.min()}var r=this.readVersions.get(t.key.toString());if(r){if(!n.isEqual(r))throw new w(g.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),n)},e.prototype.precondition=function(t){var n=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&n?ft.updateTime(n):ft.none()},e.prototype.preconditionForUpdate=function(t){var n=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&n){if(n.isEqual(P.min()))throw new w(g.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ft.updateTime(n)}return ft.exists(!0)},e.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},e.prototype.ensureCommitNotCalled=function(){},e}(),Jg=function(){function e(t,n,r,i){this.asyncQueue=t,this.datastore=n,this.updateFunction=r,this.deferred=i,this.ec=5,this.Zi=new Ts(this.asyncQueue,"transaction_retry")}return e.prototype.run=function(){this.ec-=1,this.nc()},e.prototype.nc=function(){var t=this;this.Zi.ji(function(){return m(t,void 0,void 0,function(){var n,r,i=this;return y(this,function(o){return n=new Xg(this.datastore),(r=this.sc(n))&&r.then(function(s){i.asyncQueue.enqueueAndForget(function(){return n.commit().then(function(){i.deferred.resolve(s)}).catch(function(u){i.ic(u)})})}).catch(function(s){i.ic(s)}),[2]})})})},e.prototype.sc=function(t){try{var n=this.updateFunction(t);return!Fe(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(r){return this.deferred.reject(r),null}},e.prototype.ic=function(t){var n=this;this.ec>0&&this.rc(t)?(this.ec-=1,this.asyncQueue.enqueueAndForget(function(){return n.nc(),Promise.resolve()})):this.deferred.reject(t)},e.prototype.rc=function(t){if(t.name==="FirebaseError"){var n=t.code;return n==="aborted"||n==="failed-precondition"||!Jc(n)}return!1},e}(),Zg=function(){function e(t,n,r){var i=this;this.credentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=it.UNAUTHENTICATED,this.clientId=Rc.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(n,function(o){return m(i,void 0,void 0,function(){return y(this,function(s){switch(s.label){case 0:return T("FirestoreClient","Received user=",o.uid),[4,this.credentialListener(o)];case 1:return s.sent(),this.user=o,[2]}})})})}return e.prototype.getConfiguration=function(){return m(this,void 0,void 0,function(){return y(this,function(t){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]})})},e.prototype.setCredentialChangeListener=function(t){this.credentialListener=t},e.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new w(g.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var n=new St;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(function(){return m(t,void 0,void 0,function(){var r,i;return y(this,function(o){switch(o.label){case 0:return o.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:o.sent(),o.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:o.sent(),o.label=4;case 4:return this.credentials.removeChangeListener(),n.resolve(),[3,6];case 5:return r=o.sent(),i=Tn(r,"Failed to shutdown persistence"),n.reject(i),[3,6];case 6:return[2]}})})}),n.promise},e}();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $h(e,t){return m(this,void 0,void 0,function(){var n,r,i=this;return y(this,function(o){switch(o.label){case 0:return e.asyncQueue.verifyOperationInProgress(),T("FirestoreClient","Initializing OfflineComponentProvider"),[4,e.getConfiguration()];case 1:return n=o.sent(),[4,t.initialize(n)];case 2:return o.sent(),r=n.initialUser,e.setCredentialChangeListener(function(s){return m(i,void 0,void 0,function(){return y(this,function(u){switch(u.label){case 0:return r.isEqual(s)?[3,2]:[4,Sh(t.localStore,s)];case 1:u.sent(),r=s,u.label=2;case 2:return[2]}})})}),t.persistence.setDatabaseDeletedListener(function(){return e.terminate()}),e.offlineComponents=t,[2]}})})}function Hh(e,t){return m(this,void 0,void 0,function(){var n,r;return y(this,function(i){switch(i.label){case 0:return e.asyncQueue.verifyOperationInProgress(),[4,Ms(e)];case 1:return n=i.sent(),T("FirestoreClient","Initializing OnlineComponentProvider"),[4,e.getConfiguration()];case 2:return r=i.sent(),[4,t.initialize(n,r)];case 3:return i.sent(),e.setCredentialChangeListener(function(o){return function(s,u){return m(this,void 0,void 0,function(){var a,c;return y(this,function(h){switch(h.label){case 0:return(a=_(s)).asyncQueue.verifyOperationInProgress(),T("RemoteStore","RemoteStore received new credentials"),c=ge(a),a.Or.add(3),[4,bn(a)];case 1:return h.sent(),c&&a.Br.set("Unknown"),[4,a.remoteSyncer.handleCredentialChange(u)];case 2:return h.sent(),a.Or.delete(3),[4,gr(a)];case 3:return h.sent(),[2]}})})}(t.remoteStore,o)}),e.onlineComponents=t,[2]}})})}function Ms(e){return m(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e.offlineComponents?[3,2]:(T("FirestoreClient","Using default OfflineComponentProvider"),[4,$h(e,new zh)]);case 1:t.sent(),t.label=2;case 2:return[2,e.offlineComponents]}})})}function xi(e){return m(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e.onlineComponents?[3,2]:(T("FirestoreClient","Using default OnlineComponentProvider"),[4,Hh(e,new Co)]);case 1:t.sent(),t.label=2;case 2:return[2,e.onlineComponents]}})})}function ra(e){return Ms(e).then(function(t){return t.persistence})}function Qh(e){return Ms(e).then(function(t){return t.localStore})}function ia(e){return xi(e).then(function(t){return t.remoteStore})}function Wh(e){return xi(e).then(function(t){return t.syncEngine})}function dn(e){return m(this,void 0,void 0,function(){var t,n;return y(this,function(r){switch(r.label){case 0:return[4,xi(e)];case 1:return t=r.sent(),[2,((n=t.eventManager).onListen=Og.bind(null,t.syncEngine),n.onUnlisten=Pg.bind(null,t.syncEngine),n)]}})})}function oa(e,t,n){var r=this;n===void 0&&(n={});var i=new St;return e.asyncQueue.enqueueAndForget(function(){return m(r,void 0,void 0,function(){var o;return y(this,function(s){switch(s.label){case 0:return o=function(u,a,c,h,l){var f=new Ci({next:function(d){a.enqueueAndForget(function(){return Ds(u,p)});var v=d.docs.has(c);!v&&d.fromCache?l.reject(new w(g.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&d.fromCache&&h&&h.source==="server"?l.reject(new w(g.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(d)},error:function(d){return l.reject(d)}}),p=new xs(cr(c.path),f,{includeMetadataChanges:!0,so:!0});return Ns(u,p)},[4,dn(e)];case 1:return[2,o.apply(void 0,[s.sent(),e.asyncQueue,t,n,i])]}})})}),i.promise}function sa(e,t,n){var r=this;n===void 0&&(n={});var i=new St;return e.asyncQueue.enqueueAndForget(function(){return m(r,void 0,void 0,function(){var o;return y(this,function(s){switch(s.label){case 0:return o=function(u,a,c,h,l){var f=new Ci({next:function(d){a.enqueueAndForget(function(){return Ds(u,p)}),d.fromCache&&h.source==="server"?l.reject(new w(g.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(d)},error:function(d){return l.reject(d)}}),p=new xs(c,f,{includeMetadataChanges:!0,so:!0});return Ns(u,p)},[4,dn(e)];case 1:return[2,o.apply(void 0,[s.sent(),e.asyncQueue,t,n,i])]}})})}),i.promise}var tv=function(e,t,n,r,i,o,s,u){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=u},ii=function(){function e(t,n){this.projectId=t,this.database=n||"(default)"}return Object.defineProperty(e.prototype,"isDefaultDatabase",{get:function(){return this.database==="(default)"},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database},e}(),ua=new Map,Yh=function(e,t){this.user=t,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+e},aa=function(){function e(){this.changeListener=null}return e.prototype.getToken=function(){return Promise.resolve(null)},e.prototype.invalidateToken=function(){},e.prototype.setChangeListener=function(t,n){this.changeListener=n,t.enqueueRetryable(function(){return n(it.UNAUTHENTICATED)})},e.prototype.removeChangeListener=function(){this.changeListener=null},e}(),ev=function(){function e(t){this.token=t,this.changeListener=null}return e.prototype.getToken=function(){return Promise.resolve(this.token)},e.prototype.invalidateToken=function(){},e.prototype.setChangeListener=function(t,n){var r=this;this.changeListener=n,t.enqueueRetryable(function(){return n(r.token.user)})},e.prototype.removeChangeListener=function(){this.changeListener=null},e}(),nv=function(){function e(t){var n=this;this.currentUser=it.UNAUTHENTICATED,this.oc=new St,this.cc=0,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=function(){n.cc++,n.currentUser=n.ac(),n.oc.resolve(),n.changeListener&&n.asyncQueue.enqueueRetryable(function(){return n.changeListener(n.currentUser)})};var r=function(i){T("FirebaseCredentialsProvider","Auth detected"),n.auth=i,n.auth.addAuthTokenListener(n.uc)};t.onInit(function(i){return r(i)}),setTimeout(function(){if(!n.auth){var i=t.getImmediate({optional:!0});i?r(i):(T("FirebaseCredentialsProvider","Auth not yet detected"),n.oc.resolve())}},0)}return e.prototype.getToken=function(){var t=this,n=this.cc,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(function(i){return t.cc!==n?(T("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):i?(k(typeof i.accessToken=="string"),new Yh(i.accessToken,t.currentUser)):null}):Promise.resolve(null)},e.prototype.invalidateToken=function(){this.forceRefresh=!0},e.prototype.setChangeListener=function(t,n){var r=this;this.asyncQueue=t,this.asyncQueue.enqueueRetryable(function(){return m(r,void 0,void 0,function(){return y(this,function(i){switch(i.label){case 0:return[4,this.oc.promise];case 1:return i.sent(),[4,n(this.currentUser)];case 2:return i.sent(),this.changeListener=n,[2]}})})})},e.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=function(){return Promise.resolve()}},e.prototype.ac=function(){var t=this.auth&&this.auth.getUid();return k(t===null||typeof t=="string"),new it(t)},e}(),rv=function(){function e(t,n,r){this.hc=t,this.lc=n,this.fc=r,this.type="FirstParty",this.user=it.FIRST_PARTY}return Object.defineProperty(e.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.lc},n=this.hc.auth.getAuthHeaderValueForFirstParty([]);return n&&(t.Authorization=n),this.fc&&(t["X-Goog-Iam-Authorization-Token"]=this.fc),t},enumerable:!1,configurable:!0}),e}(),iv=function(){function e(t,n,r){this.hc=t,this.lc=n,this.fc=r}return e.prototype.getToken=function(){return Promise.resolve(new rv(this.hc,this.lc,this.fc))},e.prototype.setChangeListener=function(t,n){t.enqueueRetryable(function(){return n(it.FIRST_PARTY)})},e.prototype.removeChangeListener=function(){},e.prototype.invalidateToken=function(){},e}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vs(e,t,n){if(!n)throw new w(g.INVALID_ARGUMENT,"Function "+e+"() cannot be called with an empty "+t+".")}function Us(e,t){if(t===void 0)return{merge:!1};if(t.mergeFields!==void 0&&t.merge!==void 0)throw new w(g.INVALID_ARGUMENT,"Invalid options passed to function "+e+'(): You cannot specify both "merge" and "mergeFields".');return t}function Xh(e,t,n,r){if(t===!0&&r===!0)throw new w(g.INVALID_ARGUMENT,e+" and "+n+" cannot be used together.")}function ca(e){if(!C.isDocumentKey(e))throw new w(g.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e+" has "+e.length+".")}function ha(e){if(C.isDocumentKey(e))throw new w(g.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e+" has "+e.length+".")}function ki(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";var t=function(n){if(n.constructor){var r=/function\s+([^\s(]+)\s*\(/.exec(n.constructor.toString());if(r&&r.length>1)return r[1]}return null}(e);return t?"a custom "+t+" object":"an object"}return typeof e=="function"?"a function":D()}function q(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new w(g.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=ki(e);throw new w(g.INVALID_ARGUMENT,"Expected type '"+t.name+"', but it was: "+n)}return e}function la(e,t){if(t<=0)throw new w(g.INVALID_ARGUMENT,"Function "+e+"() requires a positive number, but it was: "+t+".")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fa=function(){function e(t){var n;if(t.host===void 0){if(t.ssl!==void 0)throw new w(g.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=(n=t.ssl)===null||n===void 0||n;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,t.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<1048576)throw new w(g.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,Xh("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return e.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams},e}(),Wn=function(){function e(t,n){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new fa({}),this._settingsFrozen=!1,t instanceof ii?(this._databaseId=t,this._credentials=new aa):(this._app=t,this._databaseId=function(r){if(!Object.prototype.hasOwnProperty.apply(r.options,["projectId"]))throw new w(g.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ii(r.options.projectId)}(t),this._credentials=new nv(n))}return Object.defineProperty(e.prototype,"app",{get:function(){if(!this._app)throw new w(g.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_terminated",{get:function(){return this._terminateTask!==void 0},enumerable:!1,configurable:!0}),e.prototype._setSettings=function(t){if(this._settingsFrozen)throw new w(g.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new fa(t),t.credentials!==void 0&&(this._credentials=function(n){if(!n)return new aa;switch(n.type){case"gapi":var r=n.client;return k(!(typeof r!="object"||r===null||!r.auth||!r.auth.getAuthHeaderValueForFirstParty)),new iv(r,n.sessionIndex||"0",n.iamToken||null);case"provider":return n.client;default:throw new w(g.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},e.prototype._getSettings=function(){return this._settings},e.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},e.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},e.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},e.prototype._terminate=function(){return t=this,(n=ua.get(t))&&(T("ComponentProvider","Removing Datastore"),ua.delete(t),n.terminate()),Promise.resolve();var t,n},e}(),G=function(){function e(t,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=t}return Object.defineProperty(e.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new ae(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._key)},e}(),Rt=function(){function e(t,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=t}return e.prototype.withConverter=function(t){return new e(this.firestore,t,this._query)},e}(),ae=function(e){function t(n,r,i){var o=this;return(o=e.call(this,n,r,cr(i))||this)._path=i,o.type="collection",o}return x(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var n=this._path.popLast();return n.isEmpty()?null:new G(this.firestore,null,new C(n))},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(n){return new t(this.firestore,n,this._path)},t}(Rt);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jh(e,t){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(e=X(e),Vs("collection","path",t),e instanceof Wn)return ha(n=U.fromString.apply(U,H([t],r))),new ae(e,null,n);if(!(e instanceof G||e instanceof ae))throw new w(g.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return ha(n=U.fromString.apply(U,H([e.path],r)).child(U.fromString(t))),new ae(e.firestore,null,n)}function Pr(e,t){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(e=X(e),arguments.length===1&&(t=Rc.u()),Vs("doc","path",t),e instanceof Wn)return ca(n=U.fromString.apply(U,H([t],r))),new G(e,null,new C(n));if(!(e instanceof G||e instanceof ae))throw new w(g.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return ca(n=e._path.child(U.fromString.apply(U,H([t],r)))),new G(e.firestore,e instanceof ae?e.converter:null,new C(n))}function Zh(e,t){return e=X(e),t=X(t),(e instanceof G||e instanceof ae)&&(t instanceof G||t instanceof ae)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter}function tl(e,t){return e=X(e),t=X(t),e instanceof Rt&&t instanceof Rt&&e.firestore===t.firestore&&hr(e._query,t._query)&&e.converter===t.converter}var ov=function(){function e(){var t=this;this.dc=Promise.resolve(),this.wc=[],this._c=!1,this.mc=[],this.yc=null,this.gc=!1,this.Ec=!1,this.Tc=[],this.Zi=new Ts(this,"async_queue_retry"),this.Ic=function(){var r=Or();r&&T("AsyncQueue","Visibility state changed to "+r.visibilityState),t.Zi.Gi()};var n=Or();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Ic)}return Object.defineProperty(e.prototype,"isShuttingDown",{get:function(){return this._c},enumerable:!1,configurable:!0}),e.prototype.enqueueAndForget=function(t){this.enqueue(t)},e.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Ac(),this.Rc(t)},e.prototype.enterRestrictedMode=function(t){if(!this._c){this._c=!0,this.Ec=t||!1;var n=Or();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Ic)}},e.prototype.enqueue=function(t){var n=this;if(this.Ac(),this._c)return new Promise(function(){});var r=new St;return this.Rc(function(){return n._c&&n.Ec?Promise.resolve():(t().then(r.resolve,r.reject),r.promise)}).then(function(){return r.promise})},e.prototype.enqueueRetryable=function(t){var n=this;this.enqueueAndForget(function(){return n.wc.push(t),n.bc()})},e.prototype.bc=function(){return m(this,void 0,void 0,function(){var t,n=this;return y(this,function(r){switch(r.label){case 0:if(this.wc.length===0)return[3,5];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.wc[0]()];case 2:return r.sent(),this.wc.shift(),this.Zi.reset(),[3,4];case 3:if(!Me(t=r.sent()))throw t;return T("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.wc.length>0&&this.Zi.ji(function(){return n.bc()}),r.label=5;case 5:return[2]}})})},e.prototype.Rc=function(t){var n=this,r=this.dc.then(function(){return n.gc=!0,t().catch(function(i){throw n.yc=i,n.gc=!1,Y("INTERNAL UNHANDLED ERROR: ",function(o){var s=o.message||"";return o.stack&&(s=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),s}(i)),i}).then(function(i){return n.gc=!1,i})});return this.dc=r,r},e.prototype.enqueueAfterDelay=function(t,n,r){var i=this;this.Ac(),this.Tc.indexOf(t)>-1&&(n=0);var o=Sg.createAndSchedule(this,t,n,r,function(s){return i.vc(s)});return this.mc.push(o),o},e.prototype.Ac=function(){this.yc&&D()},e.prototype.verifyOperationInProgress=function(){},e.prototype.Pc=function(){return m(this,void 0,void 0,function(){var t;return y(this,function(n){switch(n.label){case 0:return[4,t=this.dc];case 1:n.sent(),n.label=2;case 2:if(t!==this.dc)return[3,0];n.label=3;case 3:return[2]}})})},e.prototype.Vc=function(t){for(var n=0,r=this.mc;n<r.length;n++)if(r[n].timerId===t)return!0;return!1},e.prototype.Sc=function(t){var n=this;return this.Pc().then(function(){n.mc.sort(function(s,u){return s.targetTimeMs-u.targetTimeMs});for(var r=0,i=n.mc;r<i.length;r++){var o=i[r];if(o.skipDelay(),t!=="all"&&o.timerId===t)break}return n.Pc()})},e.prototype.Dc=function(t){this.Tc.push(t)},e.prototype.vc=function(t){var n=this.mc.indexOf(t);this.mc.splice(n,1)},e}();function gn(e){return function(t,n){if(typeof t!="object"||t===null)return!1;for(var r=t,i=0,o=["next","error","complete"];i<o.length;i++){var s=o[i];if(s in r&&typeof r[s]=="function")return!0}return!1}(e)}var sv=-1,Z=function(e){function t(n,r){var i=this;return(i=e.call(this,n,r)||this).type="firestore",i._queue=new ov,i._persistenceKey="name"in n?n.name:"[DEFAULT]",i}return x(t,e),t.prototype._terminate=function(){return this._firestoreClient||el(this),this._firestoreClient.terminate()},t}(Wn);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lt(e){return e._firestoreClient||el(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function el(e){var t,n=e._freezeSettings(),r=function(i,o,s,u){return new tv(i,o,s,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,u.useFetchStreams)}(e._databaseId,((t=e._app)===null||t===void 0?void 0:t.options.appId)||"",e._persistenceKey,n);e._firestoreClient=new Zg(e._credentials,e._queue,r)}function pa(e,t,n){var r=this,i=new St;return e.asyncQueue.enqueue(function(){return m(r,void 0,void 0,function(){var o;return y(this,function(s){switch(s.label){case 0:return s.trys.push([0,3,,4]),[4,$h(e,n)];case 1:return s.sent(),[4,Hh(e,t)];case 2:return s.sent(),i.resolve(),[3,4];case 3:if(!function(u){return u.name==="FirebaseError"?u.code===g.FAILED_PRECONDITION||u.code===g.UNIMPLEMENTED:!(typeof DOMException<"u"&&u instanceof DOMException)||u.code===22||u.code===20||u.code===11}(o=s.sent()))throw o;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+o),i.reject(o),[3,4];case 4:return[2]}})})}).then(function(){return i.promise})}function da(e){if(e._initialized||e._terminated)throw new w(g.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Bt=function(){function e(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=0;r<t.length;++r)if(t[r].length===0)throw new w(g.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Vt(t)}return e.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},e}(),Oe=function(){function e(t){this._byteString=t}return e.fromBase64String=function(t){try{return new e(_t.fromBase64String(t))}catch(n){throw new w(g.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}},e.fromUint8Array=function(t){return new e(_t.fromUint8Array(t))},e.prototype.toBase64=function(){return this._byteString.toBase64()},e.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},e.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},e.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},e}(),Ue=function(e){this._methodName=e},Ri=function(){function e(t,n){if(!isFinite(t)||t<-90||t>90)throw new w(g.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new w(g.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}return Object.defineProperty(e.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},e.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},e.prototype._compareTo=function(t){return L(this._lat,t._lat)||L(this._long,t._long)},e}(),uv=/^__.*__$/,av=function(){function e(t,n,r){this.data=t,this.fieldMask=n,this.fieldTransforms=r}return e.prototype.toMutation=function(t,n){return this.fieldMask!==null?new de(t,this.data,this.fieldMask,n,this.fieldTransforms):new pr(t,this.data,n,this.fieldTransforms)},e}(),nl=function(){function e(t,n,r){this.data=t,this.fieldMask=n,this.fieldTransforms=r}return e.prototype.toMutation=function(t,n){return new de(t,this.data,this.fieldMask,n,this.fieldTransforms)},e}();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rl(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw D()}}var il=function(){function e(t,n,r,i,o,s){this.settings=t,this.databaseId=n,this.R=r,this.ignoreUndefinedProperties=i,o===void 0&&this.Cc(),this.fieldTransforms=o||[],this.fieldMask=s||[]}return Object.defineProperty(e.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Nc",{get:function(){return this.settings.Nc},enumerable:!1,configurable:!0}),e.prototype.xc=function(t){return new e(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},e.prototype.kc=function(t){var n,r=(n=this.path)===null||n===void 0?void 0:n.child(t),i=this.xc({path:r,Fc:!1});return i.$c(t),i},e.prototype.Oc=function(t){var n,r=(n=this.path)===null||n===void 0?void 0:n.child(t),i=this.xc({path:r,Fc:!1});return i.Cc(),i},e.prototype.Mc=function(t){return this.xc({path:void 0,Fc:!0})},e.prototype.Lc=function(t){return oi(t,this.settings.methodName,this.settings.Bc||!1,this.path,this.settings.qc)},e.prototype.contains=function(t){return this.fieldMask.find(function(n){return t.isPrefixOf(n)})!==void 0||this.fieldTransforms.find(function(n){return t.isPrefixOf(n.field)})!==void 0},e.prototype.Cc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.$c(this.path.get(t))},e.prototype.$c=function(t){if(t.length===0)throw this.Lc("Document fields must not be empty");if(rl(this.Nc)&&uv.test(t))throw this.Lc('Document fields cannot begin and end with "__"')},e}(),cv=function(){function e(t,n,r){this.databaseId=t,this.ignoreUndefinedProperties=n,this.R=r||Ni(t)}return e.prototype.Uc=function(t,n,r,i){return i===void 0&&(i=!1),new il({Nc:t,methodName:n,qc:r,path:Vt.emptyPath(),Fc:!1,Bc:i},this.databaseId,this.R,this.ignoreUndefinedProperties)},e}();function qe(e){var t=e._freezeSettings(),n=Ni(e._databaseId);return new cv(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Oi(e,t,n,r,i,o){o===void 0&&(o={});var s=e.Uc(o.merge||o.mergeFields?2:0,t,n,i);Ks("Data must be an object, but it was:",s,r);var u,a,c=ul(r,s);if(o.merge)u=new tn(s.fieldMask),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],l=0,f=o.mergeFields;l<f.length;l++){var p=xo(t,f[l],n);if(!s.contains(p))throw new w(g.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");cl(h,p)||h.push(p)}u=new tn(h),a=s.fieldTransforms.filter(function(d){return u.covers(d.field)})}else u=null,a=s.fieldTransforms;return new av(new Ct(c),u,a)}var qs=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return x(t,e),t.prototype._toFieldTransform=function(n){if(n.Nc!==2)throw n.Nc===1?n.Lc(this._methodName+"() can only appear at the top level of your update data"):n.Lc(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return n.fieldMask.push(n.path),null},t.prototype.isEqual=function(n){return n instanceof t},t}(Ue);function ol(e,t,n){return new il({Nc:3,qc:t.settings.qc,methodName:e._methodName,Fc:n},t.databaseId,t.R,t.ignoreUndefinedProperties)}var hv=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return x(t,e),t.prototype._toFieldTransform=function(n){return new fr(n.path,new on)},t.prototype.isEqual=function(n){return n instanceof t},t}(Ue),lv=function(e){function t(n,r){var i=this;return(i=e.call(this,n)||this).Kc=r,i}return x(t,e),t.prototype._toFieldTransform=function(n){var r=ol(this,n,!0),i=this.Kc.map(function(s){return Be(s,r)}),o=new ke(i);return new fr(n.path,o)},t.prototype.isEqual=function(n){return this===n},t}(Ue),fv=function(e){function t(n,r){var i=this;return(i=e.call(this,n)||this).Kc=r,i}return x(t,e),t.prototype._toFieldTransform=function(n){var r=ol(this,n,!0),i=this.Kc.map(function(s){return Be(s,r)}),o=new Re(i);return new fr(n.path,o)},t.prototype.isEqual=function(n){return this===n},t}(Ue),pv=function(e){function t(n,r){var i=this;return(i=e.call(this,n)||this).Qc=r,i}return x(t,e),t.prototype._toFieldTransform=function(n){var r=new sn(n.R,$c(n.R,this.Qc));return new fr(n.path,r)},t.prototype.isEqual=function(n){return this===n},t}(Ue);function Bs(e,t,n,r){var i=e.Uc(1,t,n);Ks("Data must be an object, but it was:",i,r);var o=[],s=Ct.empty();Le(r,function(a,c){var h=zs(t,a,n);c=X(c);var l=i.Oc(h);if(c instanceof qs)o.push(h);else{var f=Be(c,l);f!=null&&(o.push(h),s.set(h,f))}});var u=new tn(o);return new nl(s,u,i.fieldTransforms)}function js(e,t,n,r,i,o){var s=e.Uc(1,t,n),u=[xo(t,r,n)],a=[i];if(o.length%2!=0)throw new w(g.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(xo(t,o[c])),a.push(o[c+1]);for(var h=[],l=Ct.empty(),f=u.length-1;f>=0;--f)if(!cl(h,u[f])){var p=u[f],d=a[f];d=X(d);var v=s.Oc(p);if(d instanceof qs)h.push(p);else{var b=Be(d,v);b!=null&&(h.push(p),l.set(p,b))}}var I=new tn(h);return new nl(l,I,s.fieldTransforms)}function sl(e,t,n,r){return r===void 0&&(r=!1),Be(n,e.Uc(r?4:3,t))}function Be(e,t){if(al(e=X(e)))return Ks("Unsupported field value:",t,e),ul(e,t);if(e instanceof Ue)return function(n,r){if(!rl(r.Nc))throw r.Lc(n._methodName+"() can only be used with update() and set()");if(!r.path)throw r.Lc(n._methodName+"() is not currently supported inside arrays");var i=n._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.Fc&&t.Nc!==4)throw t.Lc("Nested arrays are not supported");return function(n,r){for(var i=[],o=0,s=0,u=n;s<u.length;s++){var a=Be(u[s],r.Mc(o));a==null&&(a={nullValue:"NULL_VALUE"}),i.push(a),o++}return{arrayValue:{values:i}}}(e,t)}return function(n,r){if((n=X(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return $c(r.R,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){var i=Tt.fromDate(n);return{timestampValue:Gn(r.R,i)}}if(n instanceof Tt)return i=new Tt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3)),{timestampValue:Gn(r.R,i)};if(n instanceof Ri)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Oe)return{bytesValue:nh(r.R,n._byteString)};if(n instanceof G){i=r.databaseId;var o=n.firestore._databaseId;if(!o.isEqual(i))throw r.Lc("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:vs(n.firestore._databaseId||r.databaseId,n._key.path)}}throw r.Lc("Unsupported field value: "+ki(n))}(e,t)}function ul(e,t){var n={};return Pc(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Le(e,function(r,i){var o=Be(i,t.kc(r));o!=null&&(n[r]=o)}),{mapValue:{fields:n}}}function al(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof Tt||e instanceof Ri||e instanceof Oe||e instanceof G||e instanceof Ue)}function Ks(e,t,n){if(!al(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){var r=ki(n);throw r==="an object"?t.Lc(e+" a custom object"):t.Lc(e+" "+r)}}function xo(e,t,n){if((t=X(t))instanceof Bt)return t._internalPath;if(typeof t=="string")return zs(e,t);throw oi("Field path arguments must be of type string or FieldPath.",e,!1,void 0,n)}var dv=new RegExp("[~\\*/\\[\\]]");function zs(e,t,n){if(t.search(dv)>=0)throw oi("Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,n);try{return new(Bt.bind.apply(Bt,H([void 0],t.split("."))))()._internalPath}catch{throw oi("Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,n)}}function oi(e,t,n,r,i){var o=r&&!r.isEmpty(),s=i!==void 0,u="Function "+t+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new w(g.INVALID_ARGUMENT,(u+=". ")+e+a)}function cl(e,t){return e.some(function(n){return n.isEqual(t)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Yn=function(){function e(t,n,r,i,o){this._firestore=t,this._userDataWriter=n,this._key=r,this._document=i,this._converter=o}return Object.defineProperty(e.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ref",{get:function(){return new G(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),e.prototype.exists=function(){return this._document!==null},e.prototype.data=function(){if(this._document){if(this._converter){var t=new gv(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}},e.prototype.get=function(t){if(this._document){var n=this._document.data.field(si("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n)}},e}(),gv=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return x(t,e),t.prototype.data=function(){return e.prototype.data.call(this)},t}(Yn);function si(e,t){return typeof t=="string"?zs(e,t):t instanceof Bt?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ie=function(){function e(t,n){this.hasPendingWrites=t,this.fromCache=n}return e.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},e}(),Wt=function(e){function t(n,r,i,o,s,u){var a=this;return(a=e.call(this,n,r,i,o,u)||this)._firestore=n,a._firestoreImpl=n,a.metadata=s,a}return x(t,e),t.prototype.exists=function(){return e.prototype.exists.call(this)},t.prototype.data=function(n){if(n===void 0&&(n={}),this._document){if(this._converter){var r=new On(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,n)}return this._userDataWriter.convertValue(this._document.data.value,n.serverTimestamps)}},t.prototype.get=function(n,r){if(r===void 0&&(r={}),this._document){var i=this._document.data.field(si("DocumentSnapshot.get",n));if(i!==null)return this._userDataWriter.convertValue(i,r.serverTimestamps)}},t}(Yn),On=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return x(t,e),t.prototype.data=function(n){return n===void 0&&(n={}),e.prototype.data.call(this,n)},t}(Wt),oe=function(){function e(t,n,r,i){this._firestore=t,this._userDataWriter=n,this._snapshot=i,this.metadata=new Ie(i.hasPendingWrites,i.fromCache),this.query=r}return Object.defineProperty(e.prototype,"docs",{get:function(){var t=[];return this.forEach(function(n){return t.push(n)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this.size===0},enumerable:!1,configurable:!0}),e.prototype.forEach=function(t,n){var r=this;this._snapshot.docs.forEach(function(i){t.call(n,new On(r._firestore,r._userDataWriter,i.key,i,new Ie(r._snapshot.mutatedKeys.has(i.key),r._snapshot.fromCache),r.query.converter))})},e.prototype.docChanges=function(t){t===void 0&&(t={});var n=!!t.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new w(g.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){var o=0;return r._snapshot.docChanges.map(function(u){return{type:"added",doc:new On(r._firestore,r._userDataWriter,u.doc.key,u.doc,new Ie(r._snapshot.mutatedKeys.has(u.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:o++}})}var s=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(function(u){return i||u.type!==3}).map(function(u){var a=new On(r._firestore,r._userDataWriter,u.doc.key,u.doc,new Ie(r._snapshot.mutatedKeys.has(u.doc.key),r._snapshot.fromCache),r.query.converter),c=-1,h=-1;return u.type!==0&&(c=s.indexOf(u.doc.key),s=s.delete(u.doc.key)),u.type!==1&&(h=(s=s.add(u.doc)).indexOf(u.doc.key)),{type:vv(u.type),doc:a,oldIndex:c,newIndex:h}})}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges},e}();function vv(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return D()}}function hl(e,t){return e instanceof Wt&&t instanceof Wt?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(e._document===null?t._document===null:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof oe&&t instanceof oe&&e._firestore===t._firestore&&tl(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ll(e){if(Yr(e)&&e.explicitOrderBy.length===0)throw new w(g.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var vr=function(){};function ee(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0,i=t;r<i.length;r++){var o=i[r];e=o._apply(e)}return e}var yv=function(e){function t(n,r,i){var o=this;return(o=e.call(this)||this).jc=n,o.Wc=r,o.Gc=i,o.type="where",o}return x(t,e),t.prototype._apply=function(n){var r=qe(n.firestore),i=function(o,s,u,a,c,h,l){var f;if(c.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new w(g.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+h+"' queries on FieldPath.documentId().");if(h==="in"||h==="not-in"){wa(l,h);for(var p=[],d=0,v=l;d<v.length;d++){var b=v[d];p.push(ma(a,o,b))}f={arrayValue:{values:p}}}else f=ma(a,o,l)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||wa(l,h),f=sl(u,"where",l,h==="in"||h==="not-in");var I=kt.create(c,h,f);return function(N,A){if(A.g()){var O=ls(N);if(O!==null&&!O.isEqual(A.field))throw new w(g.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+O.toString()+"' and '"+A.field.toString()+"'");var F=hs(N);F!==null&&pl(N,A.field,F)}var B=function(rt,Vi){for(var _n=0,$s=rt.filters;_n<$s.length;_n++){var Hs=$s[_n];if(Vi.indexOf(Hs.op)>=0)return Hs.op}return null}(N,function(rt){switch(rt){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(A.op));if(B!==null)throw B===A.op?new w(g.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+A.op.toString()+"' filter."):new w(g.INVALID_ARGUMENT,"Invalid query. You cannot use '"+A.op.toString()+"' filters with '"+B.toString()+"' filters.")}(o,I),I}(n._query,0,r,n.firestore._databaseId,this.jc,this.Wc,this.Gc);return new Rt(n.firestore,n.converter,function(o,s){var u=o.filters.concat([s]);return new Jt(o.path,o.collectionGroup,o.explicitOrderBy.slice(),u,o.limit,o.limitType,o.startAt,o.endAt)}(n._query,i))},t}(vr),mv=function(e){function t(n,r){var i=this;return(i=e.call(this)||this).jc=n,i.zc=r,i.type="orderBy",i}return x(t,e),t.prototype._apply=function(n){var r=function(i,o,s){if(i.startAt!==null)throw new w(g.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new w(g.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var u=new Ye(o,s);return function(a,c){if(hs(a)===null){var h=ls(a);h!==null&&pl(a,h,c.field)}}(i,u),u}(n._query,this.jc,this.zc);return new Rt(n.firestore,n.converter,function(i,o){var s=i.explicitOrderBy.concat([o]);return new Jt(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(n._query,r))},t}(vr),ga=function(e){function t(n,r,i){var o=this;return(o=e.call(this)||this).type=n,o.Hc=r,o.Jc=i,o}return x(t,e),t.prototype._apply=function(n){return new Rt(n.firestore,n.converter,Bc(n._query,this.Hc,this.Jc))},t}(vr),va=function(e){function t(n,r,i){var o=this;return(o=e.call(this)||this).type=n,o.Yc=r,o.Xc=i,o}return x(t,e),t.prototype._apply=function(n){var r=fl(n,this.type,this.Yc,this.Xc);return new Rt(n.firestore,n.converter,function(i,o){return new Jt(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,o,i.endAt)}(n._query,r))},t}(vr),ya=function(e){function t(n,r,i){var o=this;return(o=e.call(this)||this).type=n,o.Yc=r,o.Xc=i,o}return x(t,e),t.prototype._apply=function(n){var r=fl(n,this.type,this.Yc,this.Xc);return new Rt(n.firestore,n.converter,function(i,o){return new Jt(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,o)}(n._query,r))},t}(vr);function fl(e,t,n,r){if(n[0]=X(n[0]),n[0]instanceof Yn)return function(o,s,u,a,c){if(!a)throw new w(g.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+u+"().");for(var h=[],l=0,f=rn(o);l<f.length;l++){var p=f[l];if(p.field.isKeyField())h.push(Hr(s,a.key));else{var d=a.data.field(p.field);if(us(d))throw new w(g.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+p.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(d===null){var v=p.field.canonicalString();throw new w(g.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+v+"' (used as the orderBy) does not exist.")}h.push(d)}}return new zn(h,c)}(e._query,e.firestore._databaseId,t,n[0]._document,r);var i=qe(e.firestore);return function(o,s,u,a,c,h){var l=o.explicitOrderBy;if(c.length>l.length)throw new w(g.INVALID_ARGUMENT,"Too many arguments provided to "+a+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var f=[],p=0;p<c.length;p++){var d=c[p];if(l[p].field.isKeyField()){if(typeof d!="string")throw new w(g.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+a+"(), but got a "+typeof d);if(!fs(o)&&d.indexOf("/")!==-1)throw new w(g.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+a+"() must be a plain document ID, but '"+d+"' contains a slash.");var v=o.path.child(U.fromString(d));if(!C.isDocumentKey(v))throw new w(g.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+a+"() must result in a valid document path, but '"+v+"' is not because it contains an odd number of segments.");var b=new C(v);f.push(Hr(s,b))}else{var I=sl(u,a,d);f.push(I)}}return new zn(f,h)}(e._query,e.firestore._databaseId,i,t,n,r)}function ma(e,t,n){if(typeof(n=X(n))=="string"){if(n==="")throw new w(g.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!fs(t)&&n.indexOf("/")!==-1)throw new w(g.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=t.path.child(U.fromString(n));if(!C.isDocumentKey(r))throw new w(g.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Hr(e,new C(r))}if(n instanceof G)return Hr(e,n._key);throw new w(g.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+ki(n)+".")}function wa(e,t){if(!Array.isArray(e)||e.length===0)throw new w(g.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+t.toString()+"' filters.");if(e.length>10)throw new w(g.INVALID_ARGUMENT,"Invalid Query. '"+t.toString()+"' filters support a maximum of 10 elements in the value array.")}function pl(e,t,n){if(!n.isEqual(t))throw new w(g.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Gs=function(){function e(){}return e.prototype.convertValue=function(t,n){switch(n===void 0&&(n="none"),xe(t)){case 0:return null;case 1:return t.booleanValue;case 2:return W(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,n);case 5:return t.stringValue;case 6:return this.convertBytes(en(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,n);case 10:return this.convertObject(t.mapValue,n);default:throw D()}},e.prototype.convertObject=function(t,n){var r=this,i={};return Le(t.fields,function(o,s){i[o]=r.convertValue(s,n)}),i},e.prototype.convertGeoPoint=function(t){return new Ri(W(t.latitude),W(t.longitude))},e.prototype.convertArray=function(t,n){var r=this;return(t.values||[]).map(function(i){return r.convertValue(i,n)})},e.prototype.convertServerTimestamp=function(t,n){switch(n){case"previous":var r=Fc(t);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(jn(t));default:return null}},e.prototype.convertTimestamp=function(t){var n=ce(t);return new Tt(n.seconds,n.nanos)},e.prototype.convertDocumentKey=function(t,n){var r=U.fromString(t);k(hh(r));var i=new ii(r.get(1),r.get(3)),o=new C(r.popFirst(5));return i.isEqual(n)||Y("Document "+o+" contains a document reference within a different database ("+i.projectId+"/"+i.database+") which is not supported. It will be treated as a reference in the current database ("+n.projectId+"/"+n.database+") instead."),o},e}();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pi(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}var wv=function(e){function t(n){var r=this;return(r=e.call(this)||this).firestore=n,r}return x(t,e),t.prototype.convertBytes=function(n){return new Oe(n)},t.prototype.convertReference=function(n){var r=this.convertDocumentKey(n,this.firestore._databaseId);return new G(this.firestore,null,r)},t}(Gs),bv=function(){function e(t,n){this._firestore=t,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=qe(t)}return e.prototype.set=function(t,n,r){this._verifyNotCommitted();var i=se(t,this._firestore),o=Pi(i.converter,n,r),s=Oi(this._dataReader,"WriteBatch.set",i._key,o,i.converter!==null,r);return this._mutations.push(s.toMutation(i._key,ft.none())),this},e.prototype.update=function(t,n,r){for(var i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];this._verifyNotCommitted();var s,u=se(t,this._firestore);return s=typeof(n=X(n))=="string"||n instanceof Bt?js(this._dataReader,"WriteBatch.update",u._key,n,r,i):Bs(this._dataReader,"WriteBatch.update",u._key,n),this._mutations.push(s.toMutation(u._key,ft.exists(!0))),this},e.prototype.delete=function(t){this._verifyNotCommitted();var n=se(t,this._firestore);return this._mutations=this._mutations.concat(new dr(n._key,ft.none())),this},e.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},e.prototype._verifyNotCommitted=function(){if(this._committed)throw new w(g.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},e}();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function se(e,t){if((e=X(e)).firestore!==t)throw new w(g.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Se=function(e){function t(n){var r=this;return(r=e.call(this)||this).firestore=n,r}return x(t,e),t.prototype.convertBytes=function(n){return new Oe(n)},t.prototype.convertReference=function(n){var r=this.convertDocumentKey(n,this.firestore._databaseId);return new G(this.firestore,null,r)},t}(Gs);function ba(e,t,n){e=q(e,G);var r=q(e.firestore,Z),i=Pi(e.converter,t,n);return yr(r,[Oi(qe(r),"setDoc",e._key,i,e.converter!==null,n).toMutation(e._key,ft.none())])}function Ea(e,t,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];e=q(e,G);var o=q(e.firestore,Z),s=qe(o);return yr(o,[(typeof(t=X(t))=="string"||t instanceof Bt?js(s,"updateDoc",e._key,t,n,r):Bs(s,"updateDoc",e._key,t)).toMutation(e._key,ft.exists(!0))])}function dl(e){for(var t,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];e=X(e);var s={includeMetadataChanges:!1},u=0;typeof i[u]!="object"||gn(i[u])||(s=i[u],u++);var a,c,h,l={includeMetadataChanges:s.includeMetadataChanges};if(gn(i[u])){var f=i[u];i[u]=(t=f.next)===null||t===void 0?void 0:t.bind(f),i[u+1]=(n=f.error)===null||n===void 0?void 0:n.bind(f),i[u+2]=(r=f.complete)===null||r===void 0?void 0:r.bind(f)}if(e instanceof G)c=q(e.firestore,Z),h=cr(e._key.path),a={next:function(v){i[u]&&i[u](ko(c,e,v))},error:i[u+1],complete:i[u+2]};else{var p=q(e,Rt);c=q(p.firestore,Z),h=p._query;var d=new Se(c);a={next:function(v){i[u]&&i[u](new oe(c,d,p,v))},error:i[u+1],complete:i[u+2]},ll(e._query)}return function(v,b,I,N){var A=this,O=new Ci(N),F=new xs(b,O,I);return v.asyncQueue.enqueueAndForget(function(){return m(A,void 0,void 0,function(){var B;return y(this,function(rt){switch(rt.label){case 0:return B=Ns,[4,dn(v)];case 1:return[2,B.apply(void 0,[rt.sent(),F])]}})})}),function(){O.Wo(),v.asyncQueue.enqueueAndForget(function(){return m(A,void 0,void 0,function(){var B;return y(this,function(rt){switch(rt.label){case 0:return B=Ds,[4,dn(v)];case 1:return[2,B.apply(void 0,[rt.sent(),F])]}})})})}}(lt(c),h,l,a)}function yr(e,t){return function(n,r){var i=this,o=new St;return n.asyncQueue.enqueueAndForget(function(){return m(i,void 0,void 0,function(){var s;return y(this,function(u){switch(u.label){case 0:return s=Lg,[4,Wh(n)];case 1:return[2,s.apply(void 0,[u.sent(),r,o])]}})})}),o.promise}(lt(e),t)}function ko(e,t,n){var r=n.docs.get(t._key),i=new Se(e);return new Wt(e,i,t._key,r,new Ie(n.hasPendingWrites,n.fromCache),t.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ev=function(e){function t(n,r){var i=this;return(i=e.call(this,n,r)||this)._firestore=n,i}return x(t,e),t.prototype.get=function(n){var r=this,i=se(n,this._firestore),o=new Se(this._firestore);return e.prototype.get.call(this,n).then(function(s){return new Wt(r._firestore,o,i._key,s._document,new Ie(!1,!1),i.converter)})},t}(function(){function e(t,n){this._firestore=t,this._transaction=n,this._dataReader=qe(t)}return e.prototype.get=function(t){var n=this,r=se(t,this._firestore),i=new wv(this._firestore);return this._transaction.lookup([r._key]).then(function(o){if(!o||o.length!==1)return D();var s=o[0];if(s.isFoundDocument())return new Yn(n._firestore,i,s.key,s,r.converter);if(s.isNoDocument())return new Yn(n._firestore,i,r._key,null,r.converter);throw D()})},e.prototype.set=function(t,n,r){var i=se(t,this._firestore),o=Pi(i.converter,n,r),s=Oi(this._dataReader,"Transaction.set",i._key,o,i.converter!==null,r);return this._transaction.set(i._key,s),this},e.prototype.update=function(t,n,r){for(var i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s,u=se(t,this._firestore);return s=typeof(n=X(n))=="string"||n instanceof Bt?js(this._dataReader,"Transaction.update",u._key,n,r,i):Bs(this._dataReader,"Transaction.update",u._key,n),this._transaction.update(u._key,s),this},e.prototype.delete=function(t){var n=se(t,this._firestore);return this._transaction.delete(n._key),this},e}());/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ia(){if(typeof Uint8Array>"u")throw new w(g.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Ta(){if(typeof atob>"u")throw new w(g.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var gl=function(){function e(t){this._delegate=t}return e.fromBase64String=function(t){return Ta(),new e(Oe.fromBase64String(t))},e.fromUint8Array=function(t){return Ia(),new e(Oe.fromUint8Array(t))},e.prototype.toBase64=function(){return Ta(),this._delegate.toBase64()},e.prototype.toUint8Array=function(){return Ia(),this._delegate.toUint8Array()},e.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(),Iv=function(){function e(){}return e.prototype.enableIndexedDbPersistence=function(t,n){return function(r,i){da(r=q(r,Z));var o=lt(r),s=r._freezeSettings(),u=new Co;return pa(o,u,new Gh(u,s.cacheSizeBytes,i==null?void 0:i.forceOwnership))}(t._delegate,{forceOwnership:n})},e.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(n){da(n=q(n,Z));var r=lt(n),i=n._freezeSettings(),o=new Co;return pa(r,o,new Yg(o,i.cacheSizeBytes))}(t._delegate)},e.prototype.clearIndexedDbPersistence=function(t){return function(n){var r=this;if(n._initialized&&!n._terminated)throw new w(g.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var i=new St;return n._queue.enqueueAndForgetEvenWhileRestricted(function(){return m(r,void 0,void 0,function(){var o;return y(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,function(u){return m(this,void 0,void 0,function(){var a;return y(this,function(c){switch(c.label){case 0:return cn.yt()?(a=u+"main",[4,cn.delete(a)]):[2,Promise.resolve()];case 1:return c.sent(),[2]}})})}(Es(n._databaseId,n._persistenceKey))];case 1:return s.sent(),i.resolve(),[3,3];case 2:return o=s.sent(),i.reject(o),[3,3];case 3:return[2]}})})}),i.promise}(t._delegate)},e}(),vl=function(){function e(t,n,r){var i=this;this._delegate=n,this.Zc=r,this.INTERNAL={delete:function(){return i.terminate()}},t instanceof ii||(this.tu=t)}return Object.defineProperty(e.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),e.prototype.settings=function(t){var n=this._delegate._getSettings();t.merge||n.host===t.host||Gr("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&delete(t=Object.assign(Object.assign({},n),t)).merge,this._delegate._setSettings(t)},e.prototype.useEmulator=function(t,n,r){r===void 0&&(r={}),function(i,o,s,u){var a;u===void 0&&(u={});var c=(i=q(i,Wn))._getSettings();if(c.host!=="firestore.googleapis.com"&&c.host!==o&&Gr("Host has been set in both settings() and useEmulator(), emulator host will be used"),i._setSettings(Object.assign(Object.assign({},c),{host:o+":"+s,ssl:!1})),u.mockUserToken){var h,l;if(typeof u.mockUserToken=="string")h=u.mockUserToken,l=it.MOCK_USER;else{h=zl(u.mockUserToken,(a=i._app)===null||a===void 0?void 0:a.options.projectId);var f=u.mockUserToken.sub||u.mockUserToken.user_id;if(!f)throw new w(g.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new it(f)}i._credentials=new ev(new Yh(h,l))}}(this._delegate,t,n,r)},e.prototype.enableNetwork=function(){return function(t){var n=this;return t.asyncQueue.enqueue(function(){return m(n,void 0,void 0,function(){var r,i;return y(this,function(o){switch(o.label){case 0:return[4,ra(t)];case 1:return r=o.sent(),[4,ia(t)];case 2:return i=o.sent(),[2,(r.setNetworkEnabled(!0),function(s){var u=_(s);return u.Or.delete(0),gr(u)}(i))]}})})})}(lt(q(this._delegate,Z)))},e.prototype.disableNetwork=function(){return function(t){var n=this;return t.asyncQueue.enqueue(function(){return m(n,void 0,void 0,function(){var r,i;return y(this,function(o){switch(o.label){case 0:return[4,ra(t)];case 1:return r=o.sent(),[4,ia(t)];case 2:return i=o.sent(),[2,(r.setNetworkEnabled(!1),function(s){return m(this,void 0,void 0,function(){var u;return y(this,function(a){switch(a.label){case 0:return(u=_(s)).Or.add(0),[4,bn(u)];case 1:return a.sent(),u.Br.set("Offline"),[2]}})})}(i))]}})})})}(lt(q(this._delegate,Z)))},e.prototype.enablePersistence=function(t){var n=!1,r=!1;return t&&Xh("synchronizeTabs",n=!!t.synchronizeTabs,"experimentalForceOwningTab",r=!!t.experimentalForceOwningTab),n?this.Zc.enableMultiTabIndexedDbPersistence(this):this.Zc.enableIndexedDbPersistence(this,r)},e.prototype.clearPersistence=function(){return this.Zc.clearIndexedDbPersistence(this)},e.prototype.terminate=function(){return this.tu&&(this.tu._removeServiceInstance("firestore"),this.tu._removeServiceInstance("firestore-exp")),this._delegate._delete()},e.prototype.waitForPendingWrites=function(){return function(t){var n=this,r=new St;return t.asyncQueue.enqueueAndForget(function(){return m(n,void 0,void 0,function(){var i;return y(this,function(o){switch(o.label){case 0:return i=Ug,[4,Wh(t)];case 1:return[2,i.apply(void 0,[o.sent(),r])]}})})}),r.promise}(lt(q(this._delegate,Z)))},e.prototype.onSnapshotsInSync=function(t){return function(n,r){return function(i,o){var s=this,u=new Ci(o);return i.asyncQueue.enqueueAndForget(function(){return m(s,void 0,void 0,function(){var a;return y(this,function(c){switch(c.label){case 0:return a=function(h,l){_(h).Gr.add(l),l.next()},[4,dn(i)];case 1:return[2,a.apply(void 0,[c.sent(),u])]}})})}),function(){u.Wo(),i.asyncQueue.enqueueAndForget(function(){return m(s,void 0,void 0,function(){var a;return y(this,function(c){switch(c.label){case 0:return a=function(h,l){_(h).Gr.delete(l)},[4,dn(i)];case 1:return[2,a.apply(void 0,[c.sent(),u])]}})})})}}(lt(n=q(n,Z)),gn(r)?r:{next:r})}(this._delegate,t)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this.tu)throw new w(g.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.tu},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new ui(this,Jh(this._delegate,t))}catch(n){throw vt(n,"collection()","Firestore.collection()")}},e.prototype.doc=function(t){try{return new Ae(this,Pr(this._delegate,t))}catch(n){throw vt(n,"doc()","Firestore.doc()")}},e.prototype.collectionGroup=function(t){try{return new Mi(this,function(n,r){if(n=q(n,Wn),Vs("collectionGroup","collection id",r),r.indexOf("/")>=0)throw new w(g.INVALID_ARGUMENT,"Invalid collection ID '"+r+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Rt(n,null,function(i){return new Jt(U.emptyPath(),i)}(r))}(this._delegate,t))}catch(n){throw vt(n,"collectionGroup()","Firestore.collectionGroup()")}},e.prototype.runTransaction=function(t){var n=this;return function(r,i){return function(o,s){var u=this,a=new St;return o.asyncQueue.enqueueAndForget(function(){return m(u,void 0,void 0,function(){var c;return y(this,function(h){switch(h.label){case 0:return[4,function(l){return xi(l).then(function(f){return f.datastore})}(o)];case 1:return c=h.sent(),new Jg(o.asyncQueue,c,s,a).run(),[2]}})})}),a.promise}(lt(r),function(o){return i(new Ev(r,o))})}(this._delegate,function(r){return t(new yl(n,r))})},e.prototype.batch=function(){var t=this;return lt(this._delegate),new ml(new bv(this._delegate,function(n){return yr(t._delegate,n)}))},e.prototype.loadBundle=function(t){throw new w(g.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},e.prototype.namedQuery=function(t){throw new w(g.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},e}(),Li=function(e){function t(n){var r=this;return(r=e.call(this)||this).firestore=n,r}return x(t,e),t.prototype.convertBytes=function(n){return new gl(new Oe(n))},t.prototype.convertReference=function(n){var r=this.convertDocumentKey(n,this.firestore._databaseId);return Ae.eu(r,this.firestore,null)},t}(Gs);function Tv(e){var t;t=e,Lt.setLogLevel(t)}var yl=function(){function e(t,n){this._firestore=t,this._delegate=n,this._userDataWriter=new Li(t)}return e.prototype.get=function(t){var n=this,r=Te(t);return this._delegate.get(r).then(function(i){return new Xn(n._firestore,new Wt(n._firestore._delegate,n._userDataWriter,i._key,i._document,i.metadata,r.converter))})},e.prototype.set=function(t,n,r){var i=Te(t);return r?(Us("Transaction.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this},e.prototype.update=function(t,n,r){for(var i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];var u=Te(t);return arguments.length===2?this._delegate.update(u,n):(i=this._delegate).update.apply(i,H([u,n,r],o)),this},e.prototype.delete=function(t){var n=Te(t);return this._delegate.delete(n),this},e}(),ml=function(){function e(t){this._delegate=t}return e.prototype.set=function(t,n,r){var i=Te(t);return r?(Us("WriteBatch.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this},e.prototype.update=function(t,n,r){for(var i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];var u=Te(t);return arguments.length===2?this._delegate.update(u,n):(i=this._delegate).update.apply(i,H([u,n,r],o)),this},e.prototype.delete=function(t){var n=Te(t);return this._delegate.delete(n),this},e.prototype.commit=function(){return this._delegate.commit()},e}(),Fi=function(){function e(t,n,r){this._firestore=t,this._userDataWriter=n,this._delegate=r}return e.prototype.fromFirestore=function(t,n){var r=new On(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new Jn(this._firestore,r),n!=null?n:{})},e.prototype.toFirestore=function(t,n){return n?this._delegate.toFirestore(t,n):this._delegate.toFirestore(t)},e.nu=function(t,n){var r=e.su,i=r.get(t);i||(i=new WeakMap,r.set(t,i));var o=i.get(n);return o||(o=new e(t,new Li(t),n),i.set(n,o)),o},e}();Fi.su=new WeakMap;var Ae=function(){function e(t,n){this.firestore=t,this._delegate=n,this._userDataWriter=new Li(t)}return e.iu=function(t,n,r){if(t.length%2!=0)throw new w(g.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.canonicalString()+" has "+t.length);return new e(n,new G(n._delegate,r,new C(t)))},e.eu=function(t,n,r){return new e(n,new G(n._delegate,r,t))},Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new ui(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new ui(this.firestore,Jh(this._delegate,t))}catch(n){throw vt(n,"collection()","DocumentReference.collection()")}},e.prototype.isEqual=function(t){return(t=X(t))instanceof G&&Zh(this._delegate,t)},e.prototype.set=function(t,n){n=Us("DocumentReference.set",n);try{return n?ba(this._delegate,t,n):ba(this._delegate,t)}catch(r){throw vt(r,"setDoc()","DocumentReference.set()")}},e.prototype.update=function(t,n){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];try{return arguments.length===1?Ea(this._delegate,t):Ea.apply(void 0,H([this._delegate,t,n],r))}catch(o){throw vt(o,"updateDoc()","DocumentReference.update()")}},e.prototype.delete=function(){return yr(q((t=this._delegate).firestore,Z),[new dr(t._key,ft.none())]);var t},e.prototype.onSnapshot=function(){for(var t=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=wl(n),o=bl(n,function(s){return new Xn(t.firestore,new Wt(t.firestore._delegate,t._userDataWriter,s._key,s._document,s.metadata,t._delegate.converter))});return dl(this._delegate,i,o)},e.prototype.get=function(t){var n=this;return((t==null?void 0:t.source)==="cache"?function(r){r=q(r,G);var i=q(r.firestore,Z),o=lt(i),s=new Se(i);return function(u,a){var c=this,h=new St;return u.asyncQueue.enqueueAndForget(function(){return m(c,void 0,void 0,function(){var l;return y(this,function(f){switch(f.label){case 0:return l=function(p,d,v){return m(this,void 0,void 0,function(){var b,I;return y(this,function(N){switch(N.label){case 0:return N.trys.push([0,2,,3]),[4,function(A,O){var F=_(A);return F.persistence.runTransaction("read document","readonly",function(B){return F.Mn.mn(B,O)})}(p,d)];case 1:return(I=N.sent()).isFoundDocument()?v.resolve(I):I.isNoDocument()?v.resolve(null):v.reject(new w(g.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return b=N.sent(),I=Tn(b,"Failed to get document '"+d+" from cache"),v.reject(I),[3,3];case 3:return[2]}})})},[4,Qh(u)];case 1:return[2,l.apply(void 0,[f.sent(),a,h])]}})})}),h.promise}(o,r._key).then(function(u){return new Wt(i,s,r._key,u,new Ie(u!==null&&u.hasLocalMutations,!0),r.converter)})}(this._delegate):(t==null?void 0:t.source)==="server"?function(r){r=q(r,G);var i=q(r.firestore,Z);return oa(lt(i),r._key,{source:"server"}).then(function(o){return ko(i,r,o)})}(this._delegate):function(r){r=q(r,G);var i=q(r.firestore,Z);return oa(lt(i),r._key).then(function(o){return ko(i,r,o)})}(this._delegate)).then(function(r){return new Xn(n.firestore,new Wt(n.firestore._delegate,n._userDataWriter,r._key,r._document,r.metadata,n._delegate.converter))})},e.prototype.withConverter=function(t){return new e(this.firestore,t?this._delegate.withConverter(Fi.nu(this.firestore,t)):this._delegate.withConverter(null))},e}();function vt(e,t,n){return e.message=e.message.replace(t,n),e}function wl(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];if(typeof r=="object"&&!gn(r))return r}return{}}function bl(e,t){var n,r,i;return{next:function(o){i.next&&i.next(t(o))},error:(n=(i=gn(e[0])?e[0]:gn(e[1])?e[1]:typeof e[0]=="function"?{next:e[0],error:e[1],complete:e[2]}:{next:e[1],error:e[2],complete:e[3]}).error)===null||n===void 0?void 0:n.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var Xn=function(){function e(t,n){this._firestore=t,this._delegate=n}return Object.defineProperty(e.prototype,"ref",{get:function(){return new Ae(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),e.prototype.data=function(t){return this._delegate.data(t)},e.prototype.get=function(t,n){return this._delegate.get(t,n)},e.prototype.isEqual=function(t){return hl(this._delegate,t._delegate)},e}(),Jn=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return x(t,e),t.prototype.data=function(n){return this._delegate.data(n)},t}(Xn),Mi=function(){function e(t,n){this.firestore=t,this._delegate=n,this._userDataWriter=new Li(t)}return e.prototype.where=function(t,n,r){try{return new e(this.firestore,ee(this._delegate,function(i,o,s){var u=o,a=si("where",i);return new yv(a,u,s)}(t,n,r)))}catch(i){throw vt(i,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.orderBy=function(t,n){try{return new e(this.firestore,ee(this._delegate,function(r,i){i===void 0&&(i="asc");var o=i,s=si("orderBy",r);return new mv(s,o)}(t,n)))}catch(r){throw vt(r,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.limit=function(t){try{return new e(this.firestore,ee(this._delegate,function(n){return la("limit",n),new ga("limit",n,"F")}(t)))}catch(n){throw vt(n,"limit()","Query.limit()")}},e.prototype.limitToLast=function(t){try{return new e(this.firestore,ee(this._delegate,function(n){return la("limitToLast",n),new ga("limitToLast",n,"L")}(t)))}catch(n){throw vt(n,"limitToLast()","Query.limitToLast()")}},e.prototype.startAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,ee(this._delegate,function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return new va("startAt",r,!0)}.apply(void 0,t)))}catch(r){throw vt(r,"startAt()","Query.startAt()")}},e.prototype.startAfter=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,ee(this._delegate,function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return new va("startAfter",r,!1)}.apply(void 0,t)))}catch(r){throw vt(r,"startAfter()","Query.startAfter()")}},e.prototype.endBefore=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,ee(this._delegate,function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return new ya("endBefore",r,!0)}.apply(void 0,t)))}catch(r){throw vt(r,"endBefore()","Query.endBefore()")}},e.prototype.endAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,ee(this._delegate,function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return new ya("endAt",r,!1)}.apply(void 0,t)))}catch(r){throw vt(r,"endAt()","Query.endAt()")}},e.prototype.isEqual=function(t){return tl(this._delegate,t._delegate)},e.prototype.get=function(t){var n=this;return((t==null?void 0:t.source)==="cache"?function(r){r=q(r,Rt);var i=q(r.firestore,Z),o=lt(i),s=new Se(i);return function(u,a){var c=this,h=new St;return u.asyncQueue.enqueueAndForget(function(){return m(c,void 0,void 0,function(){var l;return y(this,function(f){switch(f.label){case 0:return l=function(p,d,v){return m(this,void 0,void 0,function(){var b,I,N,A,O;return y(this,function(F){switch(F.label){case 0:return F.trys.push([0,2,,3]),[4,ei(p,d,!0)];case 1:return O=F.sent(),b=new qh(d,O.Bn),I=b._o(O.documents),N=b.applyChanges(I,!1),v.resolve(N.snapshot),[3,3];case 2:return A=F.sent(),O=Tn(A,"Failed to execute query '"+d+" against cache"),v.reject(O),[3,3];case 3:return[2]}})})},[4,Qh(u)];case 1:return[2,l.apply(void 0,[f.sent(),a,h])]}})})}),h.promise}(o,r._query).then(function(u){return new oe(i,s,r,u)})}(this._delegate):(t==null?void 0:t.source)==="server"?function(r){r=q(r,Rt);var i=q(r.firestore,Z),o=lt(i),s=new Se(i);return sa(o,r._query,{source:"server"}).then(function(u){return new oe(i,s,r,u)})}(this._delegate):function(r){r=q(r,Rt);var i=q(r.firestore,Z),o=lt(i),s=new Se(i);return ll(r._query),sa(o,r._query).then(function(u){return new oe(i,s,r,u)})}(this._delegate)).then(function(r){return new Ro(n.firestore,new oe(n.firestore._delegate,n._userDataWriter,n._delegate,r._snapshot))})},e.prototype.onSnapshot=function(){for(var t=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=wl(n),o=bl(n,function(s){return new Ro(t.firestore,new oe(t.firestore._delegate,t._userDataWriter,t._delegate,s._snapshot))});return dl(this._delegate,i,o)},e.prototype.withConverter=function(t){return new e(this.firestore,t?this._delegate.withConverter(Fi.nu(this.firestore,t)):this._delegate.withConverter(null))},e}(),_v=function(){function e(t,n){this._firestore=t,this._delegate=n}return Object.defineProperty(e.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doc",{get:function(){return new Jn(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),e}(),Ro=function(){function e(t,n){this._firestore=t,this._delegate=n}return Object.defineProperty(e.prototype,"query",{get:function(){return new Mi(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map(function(n){return new Jn(t._firestore,n)})},enumerable:!1,configurable:!0}),e.prototype.docChanges=function(t){var n=this;return this._delegate.docChanges(t).map(function(r){return new _v(n._firestore,r)})},e.prototype.forEach=function(t,n){var r=this;this._delegate.forEach(function(i){t.call(n,new Jn(r._firestore,i))})},e.prototype.isEqual=function(t){return hl(this._delegate,t._delegate)},e}(),ui=function(e){function t(n,r){var i=this;return(i=e.call(this,n,r)||this).firestore=n,i._delegate=r,i}return x(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var n=this._delegate.parent;return n?new Ae(this.firestore,n):null},enumerable:!1,configurable:!0}),t.prototype.doc=function(n){try{return new Ae(this.firestore,n===void 0?Pr(this._delegate):Pr(this._delegate,n))}catch(r){throw vt(r,"doc()","CollectionReference.doc()")}},t.prototype.add=function(n){var r=this;return function(i,o){var s=q(i.firestore,Z),u=Pr(i),a=Pi(i.converter,o);return yr(s,[Oi(qe(i.firestore),"addDoc",u._key,a,i.converter!==null,{}).toMutation(u._key,ft.exists(!1))]).then(function(){return u})}(this._delegate,n).then(function(i){return new Ae(r.firestore,i)})},t.prototype.isEqual=function(n){return Zh(this._delegate,n._delegate)},t.prototype.withConverter=function(n){return new t(this.firestore,n?this._delegate.withConverter(Fi.nu(this.firestore,n)):this._delegate.withConverter(null))},t}(Mi);function Te(e){return q(e,G)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Sv=function(){function e(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._delegate=new(Bt.bind.apply(Bt,H([void 0],t)))}return e.documentId=function(){return new e(Vt.keyField().canonicalString())},e.prototype.isEqual=function(t){return(t=X(t))instanceof Bt&&this._delegate._internalPath.isEqual(t._internalPath)},e}(),Av=function(){function e(t){this._delegate=t}return e.serverTimestamp=function(){var t=new hv("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new e(t)},e.delete=function(){var t=new qs("deleteField");return t._methodName="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];return new lv("arrayUnion",i)}.apply(void 0,t);return r._methodName="FieldValue.arrayUnion",new e(r)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];return new fv("arrayRemove",i)}.apply(void 0,t);return r._methodName="FieldValue.arrayRemove",new e(r)},e.increment=function(t){var n=function(r){return new pv("increment",r)}(t);return n._methodName="FieldValue.increment",new e(n)},e.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},e}(),Nv={Firestore:vl,GeoPoint:Ri,Timestamp:Tt,Blob:gl,Transaction:yl,WriteBatch:ml,DocumentReference:Ae,DocumentSnapshot:Xn,Query:Mi,QueryDocumentSnapshot:Jn,QuerySnapshot:Ro,CollectionReference:ui,FieldPath:Sv,FieldValue:Av,setLogLevel:Tv,CACHE_SIZE_UNLIMITED:sv};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dv(e){(function(t,n){t.INTERNAL.registerComponent(new ai("firestore",function(r){var i=r.getProvider("app").getImmediate();return n(i,r.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},Nv)))})(e,function(t,n){return new vl(t,new Z(t,n),new Iv)}),e.registerVersion("@firebase/firestore","2.4.1")}Dv(Fn);const Cv={apiKey:"AIzaSyBngbKInEQoPIF9er0Y66AlXS96RqgquIE",authDomain:"note-app-19f19.firebaseapp.com",projectId:"note-app-19f19",storageBucket:"note-app-19f19.appspot.com",messagingSenderId:"348676221606",appId:"1:348676221606:web:02cc0d9f2fe1f3fe5e6267"};var _a;(_a=Fn.apps)!=null&&_a.length||Fn.initializeApp(Cv);let eo=Fn.firestore();const xv=wt("link",{rel:"preconnect",href:"https://fonts.googleapis.com"},null,-1),kv=wt("link",{rel:"preconnect",href:"https://fonts.gstatic.com",crossorigin:""},null,-1),Rv=wt("link",{href:"https://fonts.googleapis.com/css2?family=Montserrat&display=swap",rel:"stylesheet"},null,-1),Ov=wt("link",{href:"https://fonts.googleapis.com/icon?family=Material+Icons",rel:"stylesheet"},null,-1),Pv=wt("h1",null,"Public Note App",-1),Lv={class:"form"},Fv=wt("span",{class:"material-icons"}," add ",-1),Vv={__name:"index",setup(e){let t=Ui([]);Sl(()=>{eo.collection("notes").onSnapshot(n)});async function n(u){for(let a of u.docChanges()){let c=a.doc,h=c.data(),l={id:c.id,title:h.title,content:h.content};if(a.type==="added")t.value.push(l);else if(a.type==="modified"){let f=t.value.findIndex(p=>p.id===c.id);t.value.splice(f,1,l)}else if(a.type==="removed"){let f=t.value.findIndex(p=>p.id===c.id);t.value.splice(f,1)}}}let r=Ui(""),i=Ui("");async function o(){!r.value||!i.value||(await eo.collection("notes").add({title:r.value,content:i.value}),r.value="",i.value="")}function s(u){eo.collection("notes").doc(u).delete()}return(u,a)=>{const c=Rl,h=Ml;return Nr(),no(Js,null,[Al(c,null,{default:Nl(()=>[xv,kv,Rv,Ov]),_:1}),Pv,wt("div",Lv,[Ws(wt("input",{type:"text",placeholder:"Enter title","onUpdate:modelValue":a[0]||(a[0]=l=>Xs(r)?r.value=l:r=l)},null,512),[[Ys,We(r)]]),Ws(wt("input",{type:"text",placeholder:"Enter content","onUpdate:modelValue":a[1]||(a[1]=l=>Xs(i)?i.value=l:i=l)},null,512),[[Ys,We(i)]]),wt("button",{onClick:o},[Fv,Dl(" ADD")])]),(Nr(!0),no(Js,null,Cl(We(t),l=>(Nr(),xl(h,{key:l.id,id:l.id,title:l.title,content:l.content,onRemove:f=>s(l.id)},null,8,["id","title","content","onRemove"]))),128))],64)}}};export{Vv as default};
